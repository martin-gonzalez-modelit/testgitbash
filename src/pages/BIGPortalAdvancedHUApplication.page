<apex:page showheader="false" sidebar="false" cache="false" standardstylesheets="false" applyhtmltag="false"
    controller="BIGPortalAdvancedHUAppController" action="{!init}">
<html>
<head>
    <title>PG&amp;E Portal - Advanced Home Upgrade</title>
    <link rel="icon" href="{!URLFOR($Resource.bigutopia, 'img/favicon.ico')}" type="image/x-icon"/>
    <apex:stylesheet value="{!URLFOR($Resource.bigutopia, '/js/vendor/bootstrap/css/bootstrap.min.css')}"/>
    <apex:stylesheet value="{!URLFOR($Resource.bigutopia, '/css/style.css')}"/>
    <apex:stylesheet value="{!URLFOR($Resource.bigutopia, '/css/bigutopia.css')}"/>
    <apex:stylesheet value="{!URLFOR($Resource.bigutopia, '/css/cupertino/cupertino_styles.min.css')}"/>
    <apex:stylesheet value="{!URLFOR($Resource.bigutopia, '/css/validatorStyle.css')}"/>
    <apex:stylesheet value="https://fonts.googleapis.com/css?family=Open+Sans:400,300,600,700"/>
    <apex:includeScript value="{!URLFOR($Resource.bigutopia, '/js/vendor/jquery/jquery.js')}"/>
    <apex:includeScript value="{!URLFOR($Resource.bigutopia, '/js/vendor/jquery-ui/jquery-ui.js')}"/>
    <apex:includeScript value="{!URLFOR($Resource.bigutopia, '/js/vendor/bootstrap/bootstrap.min.js')}"/>
    <apex:includeScript value="{!URLFOR($Resource.bigutopia, '/js/vendor/jquery-validate/jquery.validate.js')}"/>
    <apex:includeScript value="{!URLFOR($Resource.bigutopia, '/js/vendor/jquery-validate/additional-methods.min.js')}"/>
    <apex:includeScript value="{!URLFOR($Resource.bigutopia, '/js/vendor/jquery-number/jquery.number.min.js')}"/>
    <apex:includeScript value="{!URLFOR($Resource.bigutopia, '/js/vendor/jquery-maskedinput/jquery.maskedinput.js')}"/>
    <script src="/soap/ajax/31.0/connection.js" type="text/javascript"></script>
    <style>
        body {
            background-color: #CCFFFF;
        }
        .sub-header {
            text-transform:uppercase;
            padding-bottom: 0px;
        }
        .options-table label {
            display: inline-block;
            font-size: 13px;
            margin-left: 10px;
        }
        .options-table input {
            margin-bottom: 7px;
        }
        .options-table tr td {
            padding-bottom: 4px;
        }
        .inputControlInline {
            display:inline-block;
        }
        .inputLabelInline {
            display:inline-block;
        }
        #advancedApplicationTabs {
            font-family: 'Open Sans' !important;
            font-size: 25px;
            font-weight: 300;
        }
        #advancedApplicationTabs li a {
            background-color: #fafcfb;
            border-bottom: 1px solid #ddd;
        }
        #advancedApplicationTabs li.active a {
            border-bottom: 1px solid transparent;
        }
        .ui-datepicker-trigger {
            margin-left: 10px;
            cursor: pointer;
        }
        .progress {
            display: inline-block;
            width: 150px;
            margin-bottom: -6px;
        }
        .removeAttachment {
            font-size:30px;
            height:18px;
            margin-right: 5px;
            line-height: 21px;
        }
        textarea[id*="notes"],
        textarea[id*="postNotes"] {
            width:98%;
            height:100px;
            margin-bottom:20px;
        }

        span.note {
            font-size: 75%;
            color: #676767;
        }
        #conversation,
        #post-conversation {
            border: solid 1px #9fc7f5;
            padding: 20px;
            background-color: #dfecf2;
            margin-top: 20px;
            border-radius:8px;
            -moz-border-radius:8px;
            font-size: 90%;
        }
        #conversation h2,
        #post-conversation h2 {
            float:left;
            width:170px;
        }
        .filenameContainer {
            width: 350px;
            overflow: hidden;
            display: inline-block;
            text-overflow: ellipsis;
            line-height: 18px;
            vertical-align: middle;
            white-space: nowrap;
        }
        input[type="file"] {
            height: 23px;
            line-height: 18px;
        }
        #conditionedAreaSection .controls {
            margin-left: 240px;
        }
        #conditionedAreaSection .controlGroupSeparation.error {
            margin-bottom: 60px !important;
        }
        input[id*="postConditionedArea"] {
            vertical-align: top;
        }
        .advancedAppForm label[id*="postConditionedArea"].error.valid {
            position: relative;
            vertical-align: top;
        }

        label.error {
            line-height: 20px;
        }
        .tab-pane {
            overflow: hidden;
        }

        .nav-panel {
            top: 98px;
            margin: 0;
            font-size: 13px;
            display: block;
            width: 99.5%;
            text-align: center;
            margin-bottom: 25px;
            border: 1px solid #e5e5e5;
            height: 30px;
            background: #fff;
        }
        .nav-panel li {
            border-right: 1px solid #e5e5e5;
            display: inline;
            float: left;
            line-height: 30px;
            width: 33.25%
        }
        .nav-panel li.active {
            background-color: #428bca;
            border-right: none;
            color: #fff;
            text-decoration: underline;
        }
        .nav-panel .project-info {
            border-left: 1px solid #e5e5e5;
            border-right: 1px solid #e5e5e5;
        }
        .nav-panel .reviewInfo-tab {
            border-right: none;
        }
        .group-content {
            margin-left: 15px;
        }
        .group-content .control-group {
            margin-top: 35px;
        }
        .building-btn {
            display: inline-block;
            outline: none;
            width: 195px;
        }
        #cancelButton {
            display: block;
            margin-top: 90px;
        }
        .building-dwelling-details {
            background-color: #f5f5f5;
            margin-top: 15px;
        }
        .building-dwelling-details .details-wrapper {
            width: 95%;
            display: block;
            margin: 0 auto;
        }
        .building-frm {
            margin-top: 25px;
        }
        .sub-title {
            margin-top: 45px;
            margin-bottom: 25px;
        }
        .building-frm {
            margin: 0 0;
        }
        .building-frm #inputState {
            color: #999;
            background-color: #fcfcfc;
            font-family: 'Open Sans', sans-serif;
        }
        .form-horizontal .controls {
            margin-left: 202px;
        }
        .form-horizontal .control-label {
            width: 220px;
        }
        .form-horizontal .control-label.optional {
            padding-top: 6px;
            line-height: 17px;
            height: 20px;
        }
        .form-horizontal .span10 input {
            vertical-align: top;
        }

        .form-horizontal .addressCheckbox,
        .form-horizontal .contactCheckbox {
            margin-bottom: 20px;
        }

        .form-actions .btn {
            width: 100px;
        }
        .form-actions .btn-default {
            margin: 0 10px;
        }

        .appStatusPanel {
            border: 1px solid #e5e5e5;
            border-radius: 5px;
            font-weight: bold;
            font-size: 13px;
            margin: 20px 0;
        }
        .appStatusPanel .control-label {
            font-size: 14px;
            margin-bottom: 0;
        }
        .projectInfoForm label.error {
            position: absolute;
        }
        .advancedAppForm label.error {
            position: absolute;
        }
        .detail-container .row {
            text-align: right;
            margin-bottom: 5px;
        }
        .detail-container .row.text-left {
            text-align: left;
        }
        .detail-container .row .span5 {
            text-align: left;
        }
        .detail-container .control-label {
            text-align: right;
        }
        #postInstalationApp .nav-panel li {
            border-right: none;
            display: inline;
            float: left;
            line-height: 30px;
            text-align: center;
            width: 50%;
            padding: 0 0;
        }
        #postInstalationApp .form-horizontal .control-label {
            width: 220px;
        }

        .tab-content .btn-default {
            margin: 0px 0px 0px 10px;
        }

        .align-right {
            text-align: right;
            font-style: italic;
            margin: 0 3px 0 3px;
            padding: 0px 35px;
        }
        .align-right-dollar {
            text-align: right;
        }
        .calculations-box {
           float: right;
           width: 450px;
           height: auto;
           border: 1px solid #A8A8A8;
           border-radius: 5px;
           margin-top: -198px;
        }
        .calculations-box table {
           margin: 10px auto;
        }
        .calculations-box .last-row-calculations-table {
           font-weight: bold;
        }
        .custom-error-box {
           border: 1px solid black;
           background-color: #f2dede;
           border-color: #eed3d7;
           border-radius: 4px;
           padding: 8px 35px 8px 14px;
           margin-bottom: 20px;
           display: none;
           font-weight: bold;
        }
        .custom-error-box h4 {
           color: #b94a48; margin: 0;
        }
        .custom-error-box ul {
           color: #b94a48;
           list-style-type: none;
           padding: 0;
           margin: 0 0 0 12px;
        }
        .error-custom-message {
            padding-top: 5px;
        }

        .controlGroupSeparation {
            margin-bottom: 30px !important;
        }

        .sub-titleForAHU {
            margin-bottom: 25px;
            margin-top: 25px;
        }
        .close.disabled {
            opacity: 0.08;
            cursor: default;
        }

        h4 small {
            font-size: 13px;
        }

        span.optional-label h4{
            display: inline;
            font-style: normal;
        }

        .additionalDocumentsBottom {
            margin-bottom: 60px !important;
        }

        .controlGroupSeparation.preRebateIssued {
            margin-top: 45px;
        }

        .calculations-box hr {
            margin: 3px 0;
            border: 1px solid #e5e5e5;
        }

        .last-row-calculations-table.estimated-incentive > td {
            padding-top: 10px;
        }

        label[for*="inputModalDwellingSearch"] {
            display: block;
        }

        h4.selectBuilding {
            margin-top: 30px;
        }

        label small {
            font-size: 13px;
            font-weight: normal;
            line-height: 1;
            color: #999;
            font-style: normal;
            text-rendering: auto !important;
        }
    </style>
    <script>
        var savingAnalyst = false;

        // Application Status
        var APP_STATUS = {
            PRE_APP_STARTED: "Pre-Install Created",
            PRE_APP_RETURNED: "Pre-Install Correction Required",
            PRE_APP_APPROVED: "Pre-Install Approved",
            POST_APP_STARTED: "Post-Install Created",
            POST_APP_RETURNED: "Post-Install Correction Required"
        }

        var PAGE_ERROR = {
            MESSAGE_SAVE: "Your changes were not saved. Please correct the error below.",
            MESSAGE_CONTINUE: "Please correct the errors on this page."
        }

        var FILE_OPTIONS = {
            MAX_FILE_SIZE: 5242880, //bytes
            MAX_HPXML_FILE_SIZE: 3145728 //bytes
        }

        var applicationId = '{!applicationId}';
        var action = '{!action}';
        var binaryFileIdCard = {name:'', size:0, parentId:'', result:''};
        var auxBinaryFileIdCard;
        var BPI_FILE_DESCRIPTION = 'BPI Accreditation';
        var selectedDw = "";
        var projectFinancingDescriptionValue = '{!application.Project_Financing_Description__c}';

        /* DOCUMENT READY */
        $(document).ready( function () {
            $('[data-toggle="tooltip"]').tooltip();
            $(".help-icon").popover();
            $('.input-phone').mask('(999) 999-9999');

            // Format number with 2 decimal places and commas "1,000.00".
            $('input[id*="ConditionedArea"]').number(true, 2);

            // Format number with 1 decimal places and commas "1,000.0".
            $('input[id*="postHPHIEER"]').number(true, 1);

            // Set style to alert messages
            customMsg();

            $('.disable-btn').on('click', function() {
                disableButtons();
            });

            // Set-Up date picker for date fields
            $("input[id*=testInDate]").datepicker({
                dateFormat: 'm/d/yy',
                showOn: "both",
                maxDate: new Date(),
                buttonImage: "{!URLFOR($Resource.bigutopia, 'img/calendar.png')}",
                buttonImageOnly: true,
                onSelect: function(selectedDate) {
                    /*
                     * Verify testInDate is later than workStartDate, if so,
                     * remove workStartDate and workFinishDate value
                     */
                    var $workStarDate = $("input[id*=preWorkStartDate]");
                    var $workFinishDate = $("input[id*=preWorkFinishDate]");

                    if ($workStarDate.val() !== "" && Date.parse(selectedDate) > Date.parse($workStarDate.val())) {
                        $.datepicker._clearDate($workStarDate);
                    }
                    if ($workFinishDate.val() !== "" && Date.parse(selectedDate) > Date.parse($workFinishDate.val())) {
                        $.datepicker._clearDate($workFinishDate);
                    }
                }
            });

            // Set-Up date picker for date fields
            $("input[id*=preWorkStartDate]").datepicker({
                dateFormat: 'm/d/yy',
                showOn: "both",
                buttonImage: "{!URLFOR($Resource.bigutopia, 'img/calendar.png')}",
                buttonImageOnly: true,
                onSelect: function(selectedDate) {
                    // Verify workStartDate is later than workFinishDate, if so, remove workFinishDate value
                    var $workFinishDate = $("input[id*=preWorkFinishDate]");
                    if ($workFinishDate.val() !== "" && Date.parse(selectedDate) > Date.parse($workFinishDate.val())) {
                        $.datepicker._clearDate($workFinishDate);
                    }
                },
                beforeShow: function() {
                    var $tid = $("input[id*=testInDate]");
                    var $wsd = $(this);
                    // Verify if testInDate already has a date, if it has, set it as minDate for workStartDate
                    if  ($tid.val() !== '') {
                        $wsd.datepicker('option', 'minDate', $tid.val()).datepicker("refresh");
                    }
                }
            });

            $("input[id*=preWorkFinishDate]").datepicker({
                dateFormat: 'm/d/yy',
                showOn: "both",
                buttonImage: "{!URLFOR($Resource.bigutopia, 'img/calendar.png')}",
                buttonImageOnly: true,
                beforeShow: function() {
                    var $tid = $("input[id*=testInDate]");
                    var $wsd = $("input[id*=preWorkStartDate]");
                    var $wfd = $(this);
                    // Verify if workStartDate already has a date, if it has, set it as minDate for workFinishDate
                    var minDate = $wsd.val() !== '' ? $wsd.val() : ($tid.val() !== '' ? $tid.val() : '');
                    $wfd.datepicker('option', 'minDate', minDate).datepicker("refresh");
                }
            });

            $("input[id*=workPostStartDate]").datepicker({
                dateFormat: 'm/d/yy',
                showOn: "both",
                minDate: "{!FormattedTestInDate}",
                maxDate: new Date(),
                buttonImage: "{!URLFOR($Resource.bigutopia, 'img/calendar.png')}",
                buttonImageOnly: true,
                onSelect: function(selectedDate) {
                    // Verify WorkStartDate is later than workFinishDate, if so, remove WorkFinishDate,
                    // postHPHIDate and TestOutDate value.
                    var $workFinishDate = $("input[id*=workPostFinishDate]");
                    var $testOutDate = $("input[id*=testOutDate]");
                    var $postHPHIDate = $("input[id*=postHPHIDate]");

                    if ($workFinishDate.val() !== "" && Date.parse(selectedDate) > Date.parse($workFinishDate.val())) {
                        $.datepicker._clearDate($workFinishDate);
                    }
                    if ($testOutDate.val() !== "" && Date.parse(selectedDate) > Date.parse($testOutDate.val())) {
                        $.datepicker._clearDate($testOutDate);
                    }
                    if ($postHPHIDate.val() !== "" && Date.parse(selectedDate) > Date.parse($postHPHIDate.val())) {
                        $.datepicker._clearDate($postHPHIDate);
                    }
                }
            });

            $("input[id*=workPostFinishDate]").datepicker({
                dateFormat: 'm/d/yy',
                showOn: "both",
                maxDate: new Date(),
                buttonImage: "{!URLFOR($Resource.bigutopia, 'img/calendar.png')}",
                buttonImageOnly: true,
                onSelect: function(selectedDate) {
                    // Verify workFinishDate is later than testOutDate, if so, remove TestOutDate value
                    var $testOutDate = $("input[id*=testOutDate]");
                    if ($testOutDate.val() !== "" && Date.parse(selectedDate) > Date.parse($testOutDate.val())) {
                        $.datepicker._clearDate($testOutDate);
                    }
                },
                beforeShow: function() {
                    var $wsd = $("input[id*=workPostStartDate]");
                    var $wfd = $(this);
                    // Verify if workStartDate already has a date, if it has, set it as minDate for workFinishDate
                    var minDate = $wsd.val() !== '' ? $wsd.val() : '{!formattedTestInDate}';
                    $wfd.datepicker('option', 'minDate', minDate).datepicker("refresh");
                }
            });

            $("input[id*=testOutDate]").datepicker({
                dateFormat: 'm/d/yy',
                showOn: "both",
                minDate: "{!FormattedTestInDate}",
                maxDate: new Date(),
                buttonImage: "{!URLFOR($Resource.bigutopia, 'img/calendar.png')}",
                buttonImageOnly: true,
                beforeShow: function() {
                    var $wsd = $("input[id*=workPostStartDate]");
                    var $wfd = $("input[id*=workPostFinishDate]");
                    var $tod = $(this);
                    // Verify if workStartDate already has a date, if it has, set it as minDate for testOutDate
                    var minDate = $wfd.val() !== '' ? $wfd.val() : ($wsd.val() !== '' ? $wsd.val() : '');
                    $tod.datepicker('option', 'minDate', minDate).datepicker('refresh');
                }
            });

            // Set-Up date picker for HPHI Date
            $("input[id*=postHPHIDate]").datepicker({
                dateFormat: 'm/d/yy',
                showOn: "both",
                maxDate: new Date(),
                buttonImage: "{!URLFOR($Resource.bigutopia, 'img/calendar.png')}",
                buttonImageOnly: true,
                beforeShow: function() {
                    var $wsd = $("input[id*=workPostStartDate]");
                    // Verify if workStartDate already has a date, if it has, set it as minDate for postHPHIDate.
                    var minDate = $wsd.val() !== '' ? $wsd.val() : '';
                    $(this).datepicker('option', 'minDate', minDate).datepicker('refresh');
                }
            });
            $('.hasDatepicker').attr('readonly', true);

            // Disable datepickers inputs so users cannot enter values manually.
            $('.hasDatepicker').attr('readonly', true);

            /* SEARCH BUILDING FUNCTIONS */

            // Show Search Modal when clicking on "Choose Existing Building".
            $('.buildingInfo-panel').on('click', '#searchDwelling', function(e) {
                e.preventDefault();
                if (!$(this).hasClass('disabled')) {
                    $(this).addClass('disabled');
                    showSearchDwModal();
                }
            });


            $(vfToJQ("{!$Component.advancedAppForm}")).validate({
                normalizer: function(value) {
                    return $.trim(value);
                }
            });

            // Search Dwelling Unit At Modal Window when Search button is clicked.
            $('#dwellingUnit').on('click', '#modalSearchDwelling', function(e) {
                e.preventDefault();
                $('#inputModalDwellingSearch').rules( "add", {
                    required: true,
                    minlength: 2,
                    alphanumericwithbasicpunc: true
                });
                if ($(vfToJQ("{!$Component.advancedAppForm}")).valid()) {
                    $(this).closest('.control-group').removeClass('error');
                    searchDwellingFromModal($(this));
                }
            });

            // Search Dwelling Unit At Modal Window when Enter is pressed.
            $('#dwellingUnit').on('keyup', '#inputModalDwellingSearch', function(e) {
                var isEnterKey = e.which === 13;
                var $el = $(this);

                if (isEnterKey) {
                    $el.rules( "add", {
                        required: true,
                        minlength: 2,
                        alphanumericwithbasicpunc: true
                    });
                }
                if ($el.valid()) {
                    $el.closest('.control-group').removeClass('error');
                    if (isEnterKey) {
                        searchDwellingFromModal($el);
                    }
                }
            });

            // Set dwelling unit when clicking on a link of the search modal popup.
            $('#main-container').on('click', '.set-dw', function(e) {
                e.preventDefault();
                // Check that the id is present and assign the dwelling unit.
                if ($.trim($(this).attr('rel')) !== '') {
                    selectedDw = $.trim($(this).attr('rel'));
                    assignDwellingUnit($.trim($(this).attr('rel')));
                    if ($('.multipleItemsSearchResult').length > 0) {
                        $('.multipleItemsSearchResult').remove();
                    }
                }
            });

            $("#searchDwModal").on('shown', function(){
                $('#inputModalDwellingSearch').focus();
            });

            $("#searchDwModal").on('hidden', function(){
                // Removes validation error messages if any.
                $('form.advancedAppForm').validate().resetForm();
                $('#inputModalDwellingSearch').rules("remove");
                $('#inputModalDwellingSearch').closest('.control-group').removeClass('error');
                if (selectedDw === "") {
                    // call to action method to clear dwellingMap
                    clearDwellingSearch();
                }
            });
            /* -- SEARCH BUILDING FUNCTIONS -- */

            var $projectFinancing = $('select[id*="projectFinancingOptions"]');
            var $projectFinancingDescription = $('textarea[id*="projectFinancingDescription"]');
            var projectFinancingSelectedOption = ('{!application.Project_Financing_Source__c}' !== ''
                    && '{!application.Project_Financing_Source__c}' !== 'Secured Loan'
                    && '{!application.Project_Financing_Source__c}' !== 'Unsecured Loan')
                    ? '{!application.Project_Financing_Source__c}'
                    : '{!application.Project_Financing_Detail__c}';

            // Set project financing select input.
            $projectFinancing.val(projectFinancingSelectedOption);
            // Set project description visibility and value.
            setProjectDescription(projectFinancingSelectedOption);

            // Bind change event on project financing select input.
            $projectFinancing.on('change', function() {
                var optionValue = $(this).val();
                var groupLabel = $('select[id*="projectFinancingOptions"] :selected').parent().attr('label');
                var $projectFinancingSource = $('input[type=hidden][id*="projectFinancingSource"]');
                var $projectFinancingDetail = $('input[type=hidden][id*="projectFinancingDetail"]');
                // Set project description visibility and value.
                setProjectDescription(optionValue);
                // Set values for hidden inputs.
                if (groupLabel === 'General Options') {
                    $projectFinancingSource.val(optionValue);
                    $projectFinancingDetail.val('');
                } else if (groupLabel === 'Secure Options') {
                    $projectFinancingSource.val('Secured Loan');
                    $projectFinancingDetail.val(optionValue);
                } else if (groupLabel === 'Unsecure Options') {
                    $projectFinancingSource.val('Unsecured Loan');
                    $projectFinancingDetail.val(optionValue);
                } else {
                    $projectFinancingSource.val('');
                    $projectFinancingDetail.val('');
                }
            });

            // Bing keyup event on project financing description text area.
            $projectFinancingDescription.on('keyup', function() {
                // Save last value entered for project financing description.
                projectFinancingDescriptionValue = $(this).val();
            });

            // Add the action and the application id to the URL when either are missing.
            if (applicationId !== '' && (document.URL.indexOf('action') < 0 || document.URL.indexOf('id') < 0)) {
                action = action !== '' ? action : "edit";
                window.history.replaceState({}, document.title, '{!$Site.CurrentSiteUrl}{!$CurrentPage.Name}'
                        + "?action=" + action + "&id=" + applicationId);
            }

            // Bind an event handler to the "click" JavaScript event of the element cancelButton
            $('#mainContent').on('click', '#cancelButton', function(e) {
                history.go(-1);
            });

            $('#mainContent').on('click', '#addDwelling', function(e) {
                e.preventDefault();
                $('.buildingInfo-panel').hide();
                $('.building-form').show();
            });

            // Hide Error: title
            $('.main-title').prev().remove();

            // Show validation for Delivered Sensible EER.
            $('input[id*="postHPHIEER"]').on('change', function(e) {
                e.preventDefault();

                $(this).rules( "add", {
                    validateHPHIEERRange: true
                });

                if ($(this).valid()) {
                    $(this).removeClass('error');
                }
            });
        });
        /* end of DOCUMENT READY */

        function customMsg() {
            // Add styling to messages
            $('.message').addClass('alert');
            $('.confirmM3').addClass('alert-success');
            $('.infoM3').addClass('alert-info');
            $('.errorM3').addClass('alert-error');
            // Remove titles
            $('.confirmM3 .messageCell h4').remove();
            $('.infoM3 .messageCell h4').remove();
            $('.errorM3 .messageCell h4').remove();
            // Remove empty space from error messages dialog if there's more than one error msg to display.
            if ($('.errorM3').find('ul').length > 0) {
                $('.errorM3').find('tr:first').remove();
            }
         }

        // Handle error messages.
        function setMessage(isValid, message) {
            if (!isValid) {
                $('.custom-error-box').show();
                $('.error-custom-message').html(message);
                $('html, body').animate({scrollTop: '0px'}, 400);
            } else {
                $('.custom-error-box').hide();
                $('.error-custom-message').html('');
            }
            // Check if success message is displayed.
            if ($('.message.confirmM3.alert.alert-success').length === 1) {
                $('.message.confirmM3.alert.alert-success').hide();
            }
        }

        // Disable all buttons when user clicks on submit/back buttons
        function disableButtons() {
            $('[class*=btn]')
                    .addClass('disabled')
                    .attr('tabindex', -1)
                    .on('keydown', function(e) { e.preventDefault(); });
        }

        // Convert visualforce ID into jQuery ID
        function vfToJQ(vfId) {
            return '#' + vfId.replace(/(:|\.)/g,'\\\\$1');
        }

        $.validator.addMethod('filenameLength', function(value, element) {
            var result = value.length > 80;
            return this.optional(element) || !result;
        }, "Filename should not be more than 80 characters.");

        // Determines the minimum amount required, in currency format.
        $.validator.addMethod("min_comma", function(value, elem, params) {
            return parseFloat(value.replace(/[^0-9\.]+/g,"")) >= parseFloat(params);
        }, function(params, element) {
            return 'Please enter a value greater than or equal to ' + setCurrencyFormat(params);
        });

        // Determines the maximum integers allowed for a given currency amount. It allows a maximum of 2 decimals.
        $.validator.addMethod("maxlength_currency", function(value, elem, params) {
            var regex = new RegExp("^[+-]?[0-9]{1," + params + "}(?:[.][0-9]{0,2})?$");
            return regex.test(value.replace(/[^0-9\.]+/g,""));
        }, function(params, element) {
            return 'Currency is too large.';
        });

        $.validator.addMethod('alphanumericwithbasicpunc', function(value, element) {
            return minimumCharsDw(value);
        }, "Please enter at least 2 characters.");

        $.validator.addMethod("selectOptionEmpty", function() {
            return $('#projectFinancingOptions').val() != "--None--";
        }, 'This field is required.');

        $.validator.addMethod("validatePostConditionedArea", function(value, element) {
            var conditionedArea = $.number('{!application.Conditioned_Area__c}', 2);
            return conditionedArea !== $.number(value, 2);
        }, 'The conditioned area has not changed. <br/>Please enter a different value or select "No" above.');

        $.validator.addMethod("validateHPHIEERRange", function(value, element) {
            var hphi = $('input[id*="postHPHIEER"]').val();
            if (hphi !== '') {
                return (hphi > 0 && hphi < 30);
            }
            return true;
        }, 'Please enter a value between 0.1 and 29.9.');

        function setCurrencyFormat(number) {
            var regex = /(\d)(?=(\d\d\d)+(?!\d))/g;
            return number >= 0
                    ? ('$' + number.toFixed(2).replace(regex, "$1,"))
                    : ('($' + Math.abs(number).toFixed(2).replace(regex, "$1,") + ')');
        }

        function minimumCharsDw(txt) {
            // accept 2 or more characters alphanumeric and basic punctuation.
            return /^[a-zA-Z0-9\-.,&()@_\/'\s]+$/.test(txt) && txt.trim().length > 1;
        }

        function activeProjectPanel() {
            $('.buildingInfo-tab').removeClass('active');
            $('.step1').removeClass('current');
            $('.step1').addClass('visited');
            $('.projectInfo-tab').addClass('active');
            $('.step2').removeClass('un-visited');
            $('.step2').addClass('current');
            $('.buildingInfo-panel').hide();
            $('.building-form').hide();
            $('.projectInfo-panel').show();
            $('[id*="owner-saving-status.start"]').hide();
            showOwnerButtons();
        }

        // Removes validation from the form and lets you implement a new validation
        function unbindValidation(form) {
            form.validate().destroy();
            $('.control-group').removeClass('success error');
            $('label.error').remove();
        }

        // Checks if payment release inputFile is required
        // If required adds the validation rule else will remove the validation rule
        function checkPaymentReleaseValidation(paymentReleaseFileInput) {
            if ($('input[type=radio][value="Contractor Payee"]:checked').length == 1
                || $('input[type=radio][value="Non Account Holder"]:checked').length == 1) {
                paymentReleaseFileInput.rules('add', {required:true});
            }
        }

        /* SEARCH BUILDING MODAL AUX FUNCTIONS */
        // Perform Dwelling unit search from modal window
        function searchDwellingFromModal(input) {
            if (!input.hasClass('disabled')) {
                input.addClass('disabled');
                searchDwellingUnit($.trim($('#inputModalDwellingSearch').val()));
            }
        }
        // Show search dwelling unit modal
        function showSearchDwModal() {
            $('#modalSearchDwelling').removeClass('disabled');
            $('#searchDwelling').removeClass('disabled');
            $('#inputModalDwellingSearch').removeClass('disabled');

            if (!$('#searchDwModal').is(':visible')) {
                // Auto scroll up
                x = 0;
                y = document.height;
                window.scroll(x,y);
                // Show modal window
                $('#searchDwModal').modal('show');
                $('#inputModalDwellingSearch').val('');
                $('#inputModalDwellingSearch').focus();
            }
        }
        // Hide search dwelling unit modal
        function hideSearchDwModal() {
            $('#searchDwModal').modal('hide');
            activeProjectPanel();
            // Highlight Building/Dwelling information area
            $('.building-dwelling-details').effect('highlight',{color:'#fcfce2'},'slow');
            // Get Payee Information
            getNewPayeeInfo();
        }
        /* -- SEARCH BUILDING MODAL AUX FUNCTIONS -- */

        // Set project description visibility and value.
        function setProjectDescription(selectedOption) {
            var $projectFinancingDescription = $('textarea[id*="projectFinancingDescription"]');

            if (selectedOption === 'Other') {
                $("#projectFinancingDescriptionContainer").show();
                $projectFinancingDescription.val(projectFinancingDescriptionValue);
            } else {
                $("#projectFinancingDescriptionContainer").hide();
                $projectFinancingDescription.val('');
            }
        }

        function showHideHesSection(show) {
            $('div[id*="HesSection"]').toggle(show);
            $('div[id*="HesAtts"]').toggle(show);
        }

        function showHideHPHISection(show) {
            $('div[id*="postHPHISection"], div[id*="preHPHISection"]').toggle(show);
            $('div[id*="postHPHIAttachments"]').toggle(show);
        }

        function showHideConditionedAreaSection(show) {
            $("#conditionedAreaSection").toggle(show);
        }

        function addDownloadLinksToRebateAssignment() {
            var link1 = '&nbsp;&nbsp;&nbsp;<a href="{!NonAccountOwnerDownloadLink}" target="_blank">Download Form</a>';
            var link2 = '&nbsp;&nbsp;&nbsp;<a href="{!ContractorPayeeDownloadLink}" target="_blank">Download Form</a>';

            $('input[type=radio][value="Non Account Holder"]').next().append(link1);
            $('input[type=radio][value="Contractor Payee"]').next().append(link2);
        }

        function showInputFile(inputId) {
            $('[id*=' + inputId + ']').show();
            $('.removeAttachment').removeClass('disabled');
        }
    </script>
</head>
<body>
    <div id="main-container" class="container main">
        <c:BIGPortalHeader />
        <div id="mainContent">
            <div class="cushion">
                <!-- NEW PRE-INSTALLATION APPLICATION -->
                <apex:outputPanel id="newPreApplicationPanelNew" layout="none" rendered="{!displayPreAppNew}">
                    <h1 class="page-header">Advanced Home Upgrade: Pre-Installation Application</h1>
                    <div class="custom-error-box">
                        <ul>
                            <li class="error-custom-message"></li>
                        </ul>
                    </div>
                    <apex:outputPanel layout="block" id="errorMsgs">
                        <apex:pageMessages escape="false"/>
                    </apex:outputPanel>
                    <c:BIGPortalApplicationHeader application="{!application}"/>

                    <h2 style="color: #a59998; font-size: 13px; line-height: 20px;">PRE-INSTALLATION APPLICATION PROGRESS</h2>
                    <div class="container-progress-bar">
                        <div class="step1 steps {!IF(AND(action == 'new', dwellingToAssignId == '', dwellingUnit == null), 'current', 'visited')}"><span>1. BUILDING INFO</span></div>
                        <div class="step2 steps {!IF(OR(action == 'edit', dwellingToAssignId != '', dwellingUnit != null, AND(action == 'detail', application.Application_Step__c == 2)), 'current', 'un-visited')}">
                            <span>2. PROJECT INFO</span>
                        </div>
                        <div class="step3 steps un-visited"><span>3. REVIEW &amp; SUBMIT</span></div>
                    </div>
                    <apex:outputPanel id="buildingInfoPanel" rendered="{!AND(dwellingUnit == null, action == 'new', applicationId == null)}">
                        <div class="buildingInfo-panel">
                            <h2 class="sub-header">1. Building Information</h2>
                            <p>
                                If you want to start a rebate application for a building that you added previously, you can select "Choose Existing Building" to import that Building's information. Otherwise, you can start by adding a new building. You can select "Cancel" to exit the application.
                            </p>
                            <div class="group-content">
                                <div class="control-group">
                                    <button type="button" id="searchDwelling" class="btn btn-primary building-btn">Choose Existing Building</button>
                                    <span style="display: inline-block; padding: 0 50px 0 50px;">OR</span>
                                    <button type="button" id="addDwelling" class="btn btn-primary building-btn">Add New Building</button>
                                    <button type="button" class="btn btn-default" id="cancelButton">Cancel</button>
                                </div>
                            </div>
                        </div>
                    </apex:outputPanel>

                    <div class="building-form" style="display: {!IF(AND(action == 'new', applicationId != null), '', 'none')};">
                        <apex:outputPanel layout="none" rendered="{!OR(dwellingUnit == null, AND(action == 'new', applicationId != null))}">
                            <c:BIGPortalBuildingForm doAction="new" />
                        </apex:outputPanel>
                    </div>

                    <apex:outputPanel id="appDwInfo" >
                    <apex:outputPanel layout="none" rendered="{!AND(dwellingUnit != null, OR(action = 'new', action = 'edit', AND(action == 'detail', application.Application_Step__c == 2)))}">
                    <div class="projectInfo-panel" >
                        <h2 class="sub-header">2. Project Information</h2>
                        <p>
                            Enter in the project details and upload the required forms for your rebate pre-installation application. Please combine any additional documents and photos into a .ZIP file for upload. Add any additional "Notes" about your application and hit "Continue" to review your information before submitting.
                        </p>
                        <span style="font-size: 13px;"><i>All fields are required unless marked "optional".</i></span>
                        <apex:outputPanel >
                            <!-- Building and Contract-Signing Customer Information for New Applications -->
                            <apex:outputPanel rendered="{!AND(dwellingUnit != null, action = 'new')}">
                                <div class="building-dwelling-details">
                                    <div class="details-wrapper" style="padding: 15px 0 15px 0;">
                                        <div class="sub-title" style="margin-top: 0px">
                                            <strong>Building and Contract-Signing Customer Information</strong>
                                        </div>
                                        <div class="row" style="margin-left:0px;">
                                            <div class="span2 text-right">
                                                Customer Name
                                            </div>
                                            <div class="span4 muted">
                                                {!dwellingUnit.Property_Owner__r.LastName},
                                                {!dwellingUnit.Property_Owner__r.FirstName}
                                            </div>
                                        </div>
                                        <div class="row" style="margin-left:0px;">
                                            <div class="span2 text-right">
                                            Building Address
                                            </div>
                                            <div class="span4 muted">
                                            {!dwellingUnit.Street_Address__c}
                                            </div>
                                        </div>
                                        <div class="row" style="margin-left:0px;">
                                            <div class="span2 text-right">
                                            City
                                            </div>
                                            <div class="muted" style="display: inline-block; margin-left: 20px;">
                                            {!dwellingUnit.Building__r.City__c}
                                            </div>
                                            <div class="text-right" style="display: inline-block; margin: 0 15px 0 40px;">
                                            State
                                            </div>
                                            <div class="muted" style="display: inline-block;">
                                            {!dwellingUnit.Building__r.State__c}
                                            </div>
                                            <div class="text-right" style="display: inline-block; margin: 0 15px 0 40px;">
                                            ZIP Code
                                            </div>
                                            <div class="muted" style="display: inline-block;">
                                            {!dwellingUnit.Building__r.ZIP_Code__c}
                                            </div>
                                            <apex:outputPanel rendered="{!NOT(dwellingUnit.Unit_Number__c == null)}" layout="none">
                                                <div class="text-right" style="display: inline-block; margin: 0 15px 0 40px;">
                                                Unit #
                                                </div>
                                                <div class="muted" style="display: inline-block;">
                                                {!dwellingUnit.Unit_Number__c}
                                                </div>
                                            </apex:outputPanel>
                                        </div>
                                        <apex:outputPanel rendered="{!ISBLANK(application.Status__c) || application.Status__c == 'Pre-Install Created'}">
                                            <div class="row" style="margin-left:0px;">
                                                <div class="span2 text-right"></div>
                                                <a href="{!$CurrentPage.Name}?action=new" class="cancelProject" style="font-size: 13px; margin-left: 20px; display: inline-block; margin-top: 20px;">Discard and change property</a>
                                            </div>
                                        </apex:outputPanel>
                                    </div>
                                </div>
                            </apex:outputPanel>
                            <!-- / Building and Contract-Signing Customer Information for New Applications -->
                            <!-- Building and Contract-Signing Customer Information for Created Applications -->
                            <apex:outputPanel rendered="{!AND(dwellingUnit != null, OR(action = 'edit', AND(action == 'detail', application.Application_Step__c == 2)))}">
                                <div class="building-dwelling-details">
                                    <div class="details-wrapper" style="padding: 15px 0 15px 0;">
                                        <div class="sub-title" style="margin-top: 0px">
                                            <strong>Building and Contract-Signing Customer Information</strong>
                                        </div>
                                        <div class="row" style="margin-left:0px;">
                                            <div class="span2 text-right">
                                                Customer Name
                                            </div>
                                            <div class="span4 muted">
                                                {!application.Customer_Last_Name__c},
                                                {!application.Customer_First_Name__c}
                                            </div>
                                        </div>
                                        <div class="row" style="margin-left:0px;">
                                            <div class="span2 text-right">
                                                Building Address
                                            </div>
                                            <div class="span4 muted">
                                                {!application.Dwelling_Unit_Street_Address__c}
                                            </div>
                                        </div>
                                        <div class="row" style="margin-left:0px;">
                                            <div class="span2 text-right">
                                                City
                                            </div>
                                            <div class="muted" style="display: inline-block; margin-left: 20px;">
                                                {!application.Building_City__c}
                                            </div>
                                            <div class="text-right" style="display: inline-block; margin: 0 15px 0 40px;">
                                                State
                                            </div>
                                            <div class="muted" style="display: inline-block;">
                                                {!application.Building_State__c}
                                            </div>
                                            <div class="text-right" style="display: inline-block; margin: 0 15px 0 40px;">
                                                ZIP Code
                                            </div>
                                            <div class="muted" style="display: inline-block;">
                                                {!application.Building_ZIP_Code__c}
                                            </div>
                                            <apex:outputPanel rendered="{!NOT(ISBLANK(application.Dwelling_Unit_Number__c))}" layout="none">
                                                <div class="text-right" style="display: inline-block; margin: 0 15px 0 40px;">
                                                    Unit #
                                                </div>
                                                <div class="muted" style="display: inline-block;">
                                                    {!application.Dwelling_Unit_Number__c}
                                                </div>
                                            </apex:outputPanel>
                                        </div>
                                        <apex:outputPanel rendered="{!application.Status__c == 'Pre-Install Created'}">
                                            <div class="row" style="margin-left:0px;">
                                                <div class="span2 text-right"></div>
                                                <a href="{!$CurrentPage.Name}?action=new" class="cancelProject" style="font-size: 13px; margin-left: 20px; display: inline-block; margin-top: 20px;">Discard and change property</a>
                                            </div>
                                        </apex:outputPanel>
                                    </div>
                                </div>
                            </apex:outputPanel>
                            <!-- / Building and Contract-Signing Customer Information for Created Applications -->
                        </apex:outputPanel>
                        <apex:form id="projectInfoForm" styleClass="form-horizontal projectInfoForm" style="margin-left: 15px;">
                            <div class="sub-title">
                                <strong>Project Details</strong>
                            </div>

                            <div class="control-group controlGroupSeparation">
                                <label class="control-label inputLabelInline optional">Proposed Installation Cost<span class="optional-label">(Advanced Home Upgrade measures only)</span></label>
                                <div class="controls input-container">
                                    <div class="input-prepend">
                                        <span class="add-on">$</span>
                                        <apex:inputField id="proposedPackageCost" styleClass="span3 propInstCost" value="{!preApplication.Proposed_Package_Cost__c}"/>
                                    </div>
                                </div>
                            </div>
                            <div class="control-group controlGroupSeparation">
                                <label class="control-label inputLabelInline">Test-In Date</label>
                                <div class="controls input-container">
                                    <div class="input">
                                        <apex:inputText id="testInDate" styleClass="span3" value="{!formattedTestInDate}"/>
                                    </div>
                                </div>
                            </div>

                            <div class="control-group controlGroupSeparation">
                                <label class="control-label inputLabelInline optional">Work Start Date<span class="optional-label">(Please estimate if project has not started yet)</span></label>
                                <div class="controls input-container">
                                    <div class="input">
                                        <apex:inputText id="preWorkStartDate" styleClass="span3" value="{!formattedPreWorkStartDate}"/>
                                    </div>
                                </div>
                            </div>

                            <div class="control-group controlGroupSeparation">
                                <label class="control-label inputLabelInline optional">Work Finish Date<span class="optional-label">(Please estimate if project has not started yet)</span></label>
                                <div class="controls input-container">
                                    <div class="input">
                                        <apex:inputText id="preWorkFinishDate" styleClass="span3" value="{!formattedPreWorkFinishDate}"/>
                                    </div>
                                </div>
                            </div>

                            <apex:outputPanel rendered="{!AND(dwellingUnit != null, OR(action = 'edit', AND(action == 'detail', application.Application_Step__c == 2)))}">
                                <div class="control-group controlGroupSeparation preRebateIssued">
                                    <label class="control-label inputLabelInline" style="float: left;">Rebate Issued to</label>
                                    <div class="controls input-container">
                                       <apex:selectRadio id="preRebateAssignment" value="{!application.Rebate_Assignment__c}" layout="pageDirection" styleClass="options-table" onclick="getPayeeInfoFromApp('{!application.Rebate_Assignment__c}')">
                                            <apex:selectOptions value="{!rebateTypes}" />
                                       </apex:selectRadio>
                                    </div>
                                </div>
                                <!-- Payee Information -->
                                <c:BIGPortalPayeeInfo application="{!application}" dwellingUnit="{!dwellingUnit}" utilityAccount="{!utilityAccount}" account="{!account}" actionate="{!action}" page="AHU"/>
                                <!-- / Payee Information -->
                            </apex:outputPanel>
                            <apex:outputPanel rendered="{!AND(dwellingUnit != null, action = 'new')}">
                                <div class="control-group controlGroupSeparation">
                                    <label class="control-label inputLabelInline" style="float: left;">Rebate Issued to</label>
                                    <div class="controls input-container">
                                       <apex:selectRadio id="newPreRebateAssignment" value="{!application.Rebate_Assignment__c}" layout="pageDirection" styleClass="options-table" onclick="getNewPayeeInfo();">
                                            <apex:selectOptions value="{!rebateTypes}" />
                                       </apex:selectRadio>
                                    </div>
                                </div>
                                <!-- Payee Information -->
                                <c:BIGPortalPayeeInfo application="{!application}" dwellingUnit="{!dwellingUnit}" utilityAccount="{!utilityAccount}" account="{!account}" actionate="{!action}" page="AHU"/>
                                <!-- / Payee Information -->
                            </apex:outputPanel>

                            <!-- BPI Analysts -->
                            <apex:outputPanel id="BPIAnalystList" layout="none">
                                <div class="row" style="margin-top:5px;">
                                <div class="span12">
                                    <div class="control-group controlGroupSeparation">
                                        <label class="control-label inputLabelInline">BPI Analyst</label>
                                        <div class="controls" style="display:inline-block;margin-left:20px;">
                                             <apex:selectList id="BPIAnalyst" value="{!selectedBPIAnalyst}" size="1">
                                                <apex:selectOption itemValue="" itemLabel="< Select BPI Analyst >"/>
                                                <apex:selectOptions value="{!analysts}"/>
                                            </apex:selectList>
                                            <a data-toggle="modal" data-target="#bpiAnalystModal" data-controls-modal="#bpiAnalystModal" data-keyboard="false" class="btn btn-default" style="padding:2px 5px 6px 6px;margin-top: -1px;margin-left: 4px;"><i class="icon-plus icon-black" style="margin-top:3px;"></i></a>
                                         </div>
                                    </div>
                                </div>
                            </div>
                                <apex:outputPanel rendered="{!BPI_IdCard != null}">
                                    <apex:inputHidden value="{!BPI_IdCard}" id="BPI_IdCard"/>
                                </apex:outputPanel>
                            </apex:outputPanel>
                            <!-- / BPI Analysts -->

                            <div class="control-group controlGroupSeparation">
                                <label class="control-label inputLabelInline">Did this home get a pre-installation Home Energy Score (HES)?</label>
                                <div class="controls input-container">
                                    <div class="input">
                                        <apex:inputField id="preHES" value="{!application.Has_Pre_Install_HES__c}"/>
                                    </div>
                                </div>
                            </div>

                            <div id="preHesSection">
                                <c:BIGPortalHomeEnergyScore id="SectionHes" isPostAhu="false" isAhuProgram="true" ahuController="{!injectedController}"/>
                            </div>

                            <apex:outputPanel rendered="{!hasHPHIPractitioner}">
                                <div class="control-group controlGroupSeparation">
                                    <label class="control-label inputLabelInline">Will this home have a qualified High Performance HVAC Installation (HPHI) performed?</label>
                                    <div class="controls input-container">
                                        <div class="input">
                                            <apex:inputField id="hasPreHPHI" value="{!application.Has_HPHI__c}"/>
                                        </div>
                                    </div>
                                </div>

                                <div id="preHPHISection">
                                    <!-- HPHI Practitioner -->
                                    <apex:outputPanel id="preHPHIPractitioners" layout="none">
                                        <div class="row" style="margin-top:5px;">
                                            <div class="span12">
                                                <div class="control-group controlGroupSeparation">
                                                    <label class="control-label inputLabelInline mytest">HPHI Practitioner</label>
                                                    <div class="controls" style="display:inline-block;margin-left:20px;">
                                                        <apex:selectList id="preHPHIPractitioner" value="{!selectedHPHIPractitioner}" size="1">
                                                            <apex:selectOption itemValue="" itemLabel="< Select HPHI Practitioner >"/>
                                                            <apex:selectOptions value="{!HPHIPractitioners}"/>
                                                        </apex:selectList>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </apex:outputPanel>
                                </div>
                            </apex:outputPanel>

                            <div class="sub-title">
                                <strong>Required Documents</strong>
                            </div>
                            <apex:actionRegion >
                                <apex:actionFunction action="{!removeAttachmentPreApp}" name="removeAttachmentPreAppJS1" rerender="attachProposalSOW" status="removing-file-ProposalSOW" oncomplete="showInputFile('contractProposalSOW');">
                                    <apex:param name="deleteId" assignTo="{!attachToDelete}" value="{!contractProposalSOW.ParentId}"/>
                                </apex:actionFunction>
                                <apex:actionFunction action="{!removeAttachmentPreApp}" name="removeAttachmentPreAppJS2" rerender="attachHomePerformanceXML" status="removing-file-HomePerformanceXML" oncomplete="showInputFile('homePerformanceXML');">
                                    <apex:param name="deleteId" assignTo="{!attachToDelete}" value="{!homePerformanceXML.ParentId}"/>
                                </apex:actionFunction>
                                <apex:actionFunction action="{!removeAttachmentPreApp}" name="removeAttachmentPreAppJS3" rerender="attachHomePerformanceSystemFile" status="removing-file-HomePerformanceSystemFile" oncomplete="showInputFile('homePerformanceSystemFile');">
                                    <apex:param name="deleteId" assignTo="{!attachToDelete}" value="{!homePerformanceSystemFile.ParentId}"/>
                                </apex:actionFunction>
                                <apex:actionFunction action="{!removeAttachmentPreApp}" name="removeAttachmentPreAppJS4" rerender="attachTestInMeasurements" status="removing-file-TestInMeasurements" oncomplete="showInputFile('testInMeasurements');">
                                    <apex:param name="deleteId" assignTo="{!attachToDelete}" value="{!testInMeasurements.ParentId}"/>
                                </apex:actionFunction>
                                <apex:actionFunction action="{!removeAttachmentPreApp}" name="removeAttachmentPreAppJS5" rerender="attachAdditionalDocuments" status="removing-file-AdditionalDocuments" oncomplete="showInputFile('additionalDocuments');">
                                    <apex:param name="deleteId" assignTo="{!attachToDelete}" value="{!additionalDocuments.ParentId}"/>
                                </apex:actionFunction>
                                <apex:actionFunction action="{!removeAttachmentPreApp}" name="removeAttachmentPreAppJS6" rerender="attachPaymentReleaseAuthorization" status="removing-file-PaymentReleaseAuthorization" oncomplete="showInputFile('paymentReleaseAuthorization');">
                                    <apex:param name="deleteId" assignTo="{!attachToDelete}" value="{!paymentReleaseAuthorization.ParentId}"/>
                                </apex:actionFunction>
                                <apex:actionFunction action="{!removeAttachmentPreApp}" name="removeAttachmentPreAppJS7" rerender="attachHomeEnergyScore" status="removing-file-HomeEnergyScore" oncomplete="showInputFile('hesEnergyScore');">
                                    <apex:param name="deleteId" assignTo="{!attachToDelete}" value="{!homeEnergyScoreReportInputFile.ParentId}"/>
                                </apex:actionFunction>
                                <apex:actionFunction action="{!removeAttachmentPreApp}" name="removeAttachmentPreAppJS8" rerender="attachHomeEnergyScoreAdditional" status="removing-file-HomeEnergyScoreAdditional" oncomplete="showInputFile('homeEnergyScoreAdditional');">
                                    <apex:param name="deleteId" assignTo="{!attachToDelete}" value="{!homeEnergyScoreAdditionalDocuments.ParentId}"/>
                                </apex:actionFunction>
                                <apex:actionFunction action="{!removeAttachmentPreApp}" name="removeAttachmentPreAppJS9" rerender="attachHomeEnergyScoreBuilding" status="removing-file-HomeEnergyScoreBuilding" oncomplete="showInputFile('homeEnergyScoreBuilding');">
                                    <apex:param name="deleteId" assignTo="{!attachToDelete}" value="{!greenBuildingRegistryOptIn.ParentId}"/>
                                </apex:actionFunction>

                            </apex:actionRegion>
                            <div class="files-group">
                                <div class="control-group controlGroupSeparation">
                                    <label class="control-label inputLabelInline" style="width:220px;">Contract/Proposal/SOW</label>
                                    <div class="controls inputControlInline" style="margin-left: 20px;">
                                        <apex:actionRegion >
                                            <apex:outputPanel id="attachProposalSOW">
                                                <apex:outputPanel layout="block" rendered="{!contractProposalSOW.Id != null && NOT(loadedApplicationFiles[contractProposalSOW.parentId].S3_Uploaded__c)}">
                                                    <div class="filenameContainer">
                                                        <a href="{!URLFOR($Action.Attachment.Download, contractProposalSOW.Id)}">{!loadedApplicationFiles[contractProposalSOW.parentId].File_Name__c}</a>
                                                    </div>
                                                    <div class="inputLabelInline removeAttachmentContainer">
                                                        <a href="#contractProposalSOW" title="Remove {!contractProposalSOW.Name}" data-cid="{!contractProposalSOW.ParentId}" data-aId="contractProposalSOW" class="removeAttachment close">&times;</a>
                                                        <apex:actionStatus id="removing-file-ProposalSOW">
                                                            <apex:facet name="start">
                                                                <div class="search-dwelling-loader" style="text-align:center;display:inline-block;margin-left:30px; position: absolute;">
                                                                    <img src="{!URLFOR($Resource.bigutopia, '/img/ajax-loader-small.gif')}" style="height:30px;" />
                                                                </div>
                                                            </apex:facet>
                                                        </apex:actionStatus>
                                                    </div>
                                                </apex:outputPanel>

                                                <apex:outputPanel rendered="{!preApplication.Contract_Proposal_SOW__c != null && loadedApplicationFiles[preApplication.Contract_Proposal_SOW__c].Id != null && loadedApplicationFiles[preApplication.Contract_Proposal_SOW__c].S3_Uploaded__c}">{!loadedApplicationFiles[preApplication.Contract_Proposal_SOW__c].File_Name__c}</apex:outputPanel>

                                            </apex:outputPanel>
                                        </apex:actionRegion>
                                        <apex:inputFile id="contractProposalSOW" value="{!contractProposalSOW.body}" filename="{!contractProposalSOW.name}" contentType="{!contractProposalSOW.contentType}" styleClass="input-file" style="display: {!IF(preApplication.Contract_Proposal_SOW__c == null || (loadedApplicationFiles[preApplication.Contract_Proposal_SOW__c].Id == null) || (contractProposalSOW.Id == null && NOT(loadedApplicationFiles[preApplication.Contract_Proposal_SOW__c].S3_Uploaded__c)), 'inline-block', 'none')}"/>
                                    </div>
                                </div>
                                <div class="control-group controlGroupSeparation">
                                    <label class="control-label inputLabelInline" style="width:220px;">Energy Model Output (.xml) (HPXML)</label>
                                    <div class="controls inputControlInline" style="margin-left: 20px;">
                                        <apex:actionRegion >
                                            <apex:outputPanel id="attachHomePerformanceXML">
                                                <apex:outputPanel layout="block" rendered="{!homePerformanceXML.Id != null && NOT(loadedApplicationFiles[homePerformanceXML.parentId].S3_Uploaded__c)}">
                                                    <div class="filenameContainer">
                                                        <a href="{!URLFOR($Action.Attachment.Download, homePerformanceXML.Id)}">{!loadedApplicationFiles[homePerformanceXML.parentId].File_Name__c}</a>
                                                    </div>
                                                    <div class="inputLabelInline removeAttachmentContainer">
                                                        <a href="#homePerformanceXML" title="Remove {!homePerformanceXML.Name}" data-cid="{!homePerformanceXML.ParentId}" data-aId="homePerformanceXML" class="removeAttachment close">&times;</a>
                                                        <apex:actionStatus id="removing-file-HomePerformanceXML">
                                                            <apex:facet name="start">
                                                                <div class="search-dwelling-loader" style="text-align:center;display:inline-block;margin-left:30px; position: absolute;">
                                                                    <img src="{!URLFOR($Resource.bigutopia, '/img/ajax-loader-small.gif')}" style="height:30px;" />
                                                                </div>
                                                            </apex:facet>
                                                        </apex:actionStatus>
                                                     </div>
                                                </apex:outputPanel>

                                                <apex:outputPanel rendered="{!preApplication.Home_Performance_XML__c != null && loadedApplicationFiles[preApplication.Home_Performance_XML__c].Id != null && loadedApplicationFiles[preApplication.Home_Performance_XML__c].S3_Uploaded__c}">{!loadedApplicationFiles[preApplication.Home_Performance_XML__c].File_Name__c}</apex:outputPanel>

                                            </apex:outputPanel>
                                        </apex:actionRegion>
                                        <apex:inputFile id="homePerformanceXML" value="{!homePerformanceXML.body}" filename="{!homePerformanceXML.name}" contentType="{!homePerformanceXML.contentType}" styleClass="input-file" style="display: {!IF(preApplication.Home_Performance_XML__c == null || (loadedApplicationFiles[preApplication.Home_Performance_XML__c].Id == null) || (homePerformanceXML.Id == null && NOT(loadedApplicationFiles[preApplication.Home_Performance_XML__c].S3_Uploaded__c)), 'inline-block', 'none')}"/>
                                    </div>
                                </div>
                                <div class="control-group controlGroupSeparation">
                                    <label class="control-label inputLabelInline" style="width:220px;">Energy Model Input (.bld, .opt, .pdf or image file)</label>
                                    <div class="controls inputControlInline" style="margin-left: 20px;">
                                        <apex:actionRegion >
                                            <apex:outputPanel id="attachHomePerformanceSystemFile">
                                                <apex:outputPanel layout="block" rendered="{!homePerformanceSystemFile.Id != null && NOT(loadedApplicationFiles[homePerformanceSystemFile.parentId].S3_Uploaded__c)}">
                                                    <div class="filenameContainer">
                                                        <a href="{!URLFOR($Action.Attachment.Download, homePerformanceSystemFile.Id)}">{!loadedApplicationFiles[homePerformanceSystemFile.parentId].File_Name__c}</a>
                                                    </div>
                                                    <div class="inputLabelInline removeAttachmentContainer">
                                                        <a href="#homePerformanceSystemFile" title="Remove {!homePerformanceSystemFile.Name}" data-cid="{!homePerformanceSystemFile.ParentId}" data-aId="homePerformanceSystemFile" class="removeAttachment close">&times;</a>
                                                        <apex:actionStatus id="removing-file-HomePerformanceSystemFile">
                                                            <apex:facet name="start">
                                                                <div class="search-dwelling-loader" style="text-align:center;display:inline-block;margin-left:30px; position: absolute;">
                                                                    <img src="{!URLFOR($Resource.bigutopia, '/img/ajax-loader-small.gif')}" style="height:30px;" />
                                                                </div>
                                                            </apex:facet>
                                                        </apex:actionStatus>
                                                    </div>
                                                </apex:outputPanel>

                                                <apex:outputPanel rendered="{!preApplication.Home_Performance_System_File__c != null && loadedApplicationFiles[preApplication.Home_Performance_System_File__c].Id != null && loadedApplicationFiles[preApplication.Home_Performance_System_File__c].S3_Uploaded__c}">{!loadedApplicationFiles[preApplication.Home_Performance_System_File__c].File_Name__c}</apex:outputPanel>

                                            </apex:outputPanel>
                                        </apex:actionRegion>
                                        <apex:inputFile id="homePerformanceSystemFile" value="{!homePerformanceSystemFile.body}" filename="{!homePerformanceSystemFile.name}" filesize="{!homePerformanceSystemFile.BodyLength}" contentType="{!homePerformanceSystemFile.contentType}" styleClass="input-file" style="display: {!IF(preApplication.Home_Performance_System_File__c == null || (loadedApplicationFiles[preApplication.Home_Performance_System_File__c].Id == null) || (homePerformanceSystemFile.Id == null && NOT(loadedApplicationFiles[preApplication.Home_Performance_System_File__c].S3_Uploaded__c)), 'inline-block', 'none')}"/>
                                    </div>
                                </div>
                            <div class="control-group controlGroupSeparation">
                                <label class="control-label inputLabelInline" style="width:220px;">Test-In Measurements (CAS) Form (.pdf)</label>
                                <div class="controls inputControlInline" style="margin-left: 20px;">
                                    <apex:actionRegion >
                                        <apex:outputPanel id="attachTestInMeasurements">
                                            <apex:outputPanel layout="block" rendered="{!testInMeasurements.Id != null && NOT(loadedApplicationFiles[testInMeasurements.parentId].S3_Uploaded__c)}">
                                                <div class="filenameContainer">
                                                    <a href="{!URLFOR($Action.Attachment.Download, testInMeasurements.Id)}">{!loadedApplicationFiles[testInMeasurements.parentId].File_Name__c}</a>
                                                </div>
                                                <div class="inputLabelInline removeAttachmentContainer">
                                                    <a href="#testInMeasurements" title="Remove {!testInMeasurements.Name}" data-cid="{!testInMeasurements.ParentId}" data-aId="testInMeasurements" class="removeAttachment close">&times;</a>
                                                    <apex:actionStatus id="removing-file-TestInMeasurements">
                                                        <apex:facet name="start">
                                                            <div class="search-dwelling-loader" style="text-align:center;display:inline-block;margin-left:30px; position: absolute;">
                                                                <img src="{!URLFOR($Resource.bigutopia, '/img/ajax-loader-small.gif')}" style="height:30px;" />
                                                            </div>
                                                        </apex:facet>
                                                    </apex:actionStatus>
                                                </div>
                                            </apex:outputPanel>

                                            <apex:outputPanel rendered="{!preApplication.Test_In_Measurements__c != null && loadedApplicationFiles[preApplication.Test_In_Measurements__c].Id != null && loadedApplicationFiles[preApplication.Test_In_Measurements__c].S3_Uploaded__c}">{!loadedApplicationFiles[preApplication.Test_In_Measurements__c].File_Name__c}</apex:outputPanel>

                                        </apex:outputPanel>
                                    </apex:actionRegion>
                                    <apex:inputFile id="testInMeasurements" value="{!testInMeasurements.body}" filename="{!testInMeasurements.name}" contentType="{!testInMeasurements.contentType}" styleClass="input-file" style="display: {!IF(preApplication.Test_In_Measurements__c == null || (loadedApplicationFiles[preApplication.Test_In_Measurements__c].Id == null) || (testInMeasurements.Id == null && NOT(loadedApplicationFiles[preApplication.Test_In_Measurements__c].S3_Uploaded__c)), 'inline-block', 'none')}"/>
                                </div>
                            </div>
                            <div class="control-group controlGroupSeparation additionalDocumentsBottom">
                                <label class="control-label inputLabelInline optional" style="width: 220px;">Additional Documents
                                    <span class="optional-label">(As necessary/if requested by reviewer)
                                        <h4>
                                            <small>
                                                <a data-toggle="tooltip" class="help-icon" data-html="true" data-placement="right" data-trigger="hover" data-content="Photos, Specifications Documents, Heat Producing Devices (HPD) form, etc.">
                                                    <img src="{!URLFOR($Resource.acqccontractor, 'images/icon-help.png')}" />
                                                </a>
                                            </small>
                                        </h4>
                                    </span>
                                </label>
                                <div class="controls inputControlInline" style="margin-left: 20px;">
                                    <apex:actionRegion >
                                        <apex:outputPanel id="attachAdditionalDocuments">
                                            <apex:outputPanel layout="block" rendered="{!additionalDocuments.Id != null && NOT(loadedApplicationFiles[additionalDocuments.parentId].S3_Uploaded__c)}">
                                                <div class="filenameContainer">
                                                    <a href="{!URLFOR($Action.Attachment.Download, additionalDocuments.Id)}">{!loadedApplicationFiles[additionalDocuments.parentId].File_Name__c}</a>
                                                </div>
                                                <div class="inputLabelInline removeAttachmentContainer">
                                                    <a href="#additionalDocuments" title="Remove {!additionalDocuments.Name}" data-cid="{!additionalDocuments.ParentId}" data-aId="additionalDocuments" class="removeAttachment close">&times;</a>
                                                    <apex:actionStatus id="removing-file-AdditionalDocuments">
                                                        <apex:facet name="start">
                                                            <div class="search-dwelling-loader" style="text-align:center;display:inline-block;margin-left:30px; position: absolute;">
                                                                <img src="{!URLFOR($Resource.bigutopia, '/img/ajax-loader-small.gif')}" style="height:30px;" />
                                                            </div>
                                                        </apex:facet>
                                                    </apex:actionStatus>
                                                </div>
                                            </apex:outputPanel>

                                            <apex:outputPanel rendered="{!preApplication.Additional_Documents__c != null && loadedApplicationFiles[preApplication.Additional_Documents__c].Id != null && loadedApplicationFiles[preApplication.Additional_Documents__c].S3_Uploaded__c}">{!loadedApplicationFiles[preApplication.Additional_Documents__c].File_Name__c}</apex:outputPanel>

                                        </apex:outputPanel>
                                    </apex:actionRegion>
                                    <apex:inputFile id="additionalDocuments" value="{!additionalDocuments.body}" filename="{!additionalDocuments.name}" contentType="{!additionalDocuments.contentType}" styleClass="input-file" style="display: {!IF(preApplication.Additional_Documents__c == null || (loadedApplicationFiles[preApplication.Additional_Documents__c].Id == null) || (additionalDocuments.Id == null && NOT(loadedApplicationFiles[preApplication.Additional_Documents__c].S3_Uploaded__c)), 'inline-block', 'none')}"/>
                                </div>
                            </div>

                            <div class="control-group controlGroupSeparation paymentRelease">
                                <label class="control-label inputLabelInline optional" style="width: 220px;">Payment Release Authorization (.pdf) <span class="optional-label">(optional)</span></label>
                                <div class="controls inputControlInline" style="margin-left: 20px;">
                                    <apex:actionRegion >
                                        <apex:outputPanel id="attachPaymentReleaseAuthorization">
                                            <apex:outputPanel layout="block" rendered="{!paymentReleaseAuthorization.Id != null && NOT(loadedApplicationFiles[paymentReleaseAuthorization.parentId].S3_Uploaded__c)}">
                                                <div class="filenameContainer">
                                                    <a href="{!URLFOR($Action.Attachment.Download, paymentReleaseAuthorization.Id)}">{!loadedApplicationFiles[paymentReleaseAuthorization.parentId].File_Name__c}</a>
                                                </div>
                                                <div class="inputLabelInline removeAttachmentContainer">
                                                    <a href="#paymentReleaseAuthorization" title="Remove {!paymentReleaseAuthorization.Name}" data-cid="{!paymentReleaseAuthorization.ParentId}" data-aId="paymentReleaseAuthorization" class="removeAttachment close">&times;</a>
                                                    <apex:actionStatus id="removing-file-PaymentReleaseAuthorization">
                                                        <apex:facet name="start">
                                                            <div class="search-dwelling-loader" style="text-align:center;display:inline-block;margin-left:30px; position: absolute;">
                                                                <img src="{!URLFOR($Resource.bigutopia, '/img/ajax-loader-small.gif')}" style="height:30px;" />
                                                            </div>
                                                        </apex:facet>
                                                    </apex:actionStatus>
                                                </div>
                                            </apex:outputPanel>

                                            <apex:outputPanel rendered="{!preApplication.Payment_Release_Authorization__c != null && loadedApplicationFiles[preApplication.Payment_Release_Authorization__c].Id != null && loadedApplicationFiles[preApplication.Payment_Release_Authorization__c].S3_Uploaded__c}">{!loadedApplicationFiles[preApplication.Payment_Release_Authorization__c].File_Name__c}</apex:outputPanel>

                                        </apex:outputPanel>
                                    </apex:actionRegion>
                                    <apex:inputFile id="paymentReleaseAuthorization" value="{!paymentReleaseAuthorization.body}" filename="{!paymentReleaseAuthorization.name}" contentType="{!paymentReleaseAuthorization.contentType}" styleClass="input-file" style="display: {!IF(preApplication.Payment_Release_Authorization__c == null || (loadedApplicationFiles[preApplication.Payment_Release_Authorization__c].Id == null) || (paymentReleaseAuthorization.Id == null && NOT(loadedApplicationFiles[preApplication.Payment_Release_Authorization__c].S3_Uploaded__c)), 'inline-block', 'none')}"/>
                                </div>
                            </div>

                            <!-- Pre Home Energy Score Attachment -->
                            <div id="preHesAtts">
                                <div class="control-group controlGroupSeparation">
                                    <label class="control-label inputLabelInline" style="width:220px;">Green Building Registry Opt-In
                                        <small>
                                            <a data-toggle="tooltip" class="help-icon" data-html="true" data-placement="right" data-trigger="hover" data-content="A customer-signed and dated form that allows Build It Green to share their Home Energy Score with the local Multiple Listing Service where the customer's home is located (via a Green Building Registry database).">
                                                <img src="{!URLFOR($Resource.acqccontractor, 'images/icon-help.png')}" />
                                            </a>
                                        </small>
                                    </label>
                                    <div class="controls inputControlInline" style="margin-left: 20px;">
                                        <apex:actionRegion >
                                            <apex:outputPanel id="attachHomeEnergyScoreBuilding">
                                                <apex:outputPanel layout="block" rendered="{!greenBuildingRegistryOptIn.Id != null && NOT(loadedApplicationFiles[greenBuildingRegistryOptIn.parentId].S3_Uploaded__c)}">
                                                    <div class="filenameContainer">
                                                        <a href="{!URLFOR($Action.Attachment.Download, greenBuildingRegistryOptIn.Id)}">{!loadedApplicationFiles[greenBuildingRegistryOptIn.parentId].File_Name__c}</a>
                                                    </div>
                                                    <div class="inputLabelInline removeAttachmentContainer">
                                                        <a href="#homeEnergyScoreBuilding" title="Remove {!greenBuildingRegistryOptIn.Name}" data-cid="{!greenBuildingRegistryOptIn.ParentId}" data-aId="homeEnergyScoreBuilding" class="removeAttachment close">&times;</a>
                                                        <apex:actionStatus id="removing-file-HomeEnergyScoreBuilding">
                                                            <apex:facet name="start">
                                                                <div class="search-dwelling-loader" style="text-align:center;display:inline-block;margin-left:30px; position: absolute;">
                                                                    <img src="{!URLFOR($Resource.bigutopia, '/img/ajax-loader-small.gif')}" style="height:30px;" />
                                                                </div>
                                                            </apex:facet>
                                                        </apex:actionStatus>
                                                    </div>
                                                </apex:outputPanel>

                                                <apex:outputPanel rendered="{!preApplication.GBR_Opt_In__c != null && loadedApplicationFiles[preApplication.GBR_Opt_In__c].Id != null && loadedApplicationFiles[preApplication.GBR_Opt_In__c].S3_Uploaded__c}">{!loadedApplicationFiles[preApplication.GBR_Opt_In__c].File_Name__c}</apex:outputPanel>

                                            </apex:outputPanel>
                                        </apex:actionRegion>
                                        <apex:inputFile id="homeEnergyScoreBuilding" value="{!greenBuildingRegistryOptIn.body}" filename="{!greenBuildingRegistryOptIn.name}" filesize="{!greenBuildingRegistryOptIn.BodyLength}" contentType="{!greenBuildingRegistryOptIn.contentType}" styleClass="input-file" style="display: {!IF(preApplication.GBR_Opt_In__c == null || (loadedApplicationFiles[preApplication.GBR_Opt_In__c].Id == null) || (greenBuildingRegistryOptIn.Id == null && NOT(loadedApplicationFiles[preApplication.GBR_Opt_In__c].S3_Uploaded__c)), 'inline-block', 'none')}"/>
                                    </div>
                                </div>
                                <div class="control-group controlGroupSeparation">
                                    <label class="control-label inputLabelInline" style="width:220px;">Home Energy Score Report / Input File (.bld, .opt, .pdf or image file)
                                        <small>
                                            <a data-toggle="tooltip" class="help-icon" data-html="true" data-placement="right" data-trigger="hover" data-content="The energy-modeling software input file (.OPT) or input data report (.PDF) that contains the data that generated or represents the Home Energy Score value (1-10) listed above.">
                                                <img src="{!URLFOR($Resource.acqccontractor, 'images/icon-help.png')}" />
                                            </a>
                                        </small>
                                    </label>
                                    <div class="controls inputControlInline" style="margin-left: 20px;">
                                        <apex:actionRegion >
                                            <apex:outputPanel id="attachHomeEnergyScore">
                                                <apex:outputPanel layout="block" rendered="{!homeEnergyScoreReportInputFile.Id != null && NOT(loadedApplicationFiles[homeEnergyScoreReportInputFile.parentId].S3_Uploaded__c)}">
                                                    <div class="filenameContainer">
                                                        <a href="{!URLFOR($Action.Attachment.Download, homeEnergyScoreReportInputFile.Id)}">{!loadedApplicationFiles[homeEnergyScoreReportInputFile.parentId].File_Name__c}</a>
                                                    </div>
                                                    <div class="inputLabelInline removeAttachmentContainer">
                                                        <a href="#homeEnergyScore" title="Remove {!homeEnergyScoreReportInputFile.Name}" data-cid="{!homeEnergyScoreReportInputFile.ParentId}" data-aId="hesEnergyScore" class="removeAttachment close">&times;</a>
                                                        <apex:actionStatus id="removing-file-HomeEnergyScore">
                                                            <apex:facet name="start">
                                                                <div class="search-dwelling-loader" style="text-align:center;display:inline-block;margin-left:30px; position: absolute;">
                                                                    <img src="{!URLFOR($Resource.bigutopia, '/img/ajax-loader-small.gif')}" style="height:30px;" />
                                                                </div>
                                                            </apex:facet>
                                                        </apex:actionStatus>
                                                    </div>
                                                </apex:outputPanel>

                                                <apex:outputPanel rendered="{!preApplication.HES_Report_Input_File__c != null && loadedApplicationFiles[preApplication.HES_Report_Input_File__c].Id != null && loadedApplicationFiles[preApplication.HES_Report_Input_File__c].S3_Uploaded__c}">{!loadedApplicationFiles[preApplication.HES_Report_Input_File__c].File_Name__c}</apex:outputPanel>

                                            </apex:outputPanel>
                                        </apex:actionRegion>
                                        <apex:inputFile id="hesEnergyScore" value="{!homeEnergyScoreReportInputFile.body}" filename="{!homeEnergyScoreReportInputFile.name}" filesize="{!homeEnergyScoreReportInputFile.BodyLength}" contentType="{!homeEnergyScoreReportInputFile.contentType}" styleClass="input-file" style="display: {!IF(preApplication.HES_Report_Input_File__c == null || (loadedApplicationFiles[preApplication.HES_Report_Input_File__c].Id == null) || (homeEnergyScoreReportInputFile.Id == null && NOT(loadedApplicationFiles[preApplication.HES_Report_Input_File__c].S3_Uploaded__c)), 'inline-block', 'none')}"/>
                                    </div>
                                </div>

                                <div class="control-group controlGroupSeparation">
                                    <label class="control-label inputLabelInline" style="width:220px;">Additional/Supplemental Home Energy Score Documents (.zip, .pdf, .doc, .docx, .jpg, .gif, .png, .xls, .xlsx)
                                        <small>
                                            <a data-toggle="tooltip" class="help-icon" data-html="true" data-placement="right" data-trigger="hover" data-content="This would include documents specific to Home Energy Score data collection: floorplan sketch, photos of the home and it's systems (e.g., HVAC and Water Heating equipment), as well as the Home Energy Score Calculator Tool file (.XLS or .XLSX) that contains the data that was input to the energy-modeling software that generated or represents the Home Energy Score value (1-10) listed above.">
                                                <img src="{!URLFOR($Resource.acqccontractor, 'images/icon-help.png')}" />
                                            </a>
                                        </small>
                                    </label>
                                    <div class="controls inputControlInline" style="margin-left: 20px;">
                                        <apex:actionRegion >
                                            <apex:outputPanel id="attachHomeEnergyScoreAdditional">
                                                <apex:outputPanel layout="block" rendered="{!homeEnergyScoreAdditionalDocuments.Id != null && NOT(loadedApplicationFiles[homeEnergyScoreAdditionalDocuments.parentId].S3_Uploaded__c)}">
                                                    <div class="filenameContainer">
                                                        <a href="{!URLFOR($Action.Attachment.Download, homeEnergyScoreAdditionalDocuments.Id)}">{!loadedApplicationFiles[homeEnergyScoreAdditionalDocuments.parentId].File_Name__c}</a>
                                                    </div>
                                                    <div class="inputLabelInline removeAttachmentContainer">
                                                        <a href="#homeEnergyScoreAdditional" title="Remove {!homeEnergyScoreAdditionalDocuments.Name}" data-cid="{!homeEnergyScoreAdditionalDocuments.ParentId}" data-aId="homeEnergyScoreAdditional" class="removeAttachment close">&times;</a>
                                                        <apex:actionStatus id="removing-file-HomeEnergyScoreAdditional">
                                                            <apex:facet name="start">
                                                                <div class="search-dwelling-loader" style="text-align:center;display:inline-block;margin-left:30px; position: absolute;">
                                                                    <img src="{!URLFOR($Resource.bigutopia, '/img/ajax-loader-small.gif')}" style="height:30px;" />
                                                                </div>
                                                            </apex:facet>
                                                        </apex:actionStatus>
                                                    </div>
                                                </apex:outputPanel>

                                                <apex:outputPanel rendered="{!preApplication.HES_Additional_Documents__c != null && loadedApplicationFiles[preApplication.HES_Additional_Documents__c].Id != null && loadedApplicationFiles[preApplication.HES_Additional_Documents__c].S3_Uploaded__c}">{!loadedApplicationFiles[preApplication.HES_Additional_Documents__c].File_Name__c}</apex:outputPanel>

                                            </apex:outputPanel>
                                        </apex:actionRegion>
                                        <apex:inputFile id="homeEnergyScoreAdditional" value="{!homeEnergyScoreAdditionalDocuments.body}" filename="{!homeEnergyScoreAdditionalDocuments.name}" filesize="{!homeEnergyScoreAdditionalDocuments.BodyLength}" contentType="{!homeEnergyScoreAdditionalDocuments.contentType}" styleClass="input-file" style="display: {!IF(preApplication.HES_Additional_Documents__c == null || (loadedApplicationFiles[preApplication.HES_Additional_Documents__c].Id == null) || (homeEnergyScoreAdditionalDocuments.Id == null && NOT(loadedApplicationFiles[preApplication.HES_Additional_Documents__c].S3_Uploaded__c)), 'inline-block', 'none')}"/>
                                    </div>
                                </div>
                            </div>

                            </div>

                            <div class="sub-title">
                                <strong>Notes</strong>
                            </div>
                            <div id="conversation">
                                <apex:inputTextarea id="notes" value="{!AppNotes}"/>
                                <apex:outputPanel layout="none">
                                    <apex:repeat value="{!preApplicationNotes}" var="note">
                                        <div class="conversation-note">
                                            <strong>{!note.Note_Created_By__c} [<apex:outputField value="{!note.CreatedDate}"/>]:</strong><br/><apex:outputField value="{!note.Note__c}"/>
                                            <br/><br/>
                                        </div>
                                    </apex:repeat>
                                    <a href="#" class="showConversation" id="showConversation" style="display:none;">Show All</a>
                                    <script>
                                        $('#showConversation').click(function (e) {
                                            e.preventDefault();
                                            $(".conversation-note").show();
                                            $(this).hide();
                                        });
                                        if ($(".conversation-note").size() > 2) {
                                            $("#showConversation").show();
                                            $(".conversation-note").hide();
                                            $($(".conversation-note").get(0)).show();
                                            $($(".conversation-note").get(1)).show();
                                        }
                                    </script>
                                </apex:outputPanel>
                            </div>

                            <div class="center" style="padding-top:30px">
                                <div style="display: inline-block; position: relative">
                                    <input id="preAppGoNext" name="preAppGoNext" class="btn btn-primary" type="button" value="Continue" style="margin-right: 15px; width: 125px;"/>
                                    <div style="position: absolute; font-size: 12px; width: 100px; left: 0; line-height: 16px; padding: 5px 12px;">Save &amp; continue to Review</div>
                                </div>
                                <input id="savePreApp" name="savePreApp" class="btn btn-default" type="button" value="Save" style="width: 125px; display: {!IF(OR(application.Status__c == null, application.Application_Step__c == 2, action == 'edit'), 'inline-block', 'none')}" />
                            </div>

                            <apex:actionFunction action="{!savePreApplication}" name="savePreApplicationJS"/>
                            <apex:actionFunction action="{!preAppNext}" name="nextPreApplicationJS" />
                            </apex:form>
                            <script>
                                // Set default validations
                                $.validator.setDefaults({
                                    onkeyup: false,
                                    onsubmit: false,
                                    ignore: ".ignore,:hidden",
                                    messages: {
                                        '{!$Component.projectInfoForm.preRebateAssignment}': {
                                            required: 'Please select Rebate Assignment'
                                        },
                                        '{!$Component.projectInfoForm.newPreRebateAssignment}': {
                                            required: 'Please select Rebate Assignment'
                                        }
                                    },
                                    highlight: function(element) {
                                        $(element).closest('.control-group').removeClass('success').addClass('error');
                                    },
                                    success: function(element) {
                                        var $el = $(element).prev();
                                        var id = $el.attr('id');

                                        if (id) {
                                            if (id.indexOf('BPIAnalyst') !== -1
                                                    || id.indexOf('preHesScoreDate') !== -1
                                                    || id.indexOf('testInDate') !== -1
                                                    || id.indexOf('preWorkStartDate') !== -1
                                                    || id.indexOf('preWorkFinishDate') !== -1) {
                                                $(element).css('margin-left', '40px');
                                            }
                                            if (!$el.hasClass('ignore')) {
                                                element.text('OK!').addClass('valid').closest('.control-group').removeClass('error').addClass('success');
                                            }
                                        }
                                    },
                                    errorPlacement: function(error, element) {
                                        error.insertAfter(element);
                                    }
                                });

                                $('.removeAttachment').on('click', function(e) {
                                    e.preventDefault();
                                    var $el = $(this);
                                    if ($el.hasClass('disabled')) {
                                        return;
                                    }
                                    $('.removeAttachment').addClass('disabled');

                                    switch ($el.data('aid')) {
                                        case 'contractProposalSOW':
                                            removeAttachmentPreAppJS1($el.data('cid'));
                                            break;
                                        case 'homePerformanceXML':
                                            removeAttachmentPreAppJS2($el.data('cid'));
                                            break;
                                        case 'homePerformanceSystemFile':
                                            removeAttachmentPreAppJS3($el.data('cid'));
                                            break;
                                        case 'testInMeasurements':
                                            removeAttachmentPreAppJS4($el.data('cid'));
                                            break;
                                        case 'additionalDocuments':
                                            removeAttachmentPreAppJS5($el.data('cid'));
                                            break;
                                        case 'paymentReleaseAuthorization':
                                            removeAttachmentPreAppJS6($el.data('cid'));
                                            break;
                                        case 'hesEnergyScore':
                                            removeAttachmentPreAppJS7($el.data('cid'));
                                            break;
                                        case 'homeEnergyScoreAdditional':
                                            removeAttachmentPreAppJS8($el.data('cid'));
                                            break;
                                        case 'homeEnergyScoreBuilding':
                                            removeAttachmentPreAppJS9($el.data('cid'));
                                            break;
                                    }

                                });

                                $("#preAppGoNext").click( function(e) {
                                    e.preventDefault();
                                    $('.saving').removeClass('saving');

                                    if (!$(this).hasClass('goNext')) {
                                        $(this).addClass('goNext');
                                    }
                                    unbindValidation($('.projectInfoForm'));
                                    validationComplete();

                                    if (!validatePayeeInformation('AHU')) {
                                        return;
                                    }
                                    // Check if validation on payment release is needed
                                    checkPaymentReleaseValidation(
                                        $(vfToJQ("{!$Component.projectInfoForm.paymentReleaseAuthorization}")));
                                    var isValid = $('.projectInfoForm').valid();

                                    if (isValid) {
                                        disableButtons();
                                        nextPreApplicationJS();
                                    }
                                    // Process error messages.
                                    setMessage(isValid, PAGE_ERROR.MESSAGE_CONTINUE);
                                });

                                $(document).ready(function() {
                                    $(".help-icon").popover();

                                    $('#savePreApp').on('click', function(e) {
                                        e.preventDefault();
                                        unbindValidation($('.projectInfoForm'));
                                        validationOnSave();
                                        var isValid = $('.projectInfoForm').valid();

                                        if (isValid) {
                                            disableButtons();
                                            savePreApplicationJS();
                                        }
                                        // Process error messages.
                                        setMessage(isValid, PAGE_ERROR.MESSAGE_SAVE);
                                    });

                                    // Set-Up date picker for date fields
                                    $("input[id*=testInDate]").datepicker({
                                        dateFormat: 'm/d/yy',
                                        showOn: "both",
                                        maxDate: new Date(),
                                        buttonImage: "{!URLFOR($Resource.bigutopia, 'img/calendar.png')}",
                                        buttonImageOnly: true,
                                        onSelect: function(selectedDate) {
                                            /*
                                             * Verify testInDate is later than workStartDate, if so,
                                             * remove workStartDate and workFinishDate value
                                             */
                                            var $workStarDate = $("input[id*=preWorkStartDate]");
                                            var $workFinishDate = $("input[id*=preWorkFinishDate]");

                                            if ($workStarDate.val() !== "" && Date.parse(selectedDate) > Date.parse($workStarDate.val())) {
                                                $.datepicker._clearDate($workStarDate);
                                            }
                                            if ($workFinishDate.val() !== "" && Date.parse(selectedDate) > Date.parse($workFinishDate.val())) {
                                                $.datepicker._clearDate($workFinishDate);
                                            }
                                        }
                                    });

                                    // Set-Up date picker for date fields
                                    $("input[id*=preWorkStartDate]").datepicker({
                                        dateFormat: 'm/d/yy',
                                        showOn: "both",
                                        buttonImage: "{!URLFOR($Resource.bigutopia, 'img/calendar.png')}",
                                        buttonImageOnly: true,
                                        onSelect: function(selectedDate) {
                                            // Verify workStartDate is later than workFinishDate, if so, remove workFinishDate value
                                            var $workFinishDate = $("input[id*=preWorkFinishDate]");
                                            if ($workFinishDate.val() !== "" && Date.parse(selectedDate) > Date.parse($workFinishDate.val())) {
                                                $.datepicker._clearDate($workFinishDate);
                                            }
                                        },
                                        beforeShow: function() {
                                            var $tid = $("input[id*=testInDate]");
                                            var $wsd = $(this);
                                            // Verify if testInDate already has a date, if it has, set it as minDate for workStartDate
                                            if  ($tid.val() !== '') {
                                                $wsd.datepicker('option', 'minDate', $tid.val()).datepicker("refresh");
                                            }
                                        }
                                    });

                                    $("input[id*=preWorkFinishDate]").datepicker({
                                        dateFormat: 'm/d/yy',
                                        showOn: "both",
                                        buttonImage: "{!URLFOR($Resource.bigutopia, 'img/calendar.png')}",
                                        buttonImageOnly: true,
                                        beforeShow: function() {
                                            var $tid = $("input[id*=testInDate]");
                                            var $wsd = $("input[id*=preWorkStartDate]");
                                            var $wfd = $(this);
                                            // Verify if workStartDate already has a date, if it has, set it as minDate for workFinishDate
                                            var minDate = $wsd.val() !== '' ? $wsd.val() : ($tid.val() !== '' ? $tid.val() : '');
                                            $wfd.datepicker('option', 'minDate', minDate).datepicker("refresh");
                                        }
                                    });

                                    // Disable datepickers inputs so users cannot enter values manually.
                                    $('.hasDatepicker').attr('readonly', true);

                                    // Add links to Rebate assignment forms
                                    addDownloadLinksToRebateAssignment();

                                    //-----------PRE PICKLIST HAS ENERGY SCORE THIS HOME-----------------------
                                    showHideHesSection($('select[id*="preHES"]').val() == "Yes");
                                    $('select[id*="preHES"]').on('change', function() {
                                        showHideHesSection($(this).val() == 'Yes');
                                    });

                                    // Show HPHI section if user select "Yes".
                                    showHideHPHISection($('select[id*="hasPreHPHI"]').val() == "Yes");
                                    $('select[id*="hasPreHPHI"]').on('change', function() {
                                        showHideHPHISection($(this).val() == 'Yes');
                                    });
                                 });

                                // Validation when clicking next button
                                function validationComplete() {
                                    $('.projectInfoForm').validate({
                                        normalizer: function(value) {
                                            return $.trim(value);
                                        },
                                        rules: {
                                            '{!$Component.projectInfoForm.proposedPackageCost}': {
                                                required: true,
                                                currency: ["$", false],
                                                min_comma: 1,
                                                maxlength_currency: 16
                                            },
                                            '{!$Component.projectInfoForm.BPIAnalyst}': {
                                                required: true
                                            },
                                            '{!$Component.projectInfoForm.preHES}': {
                                                required: true
                                            },
                                            '{!$Component.projectInfoForm.SectionHes.hesComponent.preHesScore}': {
                                                required: true
                                            },
                                            '{!$Component.projectInfoForm.SectionHes.hesComponent.preHesScoreDate}': {
                                                required: true
                                            },
                                            '{!$Component.projectInfoForm.hasPreHPHI}': {
                                                required: true
                                            },
                                            '{!$Component.projectInfoForm.preHPHIPractitioner}': {
                                                required: true
                                            },
                                            '{!$Component.projectInfoForm.SectionHes.hesComponent.hesAssessor}': {
                                                required: true
                                            },
                                            '{!$Component.projectInfoForm.testInDate}': {
                                                required: true,
                                                date: true
                                            },
                                            '{!$Component.projectInfoForm.preWorkStartDate}': {
                                                required: true,
                                                date: true
                                            },
                                            '{!$Component.projectInfoForm.preWorkFinishDate}': {
                                                required: true,
                                                date: true
                                            },
                                            '{!$Component.projectInfoForm.preRebateAssignment}': {
                                                required: false
                                            },
                                            '{!$Component.projectInfoForm.newPreRebateAssignment}': {
                                                required: false
                                            },
                                            "{!$Component.projectInfoForm.contractProposalSOW + ':inputFile:file'}": {
                                                required: true,
                                                filenameLength: true,
                                                extension: "pdf,doc,docx,jpg,gif,png",
                                                filesize: FILE_OPTIONS.MAX_FILE_SIZE
                                            },
                                            "{!$Component.projectInfoForm.homePerformanceXML + ':inputFile:file'}": {
                                                required: true,
                                                filenameLength: true,
                                                extension: "xml",
                                                filesize: FILE_OPTIONS.MAX_HPXML_FILE_SIZE
                                            },
                                            "{!$Component.projectInfoForm.homePerformanceSystemFile + ':inputFile:file'}": {
                                                required: true,
                                                filenameLength: true,
                                                extension: "bld,opt,pdf,jpeg,jpg,gif,png",
                                                filesize: FILE_OPTIONS.MAX_FILE_SIZE
                                            },
                                            "{!$Component.projectInfoForm.testInMeasurements + ':inputFile:file'}": {
                                                required: true,
                                                filenameLength: true,
                                                extension: "pdf",
                                                filesize: FILE_OPTIONS.MAX_FILE_SIZE
                                            },
                                            "{!$Component.projectInfoForm.additionalDocuments + ':inputFile:file'}": {
                                                filenameLength: true,
                                                extension: "pdf,zip,doc,docx,jpg,gif,png",
                                                filesize: FILE_OPTIONS.MAX_FILE_SIZE
                                            },
                                            "{!$Component.projectInfoForm.paymentReleaseAuthorization + ':inputFile:file'}": {
                                                filenameLength: true,
                                                extension: "pdf",
                                                filesize: FILE_OPTIONS.MAX_FILE_SIZE
                                            },
                                            "{!$Component.projectInfoForm.homeEnergyScoreBuilding + ':inputFile:file'}": {
                                                required: true,
                                                filenameLength: true,
                                                extension: "pdf,zip,doc,docx,jpg,gif,png",
                                                filesize: FILE_OPTIONS.MAX_FILE_SIZE
                                            },
                                            "{!$Component.projectInfoForm.hesEnergyScore + ':inputFile:file'}": {
                                                required: true,
                                                filenameLength: true,
                                                extension: "bld,opt,pdf,jpeg,jpg,gif,png",
                                                filesize: FILE_OPTIONS.MAX_FILE_SIZE
                                            },
                                            "{!$Component.projectInfoForm.homeEnergyScoreAdditional + ':inputFile:file'}": {
                                                required: true,
                                                filenameLength: true,
                                                extension: "pdf,zip,doc,docx,jpg,gif,png,xls,xlsx",
                                                filesize: FILE_OPTIONS.MAX_FILE_SIZE
                                            }
                                        }
                                    });

                                }
                                // Validation when clicking save button
                                function validationOnSave() {
                                    $('.projectInfoForm').validate({
                                        onsubmit: false,
                                        normalizer: function(value) {
                                            return $.trim(value);
                                        },
                                        rules: {
                                            '{!$Component.projectInfoForm.proposedPackageCost}': {
                                                required: true,
                                                currency: ["$", false],
                                                min_comma: 1,
                                                maxlength_currency: 16
                                            },
                                            '{!$Component.projectInfoForm.testInDate}': {
                                                date: true
                                            },
                                            '{!$Component.projectInfoForm.preWorkStartDate}': {
                                                date: true
                                            },
                                            '{!$Component.projectInfoForm.preWorkFinishDate}': {
                                                date: true
                                            },
                                            "{!$Component.projectInfoForm.contractProposalSOW + ':inputFile:file'}": {
                                                filenameLength: true,
                                                extension: "pdf,doc,docx,jpg,gif,png",
                                                filesize: FILE_OPTIONS.MAX_FILE_SIZE
                                            },
                                            "{!$Component.projectInfoForm.homePerformanceXML + ':inputFile:file'}": {
                                                filenameLength: true,
                                                extension: "xml",
                                                filesize: FILE_OPTIONS.MAX_HPXML_FILE_SIZE
                                            },
                                            "{!$Component.projectInfoForm.homePerformanceSystemFile + ':inputFile:file'}": {
                                                filenameLength: true,
                                                extension: "bld,opt,pdf,jpeg,jpg,gif,png",
                                                filesize: FILE_OPTIONS.MAX_FILE_SIZE
                                            },
                                            "{!$Component.projectInfoForm.testInMeasurements + ':inputFile:file'}": {
                                                filenameLength: true,
                                                extension: "pdf",
                                                filesize: FILE_OPTIONS.MAX_FILE_SIZE
                                            },
                                            "{!$Component.projectInfoForm.additionalDocuments + ':inputFile:file'}": {
                                                filenameLength: true,
                                                extension: "pdf,zip,doc,docx,jpg,gif,png",
                                                filesize: FILE_OPTIONS.MAX_FILE_SIZE
                                            },
                                            "{!$Component.projectInfoForm.paymentReleaseAuthorization + ':inputFile:file'}": {
                                                filenameLength: true,
                                                extension: "pdf",
                                                filesize: FILE_OPTIONS.MAX_FILE_SIZE
                                            },
                                            "{!$Component.projectInfoForm.homeEnergyScoreBuilding + ':inputFile:file'}": {
                                                filenameLength: true,
                                                extension: "pdf,zip,doc,docx,jpg,gif,png",
                                                filesize: FILE_OPTIONS.MAX_FILE_SIZE
                                            },
                                            "{!$Component.projectInfoForm.hesEnergyScore + ':inputFile:file'}": {
                                                filenameLength: true,
                                                extension: "bld,opt,pdf,jpeg,jpg,gif,png",
                                                filesize: FILE_OPTIONS.MAX_FILE_SIZE
                                            },
                                            "{!$Component.projectInfoForm.homeEnergyScoreAdditional + ':inputFile:file'}": {
                                                filenameLength: true,
                                                extension: "pdf,zip,doc,docx,jpg,gif,png,xls,xlsx",
                                                filesize: FILE_OPTIONS.MAX_FILE_SIZE
                                            }
                                        }
                                    });

                                }
                            </script>
                    </div>
                    </apex:outputPanel>
                    </apex:outputPanel>
                </apex:outputPanel>

                <apex:form >
                    <!-- ACTION FUNCTIONS FOR SEARCH BUILDING -->
                    <apex:actionFunction action="{!searchDwellingUnit}" name="searchDwellingUnit" rerender="dwelling_units_list" oncomplete="showSearchDwModal()" status="search-dwelling" >
                        <apex:param name="searchText" assignTo="{!dwellingSearchText}" value=""/>
                    </apex:actionFunction>
                    <apex:actionFunction action="{!assignDwellingUnit}" name="assignDwellingUnit" rerender="appDwInfo,dwelling_units_list" oncomplete="hideSearchDwModal()">
                        <apex:param name="dwellingId" assignTo="{!dwellingToAssignId}" value=""/>
                    </apex:actionFunction>
                    <apex:actionFunction action="{!assignDwellingUnit}" name="assignDwellingUnitForm" rerender="appDwInfo" oncomplete="activeProjectPanel()">
                        <apex:param name="dwellingId" assignTo="{!dwellingToAssignId}" value=""/>
                        <apex:param name="applicationId" assignTo="{!applicationToAssignId}" value=""/>
                    </apex:actionFunction>
                    <apex:actionFunction action="{!clearDwellingSearch}" name="clearDwellingSearch" rerender="dwelling_units_list"/>
                    <!-- ACTION FUNCTIONS FOR ADVANCED APPLICATION -->
                </apex:form>
                <apex:form id="advancedAppForm" styleClass="advancedAppForm">
                    <!-- DWELLING SEARCH MODAL -->

                    <div id="searchDwModal" class="modal hide fade" style="width:940px;margin:0 auto;left:auto;position:absolute;">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true" style="font-size:45px;">&times;</button>
                            <h3 id="modalTitle">Search Building</h3>
                        </div>
                        <div class="modal-body" style="max-height:600px;">
                            <div id="dwellingUnit" class="control-group">
                                <div class="controls form-search">
                                    <div class="input-append">
                                        <input type="text" id="inputModalDwellingSearch" name="inputModalDwellingSearch" styleClass="span3 search-query"/>
                                        <button type="button" id="modalSearchDwelling" class="btn btn-primary">Search&nbsp;<i class="icon-search icon-white"></i></button>
                                        <apex:actionStatus id="search-dwelling">
                                            <apex:facet name="start">
                                                <div class="search-dwelling-loader" style="text-align:center;display:inline-block;margin-left:15px;position:absolute;">
                                                    <img src="{!URLFOR($Resource.bigutopia, '/img/ajax-loader-small.gif')}" style="height:30px;" />
                                                </div>
                                            </apex:facet>
                                        </apex:actionStatus>
                                    </div>
                                </div>
                            </div>

                            <h4 class="selectBuilding">Select a building from the list</h4>
                            <!-- DWELLING UNITS LIST -->
                            <apex:outputPanel id="dwelling_units_list">
                                 <apex:outputPanel id="dwUnitModalTable">
                                    <table class="table table-striped" style="margin-top: 20px;">
                                        <tbody>
                                               <tr>
                                                   <th>Customer Name</th><th>Building Name</th><th>Address</th><th>Zip</th>
                                               </tr>
                                           <apex:repeat value="{!dwellingUnitsList}" var="dwUnit">
                                               <tr class="dw-row">
                                                   <td><a href="#" class="set-dw" rel="{!dwUnit.Id}">{!dwUnit.Property_Owner__r.LastName}, {!dwUnit.Property_Owner__r.FirstName}</a></td>
                                                   <td><a href="#" class="set-dw" rel="{!dwUnit.Id}">{!dwUnit.Dwelling_Unit_Name__c}</a></td>
                                                   <td><a href="#" class="set-dw" rel="{!dwUnit.Id}">{!dwUnit.Street_Address__c}</a></td>
                                                   <td><a href="#" class="set-dw" rel="{!dwUnit.Id}">{!dwUnit.Building__r.ZIP_Code__c}</a></td>
                                               </tr>
                                           </apex:repeat>
                                        </tbody>
                                    </table>
                                    <apex:outputPanel rendered="{!NOT(ISBLANK(dwellingUnitsList)) && dwellingUnitsList.size > 0}">
                                    <!-- PAGINATION CONTROLS -->
                                    <apex:actionRegion >
                                        <apex:actionFunction action="{!setCurrentPageNumber}" name="setCurrentPageNumber" rerender="dwUnitModalTable">
                                            <apex:param name="pageNumber" assignTo="{!pageNumber}" value="" />
                                        </apex:actionFunction>
                                        <apex:actionFunction action="{!next}" name="goNextPage" rerender="dwUnitModalTable"/>
                                        <apex:actionFunction action="{!previous}" name="goPreviousPage" rerender="dwUnitModalTable"/>
                                     </apex:actionRegion>
                                        <div class="pagination">
                                            <ul>
                                                <li class="{!IF(hasPrevious,'','disabled')}">
                                                    <apex:outputPanel rendered="{!hasPrevious}"><a id="goPreviousPage" href="#" class="pageStep">Prev</a></apex:outputPanel>
                                                    <apex:outputPanel rendered="{!NOT(hasPrevious)}">Prev</apex:outputPanel>
                                                </li>
                                            <apex:repeat value="{!pageItems}" var="pageItem">
                                                <li class="{!IF(pageItem.isCurrentPage,'active','')}"><a class="pageItem" href="#">{!pageItem.pageNumber}</a></li>
                                            </apex:repeat>
                                                <li class="{!IF(hasNext,'','disabled')}">
                                                    <apex:outputPanel rendered="{!hasNext}"><a id="goNextPage" href="#" class="pageStep">Next</a></apex:outputPanel>
                                                    <apex:outputPanel rendered="{!NOT(hasNext)}">Next</apex:outputPanel>
                                                </li>
                                            </ul>
                                        </div>
                                        <script>
                                            // Action when click on a number on the pagination controls
                                            $('.pagination').on('click', '.pageItem', function(e) {
                                                e.preventDefault();
                                                if ($('.pageItem').find('.pageLoader').length == 0) {
                                                    if ($('.pagination ul > li').length > 3) {
                                                        var num = parseInt($(this).text());
                                                        $(this).text('');
                                                        $(this).append("<img class=\"pageLoader\" src=\"{!URLFOR($Resource.bigutopia, '/img/ajax-loader-small.gif')}\" style=\"height:20px;\" />");
                                                        setCurrentPageNumber(num);
                                                    }
                                                }
                                            });
                                            $('#goNextPage').on('click', function(e) {
                                                e.preventDefault();
                                                if ($('.pageItem').find('.pageLoader').length == 0 && $('.pageStep').find('.pageLoader').length == 0) { // No action in progress
                                                    $(this).text('');
                                                    $(this).append("<img class=\"pageLoader\" src=\"{!URLFOR($Resource.bigutopia, '/img/ajax-loader-small.gif')}\" style=\"height:20px;\" />");
                                                    goNextPage();
                                                }
                                            });
                                            $('#goPreviousPage').on('click', function(e) {
                                                e.preventDefault();
                                                if ($('.pageItem').find('.pageLoader').length == 0 && $('.pageStep').find('.pageLoader').length == 0) { // No action in progress
                                                    $(this).text('');
                                                    $(this).append("<img class=\"pageLoader\" src=\"{!URLFOR($Resource.bigutopia, '/img/ajax-loader-small.gif')}\" style=\"height:20px;\" />");
                                                    goPreviousPage();
                                                }
                                            });

                                        </script>
                                    <!-- END OF PAGINATION CONTROLS -->
                                    </apex:outputPanel>
                            </apex:outputPanel>
                            </apex:outputPanel>
                            <!-- END OF DWELLING UNITS LIST -->
                        </div>
                    </div>

                    <!-- END OF DWELLING SEARCH MODAL -->
                    <!-- BPI ANALYST MODAL -->
                    <apex:actionRegion >
                    <c:BIGPortalBpiAnalystModal ahu="true" controllerAhu="{!injectedController}"/>
                    </apex:actionRegion>
                    <!-- END OF BPI ANALYST MODAL -->

                    <!-- TODO: MERGE WIZARD HEADER -->
                    <div class="tab-content" style="margin-top: -20px;">
                        <div class="tab-pane {!IF(OR(NOT(postAppTabEnabled), ispre == 'true'), 'active' , '')}" id="preInstalationApp">
                        <!-- PRE-INSTALLATION APPLICATION DETAIL -->
                        <apex:outputPanel id="preApplicationDetailPanel" layout="none" rendered="{!OR(displayPreAppDetailSection, viewPreAppSection)}">
                            <h1 class="page-header">Advanced Home Upgrade: Pre-Installation Application</h1>
                            <apex:outputPanel layout="block" id="errors">
                                <apex:pageMessages escape="false"/>
                            </apex:outputPanel>
                            <c:BIGPortalApplicationHeader application="{!application}" controllerAhu="{!injectedController}" phase="post" />
                            <apex:outputPanel id="preApplicationBreadCrum" layout="none" rendered="{!action != 'view'}">
                                <h2 style="color: #a59998; font-size: 13px; line-height: 20px;">PRE-INSTALLATION APPLICATION PROGRESS</h2>
                                <div class="container-progress-bar">
                                    <div class="step1 steps visited"><span>1. BUILDING INFO</span></div>
                                    <div class="step2 steps visited">
                                        <span>2. PROJECT INFO</span>
                                    </div>
                                    <div class="step3 steps current"><span>3. REVIEW &amp; SUBMIT</span></div>
                                </div>
                                <h2 class="sub-header">3. Review &amp; Submit</h2>
                                <p>
                                    Please review and confirm all details before submitting your pre-installation application. If you need to edit, click the "Back" button to return to the previous page. Your pre-installation application cannot be edited after you click "Submit".
                                </p>
                            </apex:outputPanel>
                            <apex:outputPanel layout="block" rendered="{!viewPreAppButton}" style="display: inline-block; float: right;">
                                <apex:outputPanel layout="block" rendered="{!isDwellingUnitRequiredDataComplete}">
                                   <a class="btn btn-default" href="{!$Site.Prefix}/BIGPortalAdvancedHUApplication?action=edit&id={!application.Id}" style="font-weight: normal; width: 100px; margin: 10px 10px 0 0;">Edit</a>
                                </apex:outputPanel>
                                <apex:outputPanel layout="block" rendered="{!NOT(isDwellingUnitRequiredDataComplete)}">
                                   <a class="btn btn-default" href="{!$Site.Prefix}/BIGPortalAdvancedHUApplication?action=new&id={!application.Id}" style="font-weight: normal; width: 100px; margin: 10px 10px 0 0;">Edit</a>
                                </apex:outputPanel>
                            </apex:outputPanel>
                            <div class="detail-container" style="margin-left: 15px;">
                                <div class="sub-title" style="margin-top: 25px;">
                                    <strong>Building and Contract-Signing Customer Information</strong>
                                </div>
                                <div class="row">
                                    <div class="span3">
                                        Customer Name
                                    </div>
                                    <div class="span5">
                                        {!application.Customer_Last_Name__c},
                                        {!application.Customer_First_Name__c}
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="span3">
                                        Building Address
                                    </div>
                                    <div class="span5">
                                        {!application.Dwelling_Unit_Street_Address__c}
                                    </div>
                                </div>
                                <div class="row text-left">
                                    <div class="span3 text-right">
                                        City
                                    </div>
                                    <div class="" style="display: inline-block; margin-left: 20px;">
                                        {!application.Building_City__c}
                                    </div>
                                    <div class="" style="display: inline-block; margin: 0 15px 0 40px;">
                                        State
                                    </div>
                                    <div class="" style="display: inline-block;">
                                        {!application.Building_State__c}
                                    </div>
                                    <div class="" style="display: inline-block; margin: 0 15px 0 40px;">
                                        ZIP Code
                                    </div>
                                    <div class="" style="display: inline-block;">
                                        {!application.Building_ZIP_Code__c}
                                    </div>
                                    <apex:outputPanel rendered="{!NOT(ISBLANK(application.Dwelling_Unit_Number__c))}" layout="none">
                                        <div class="" style="display: inline-block; margin: 0 15px 0 40px;">
                                            Unit #
                                        </div>
                                        <div class="" style="display: inline-block;">
                                            {!application.Dwelling_Unit_Number__c}
                                        </div>
                                    </apex:outputPanel>
                                </div>
                                <!-- Payee Information -->
                                <div class="sub-title" style="margin-top: 25px;">
                                    <strong>Payee Information</strong>
                                </div>
                                <div class="row">
                                    <div class="span3">
                                        Name
                                    </div>
                                    <div class="span5">
                                        {!application.Payee_Full_Name__c}
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="span3">
                                        Address
                                    </div>
                                    <div class="span5">
                                        {!application.Payee_Street_Address__c}
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="span3"></div>
                                    <div class="span5">
                                        {!application.Payee_City__c}, {!application.Payee_State__c} {!application.Payee_ZIP_Code__c}
                                    </div>
                                </div>
                                <!-- / Payee Information -->
                                <div class="sub-title" style="margin-top: 25px;">
                                    <strong>Project Information</strong>
                                </div>
                                <div class="row">
                                    <div class="span3">
                                        Proposed Installation Cost
                                    </div>
                                    <div class="span5">
                                        <apex:outputText value="{0, number, '$'###,###,##0.00}">
                                            <apex:param value="{!preApplication.Proposed_Package_Cost__c}" />
                                        </apex:outputText>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="span3">
                                        Estimated Incentive
                                    </div>
                                    <div class="span5">
                                        <apex:outputText value="{0, number, '$'###,###,##0.00}">
                                            <apex:Param value="{!if(preApplication.Total_Incentive__c != null, IF(preApplication.Total_Incentive__c != 0, preApplication.Total_Incentive__c, 0), 0)}"/>
                                        </apex:outputText>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="span3">
                                        Customer Cost
                                    </div>
                                    <div class="span5">
                                        <apex:outputText value="{0, number, '$'###,###,##0.00}">
                                            <apex:param value="{!preApplication.Customer_Cost__c}" />
                                        </apex:outputText>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="span3">
                                        Rebate Issued to
                                    </div>
                                    <div class="span5">
                                        {!preApplication.Rebate_Assignment__c}
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="span3">
                                        Modeling Type
                                    </div>
                                    <div class="span5">
                                        {!preApplication.Modeling_Type__c}
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="span3">
                                        Test-In Date
                                    </div>
                                    <div class="span5">
                                        {!formattedTestInDate}
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="span3">Work Start Date</div>
                                    <div class="span5">
                                        {!formattedPreWorkStartDate}
                                    </div>
                                </div>

                               <div class="row">
                                   <div class="span3">Work Finish Date</div>
                                   <div class="span5">
                                        {!formattedPreWorkFinishDate}
                                   </div>
                               </div>

                               <div class="row">
                                   <div class="span3">
                                       BPI Analyst
                                   </div>
                                   <div class="span5">
                                       {!preApplication.BPI_Analyst__r.Name}
                                   </div>
                               </div>

                               <div class="row">
                                   <div class="span3">
                                       Did this home get a pre-installation Home Energy Score (HES)?
                                   </div>
                                   <div class="span5">
                                       {!application.Has_Pre_Install_HES__c}
                                   </div>
                               </div>

                               <apex:outputPanel layout="block" rendered="{!application.Has_Pre_Install_HES__c == 'Yes'}">
                                   <div class="row">
                                       <div class="span3">Home Energy Score</div>
                                       <div class="span5">
                                          {!application.Pre_Home_Energy_Score__c}
                                       </div>
                                   </div>

                                   <div class="row">
                                       <div class="span3">Home Energy Score Assessment Date</div>
                                       <div class="span5">
                                           {!formattedHomeEnergyScoreAssessmentDate}
                                       </div>
                                   </div>

                                   <div class="row">
                                       <div class="span3">Home Energy Score Assessor</div>
                                       <div class="span5">
                                           {!application.Pre_HES_Assessor__r.Name}
                                       </div>
                                   </div>
                               </apex:outputPanel>

                               <apex:outputPanel layout="block" rendered="{!NOT(ISBLANK(preApplication.Has_HPHI__c))}">
                                   <div class="row">
                                       <div class="span3">
                                           Will this home have a qualified High Performance HVAC Installation (HPHI) performed?
                                       </div>
                                       <div class="span5">
                                           {!preApplication.Has_HPHI__c}
                                       </div>
                                   </div>

                                   <apex:outputPanel layout="block" rendered="{!preApplication.Has_HPHI__c == 'Yes'}">
                                       <div class="row">
                                           <div class="span3">HPHI Practitioner</div>
                                           <div class="span5">
                                               {!preApplication.HPHI_Practitioner__r.Name}
                                           </div>
                                       </div>
                                   </apex:outputPanel>
                               </apex:outputPanel>

                                <div class="{!IF(action != 'view', 'calculations-box', 'calculations-box calculations-box-view-pre')}">
                                    <table>
                                        <tr>
                                            <td>Modeled Savings Incentive</td>
                                            <td class="align-right">
                                                {!formattedPreUnadjustedEnergySavingsPercent}
                                            </td>
                                            <td class="align-right-dollar">
                                                <apex:outputText value="{0, number, currency}">
                                                    <apex:param value="{!IF(preApplication.Total_Incentive_from_Tier__c != null, IF(preApplication.Total_Incentive_from_Tier__c != 0, preApplication.Total_Incentive_from_Tier__c, 0), 0)}"/>
                                                </apex:outputText>
                                            </td>
                                        </tr>
                                        <apex:outputPanel layout="none" rendered="{!IF(AND(splitTerritoryAdjustmentPre != null, splitTerritoryAdjustmentPre < 0), true, false)}">
                                            <tr>
                                                <td colspan="2">Split Territory Adjustment</td>
                                                <td class="align-right-dollar">
                                                    <apex:outputText value="{0, number, currency}">
                                                        <apex:param value="{!splitTerritoryAdjustmentPre}"/>
                                                    </apex:outputText>
                                                </td>
                                            </tr>
                                        </apex:outputPanel>
                                        <apex:repeat value="{!preXmlEndUseMap}" var="xmlEndUseKey">
                                            <apex:outputPanel layout="none" rendered="{!AND(xmlEndUseKey == 'KWH Kicker', preXmlEndUseMap[xmlEndUseKey].Item_Incentive_Amount__c != 0, preXmlEndUseMap[xmlEndUseKey].Item_Incentive_Amount__c != null)}">
                                                <tr>
                                                    <td>Electric Savings Bonus</td>
                                                    <td class="align-right">
                                                        <apex:outputText value="{0, number, ###,##0.00 kWh}">
                                                            <apex:param value="{!preApplication.Total_Adjusted_Savings_kWh__c}" />
                                                        </apex:outputText>
                                                    </td>
                                                    <td class="align-right-dollar">
                                                        <apex:outputText value="{0, number, currency}">
                                                            <apex:param value="{!IF(xmlEndUseKey == 'KWH Kicker', IF(preXmlEndUseMap[xmlEndUseKey].Item_Incentive_Amount__c != 0, preXmlEndUseMap[xmlEndUseKey].Item_Incentive_Amount__c, 0), '')}"/>
                                                        </apex:outputText>
                                                    </td>
                                                </tr>
                                            </apex:outputPanel>
                                            <apex:outputPanel layout="none" rendered="{!AND(xmlEndUseKey == 'Therm Kicker', preXmlEndUseMap[xmlEndUseKey].Item_Incentive_Amount__c != 0, preXmlEndUseMap[xmlEndUseKey].Item_Incentive_Amount__c != null)}">
                                                <td>Gas Savings Bonus</td>
                                                <td class="align-right">
                                                    <apex:outputText value="{0, number, ###,##0.00 therms}">
                                                        <apex:param value="{!preApplication.Total_Adjusted_Savings_therms__c}"/>
                                                    </apex:outputText>
                                                </td>
                                                <td class="align-right-dollar">
                                                    <apex:outputText value="{0, number, currency}">
                                                        <apex:param value="{!IF(xmlEndUseKey == 'Therm Kicker', IF(preXmlEndUseMap[xmlEndUseKey].Item_Incentive_Amount__c != 0, preXmlEndUseMap[xmlEndUseKey].Item_Incentive_Amount__c, 0), '')}"/>
                                                    </apex:outputText>
                                                </td>
                                            </apex:outputPanel>
                                            <apex:outputPanel layout="none" rendered="{!AND(xmlEndUseKey == 'AC Kicker', preXmlEndUseMap[xmlEndUseKey].Item_Incentive_Amount__c != 0, preXmlEndUseMap[xmlEndUseKey].Item_Incentive_Amount__c != null)}">
                                                <tr>
                                                    <td colspan="2">AC Kicker</td>
                                                    <td class="align-right-dollar">
                                                        <apex:outputText value="{0, number, currency}">
                                                            <apex:param value="{!IF(preXmlEndUseMap[xmlEndUseKey].Item_Incentive_Amount__c != null, preXmlEndUseMap[xmlEndUseKey].Item_Incentive_Amount__c, 0)}" />
                                                        </apex:outputText>
                                                    </td>
                                                </tr>
                                            </apex:outputPanel>
                                            <apex:outputPanel layout="none" rendered="{!AND(xmlEndUseKey == 'Pool Pump Kicker', preXmlEndUseMap[xmlEndUseKey].Item_Incentive_Amount__c != 0, preXmlEndUseMap[xmlEndUseKey].Item_Incentive_Amount__c != null)}">
                                                <tr>
                                                    <td colspan="2">Pool Pump Kicker</td>
                                                    <td class="align-right-dollar">
                                                        <apex:outputText value="{0, number, currency}">
                                                            <apex:param value="{!IF(preXmlEndUseMap[xmlEndUseKey].Item_Incentive_Amount__c != null, preXmlEndUseMap[xmlEndUseKey].Item_Incentive_Amount__c, 0)}" />
                                                        </apex:outputText>
                                                    </td>
                                                </tr>
                                            </apex:outputPanel>
                                        </apex:repeat>
                                        <apex:outputPanel rendered="{!preApplication.Total_Incentive_Adjustment__c != null && preApplication.Total_Incentive_Adjustment__c != 0}" layout="none">
                                            <tr>
                                                <td colspan="2">Incentive Adjustment</td>
                                                <td class="align-right-dollar">
                                                    <apex:outputText value="{0, number, currency}">
                                                        <apex:param value="{!preApplication.Total_Incentive_Adjustment__c}"/>
                                                    </apex:outputText>
                                                </td>
                                            </tr>
                                        </apex:outputPanel>
                                        <apex:outputPanel rendered="{!preApplication.HPHI_Bonus__c != null}" layout="none">
                                            <tr>
                                                <td colspan="2">Subtotal</td>
                                                <td class="align-right-dollar">
                                                    <apex:outputText value="{0, number, currency}">
                                                        <apex:param value="{!if(preApplication.HPHI_Bonus__c != null, preApplication.Total_Incentive__c - preApplication.HPHI_Bonus__c, preApplication.Total_Incentive__c)}"/>
                                                    </apex:outputText>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td colspan="2">HPHI Bonus</td>
                                                <td class="align-right-dollar">
                                                    <apex:outputText value="{0, number, currency}">
                                                        <apex:param value="{!preApplication.HPHI_Bonus__c}"/>
                                                    </apex:outputText>
                                                </td>
                                            </tr>
                                        </apex:outputPanel>
                                        <tr class="last-row-calculations-table estimated-incentive">
                                            <td colspan="2">Estimated Incentive Total</td>
                                            <td class="align-right-dollar">
                                                <apex:outputText value="{0, number, currency}">
                                                    <apex:param value="{!if(preApplication.Total_Incentive__c != null, IF(preApplication.Total_Incentive__c != 0, preApplication.Total_Incentive__c, 0), 0)}"/>
                                                </apex:outputText>
                                            </td>
                                        </tr>
                                        <apex:outputPanel rendered="{!AND(application.Status__c == 'Rebate Issued', application.Final_Incentive_Total__c != null, application.Final_Incentive_Total__c != 0)}" layout="none">
                                            <tr>
                                                <td colspan="3"><hr/></td>
                                            </tr>
                                            <tr class="last-row-calculations-table">
                                                <td colspan="2">Final Incentive Total</td>
                                                <td class="align-right-dollar">
                                                    <apex:outputText value="{0, number, currency}">
                                                        <apex:param value="{!application.Final_Incentive_Total__c}"/>
                                                    </apex:outputText>
                                                </td>
                                            </tr>
                                        </apex:outputPanel>
                                    </table>
                                </div>
                                <div class="sub-title" style="margin-top: 25px;">
                                    <strong>Required Documents</strong>
                                </div>
                                <div class="control-group">
                                    <label class="control-label inputLabelInline" style="width:220px;">Contract/Proposal/SOW</label>
                                    <div class="controls inputControlInline" style="margin-left: 20px;">
                                        <apex:outputPanel layout="block" rendered="{!contractProposalSOW.Id != null && NOT(loadedApplicationFiles[contractProposalSOW.parentId].S3_Uploaded__c)}">
                                            <div class="filenameContainer">
                                                <a href="{!URLFOR($Action.Attachment.Download, contractProposalSOW.Id)}">{!loadedApplicationFiles[contractProposalSOW.parentId].File_Name__c}</a>
                                            </div>
                                        </apex:outputPanel>

                                        <apex:outputPanel rendered="{!preApplication.Contract_Proposal_SOW__c != null && loadedApplicationFiles[preApplication.Contract_Proposal_SOW__c].Id != null && loadedApplicationFiles[preApplication.Contract_Proposal_SOW__c].S3_Uploaded__c}">{!loadedApplicationFiles[preApplication.Contract_Proposal_SOW__c].File_Name__c}</apex:outputPanel>
                                    </div>
                                </div>
                                <div class="control-group">
                                    <label class="control-label inputLabelInline" style="width:220px;">Energy Model Output (.xml) (HPXML)</label>
                                    <div class="controls inputControlInline" style="margin-left: 20px;">
                                        <apex:outputPanel layout="none" rendered="{!homePerformanceXML.Id != null && NOT(loadedApplicationFiles[homePerformanceXML.parentId].S3_Uploaded__c)}">
                                            <div class="filenameContainer">
                                                <a href="{!URLFOR($Action.Attachment.Download, homePerformanceXML.Id)}">{!loadedApplicationFiles[homePerformanceXML.parentId].File_Name__c}</a>
                                            </div>
                                        </apex:outputPanel>

                                        <apex:outputPanel rendered="{!preApplication.Home_Performance_XML__c != null && loadedApplicationFiles[preApplication.Home_Performance_XML__c].Id != null && loadedApplicationFiles[preApplication.Home_Performance_XML__c].S3_Uploaded__c}">{!loadedApplicationFiles[preApplication.Home_Performance_XML__c].File_Name__c}</apex:outputPanel>
                                    </div>
                                </div>
                                <div class="control-group">
                                    <label class="control-label inputLabelInline" style="width:220px;">Energy Model Input (.bld, .opt, .pdf or image file)</label>
                                    <div class="controls inputControlInline" style="margin-left: 20px;">
                                        <apex:outputPanel layout="none" rendered="{!homePerformanceSystemFile.Id != null && NOT(loadedApplicationFiles[homePerformanceSystemFile.parentId].S3_Uploaded__c)}">
                                            <div class="filenameContainer">
                                                <a href="{!URLFOR($Action.Attachment.Download, homePerformanceSystemFile.Id)}">{!loadedApplicationFiles[homePerformanceSystemFile.parentId].File_Name__c}</a>
                                            </div>
                                        </apex:outputPanel>

                                        <apex:outputPanel rendered="{!preApplication.Home_Performance_System_File__c != null && loadedApplicationFiles[preApplication.Home_Performance_System_File__c].Id != null && loadedApplicationFiles[preApplication.Home_Performance_System_File__c].S3_Uploaded__c}">{!loadedApplicationFiles[preApplication.Home_Performance_System_File__c].File_Name__c}</apex:outputPanel>
                                    </div>
                                </div>
                                <div class="control-group">
                                    <label class="control-label inputLabelInline" style="width:220px;">Test-In Measurements (CAS) Form (.pdf)</label>
                                    <div class="controls inputControlInline" style="margin-left: 20px;">
                                        <apex:outputPanel layout="none" rendered="{!testInMeasurements.Id != null && NOT(loadedApplicationFiles[testInMeasurements.parentId].S3_Uploaded__c)}">
                                            <div class="filenameContainer">
                                                <a href="{!URLFOR($Action.Attachment.Download, testInMeasurements.Id)}">{!loadedApplicationFiles[testInMeasurements.parentId].File_Name__c}</a>
                                            </div>
                                        </apex:outputPanel>

                                        <apex:outputPanel rendered="{!preApplication.Test_In_Measurements__c != null && loadedApplicationFiles[preApplication.Test_In_Measurements__c].Id != null && loadedApplicationFiles[preApplication.Test_In_Measurements__c].S3_Uploaded__c}">{!loadedApplicationFiles[preApplication.Test_In_Measurements__c].File_Name__c}</apex:outputPanel>
                                    </div>
                                </div>
                                <div class="control-group">
                                    <label class="control-label inputLabelInline" style="width:220px;">Additional Documents
                                        <span class="optional-label">(As necessary/if requested by reviewer)
                                        <h4>
                                            <small>
                                                <a data-toggle="tooltip" class="help-icon" data-html="true" data-placement="right" data-trigger="hover" data-content="Photos, Specifications Documents, Heat Producing Devices (HPD) form, etc.">
                                                    <img src="{!URLFOR($Resource.acqccontractor, 'images/icon-help.png')}" />
                                                </a>
                                            </small>
                                        </h4>
                                    </span>
                                    </label>
                                    <div class="controls inputControlInline" style="margin-left: 20px;">
                                        <apex:outputPanel layout="none" rendered="{!additionalDocuments.Id != null && NOT(loadedApplicationFiles[additionalDocuments.parentId].S3_Uploaded__c)}">
                                            <div class="filenameContainer">
                                                <a href="{!URLFOR($Action.Attachment.Download, additionalDocuments.Id)}">{!loadedApplicationFiles[additionalDocuments.parentId].File_Name__c}</a>
                                            </div>
                                        </apex:outputPanel>

                                        <apex:outputPanel rendered="{!preApplication.Additional_Documents__c != null && loadedApplicationFiles[preApplication.Additional_Documents__c].Id != null && loadedApplicationFiles[preApplication.Additional_Documents__c].S3_Uploaded__c}">{!loadedApplicationFiles[preApplication.Additional_Documents__c].File_Name__c}</apex:outputPanel>
                                    </div>
                                </div>
                                <div class="control-group">
                                    <label class="control-label inputLabelInline" style="width:220px;">Payment Release Authorization (.pdf)</label>
                                    <div class="controls inputControlInline" style="margin-left: 20px;">
                                        <apex:outputPanel layout="none" rendered="{!paymentReleaseAuthorization.Id != null && NOT(loadedApplicationFiles[paymentReleaseAuthorization.parentId].S3_Uploaded__c)}">
                                            <div class="filenameContainer">
                                                <a href="{!URLFOR($Action.Attachment.Download, paymentReleaseAuthorization.Id)}">{!loadedApplicationFiles[paymentReleaseAuthorization.parentId].File_Name__c}</a>
                                            </div>
                                        </apex:outputPanel>

                                        <apex:outputPanel rendered="{!preApplication.Payment_Release_Authorization__c != null && loadedApplicationFiles[preApplication.Payment_Release_Authorization__c].Id != null && loadedApplicationFiles[preApplication.Payment_Release_Authorization__c].S3_Uploaded__c}">{!loadedApplicationFiles[preApplication.Payment_Release_Authorization__c].File_Name__c}</apex:outputPanel>
                                    </div>
                                </div>
                                <!-- Pre Home Energy Score hyperlink -->
                                <apex:outputPanel rendered="{!application.Has_Pre_Install_HES__c == 'Yes'}" layout="none">
	                                <div class="control-group">
	                                    <label class="control-label inputLabelInline" style="width:220px;">Green Building Registry Opt-In</label>
	                                    <div class="controls inputControlInline" style="margin-left: 20px;">
	                                        <apex:outputPanel layout="none" rendered="{!greenBuildingRegistryOptIn.Id != null && NOT(loadedApplicationFiles[greenBuildingRegistryOptIn.parentId].S3_Uploaded__c)}">
	                                            <div class="filenameContainer">
	                                                <a href="{!URLFOR($Action.Attachment.Download, greenBuildingRegistryOptIn.Id)}">{!loadedApplicationFiles[greenBuildingRegistryOptIn.parentId].File_Name__c}</a>
	                                            </div>
	                                        </apex:outputPanel>

	                                        <apex:outputPanel rendered="{!preApplication.GBR_Opt_In__c != null && loadedApplicationFiles[preApplication.GBR_Opt_In__c].Id != null && loadedApplicationFiles[preApplication.GBR_Opt_In__c].S3_Uploaded__c}">{!loadedApplicationFiles[preApplication.GBR_Opt_In__c].File_Name__c}</apex:outputPanel>
	                                    </div>
	                                </div>
	                                <!-- Pre Home Energy Score hyperlink -->
	                                <div class="control-group">
	                                    <label class="control-label inputLabelInline" style="width:220px;">Home Energy Score Report / Input File (.bld, .opt, .pdf or image file)</label>
	                                    <div class="controls inputControlInline" style="margin-left: 20px;">
	                                        <apex:outputPanel layout="none" rendered="{!homeEnergyScoreReportInputFile.Id != null && NOT(loadedApplicationFiles[homeEnergyScoreReportInputFile.parentId].S3_Uploaded__c)}">
	                                            <div class="filenameContainer">
	                                                <a href="{!URLFOR($Action.Attachment.Download, homeEnergyScoreReportInputFile.Id)}">{!loadedApplicationFiles[homeEnergyScoreReportInputFile.parentId].File_Name__c}</a>
	                                            </div>
	                                        </apex:outputPanel>

	                                        <apex:outputPanel rendered="{!preApplication.HES_Report_Input_File__c != null && loadedApplicationFiles[preApplication.HES_Report_Input_File__c].Id != null && loadedApplicationFiles[preApplication.HES_Report_Input_File__c].S3_Uploaded__c}">{!loadedApplicationFiles[preApplication.HES_Report_Input_File__c].File_Name__c}</apex:outputPanel>
	                                    </div>
	                                </div>
	                                <!-- Pre Home Energy Score hyperlink -->
	                                <div class="control-group">
	                                    <label class="control-label inputLabelInline" style="width:220px;">Additional/Supplemental Home Energy Score Documents (.zip, .pdf, .doc, .docx, .jpg, .gif, .png, .xls, .xlsx)</label>
	                                    <div class="controls inputControlInline" style="margin-left: 20px;">

	                                        <apex:outputPanel layout="none" rendered="{!homeEnergyScoreAdditionalDocuments.Id != null && NOT(loadedApplicationFiles[homeEnergyScoreAdditionalDocuments.parentId].S3_Uploaded__c)}">
	                                            <div class="filenameContainer">
	                                                <a href="{!URLFOR($Action.Attachment.Download, homeEnergyScoreAdditionalDocuments.Id)}">{!loadedApplicationFiles[homeEnergyScoreAdditionalDocuments.parentId].File_Name__c}</a>
	                                            </div>
	                                        </apex:outputPanel>

	                                        <apex:outputPanel rendered="{!preApplication.HES_Additional_Documents__c != null && loadedApplicationFiles[preApplication.HES_Additional_Documents__c].Id != null && loadedApplicationFiles[preApplication.HES_Additional_Documents__c].S3_Uploaded__c}">{!loadedApplicationFiles[preApplication.HES_Additional_Documents__c].File_Name__c}</apex:outputPanel>
	                                    </div>
	                                </div>
                                </apex:outputPanel>

                                <div class="sub-title" style="margin-top: 25px;">
                                    <strong>Notes</strong>
                                </div>
                                <div id="conversation">
                                    <apex:inputTextarea id="notes" value="{!AppNotes}" disabled="true"/>
                                    <apex:outputPanel layout="none">
                                        <apex:repeat value="{!preApplicationNotes}" var="note">
                                            <div class="conversation-note">
                                                <strong>{!note.Note_Created_By__c} [<apex:outputField value="{!note.CreatedDate}"/>]:</strong><br/><apex:outputField value="{!note.Note__c}"/>
                                                <br/><br/>
                                            </div>
                                        </apex:repeat>
                                        <a href="#" class="showConversation" id="showConversation" style="display:none;">Show All</a>
                                        <script>
                                            $('#showConversation').click(function (e) {
                                                e.preventDefault();
                                                $(".conversation-note").show();
                                                $(this).hide();
                                            });
                                            if ($(".conversation-note").size() > 2) {
                                                $("#showConversation").show();
                                                $(".conversation-note").hide();
                                                $($(".conversation-note").get(0)).show();
                                                $($(".conversation-note").get(1)).show();
                                            }
                                        </script>
                                    </apex:outputPanel>
                                </div>
                            </div>
                            <apex:outputPanel layout="none" rendered="{!action == 'view'}">
                                <a href="{!$Site.Prefix}/BIGPortalManageApplication" style="display: inline-block; margin-top: 40px;">&lt; Back to Application List</a>
                            </apex:outputPanel>
                            <apex:outputPanel layout="none"
                                rendered="{!AND(action != 'view', OR(application.Status__c == 'Pre-Install Created', application.Status__c == 'Pre-Install Correction Required'))}">
                                <div class="center" style="padding-top:30px">
                                    <apex:commandLink styleClass="btn btn-primary disable-btn" style="width: 100px;" action="{!submitPreApplicationReview}" value="Submit" />
                                    <div style="display:inline-block; position:relative; height: 70px;">
                                        <a class="btn btn-default disable-btn" style="width: 100px; margin: 0px 0px 15px 10px;" href="{!$Site.Prefix}/BIGPortalAdvancedHUApplication?action=edit&id={!application.Id}">Back</a>
                                        <span style="position: absolute; font-size: 12px; width: 125px; left: 0; top: 30px; line-height: 16px; padding: 5px 12px;">Back to edit Application Info</span>
                                    </div>
                                </div>

                            </apex:outputPanel>
                        </apex:outputPanel><!-- / PRE-INSTALLATION APPLICATION DETAIL -->

                        <apex:outputPanel id="preApplicationConfirmPanel" layout="none" rendered="{!action == 'confirmPre'}">
                            <h1 class="page-header">Advanced Home Upgrade: Pre-Installation Application</h1>
                            <apex:outputPanel layout="block" id="errors1">
                                <apex:pageMessages escape="false"/>
                            </apex:outputPanel>

                            <div class="confirm-container" style="margin-left: 15px;">
                                <p>
                                    Build It Green's Desktop Review team will review your Pre-Installation Application and respond via email typically within the next 3 <br />business days with one of the following status updates:
                                </p>
                                <div style="margin: 30px 0px 30px 45px; width: 88%;">
                                    <p>
                                        <strong>1) Pre-Install Approved:</strong> If all information is complete, you will be issued a "Pre-Install Approved" status for your application, authorizing you to perform the improvements in your scope of work.
                                    </p>
                                    <p><strong>or</strong></p>
                                    <p>
                                        <strong>2) Pre-Install Correction Required:</strong> If the information is incomplete, you will be issued a "Pre-Install Correction Required" status for your application, with Notes instructed you on the corrections needed.
                                    </p>
                                </div>
                                <p>
                                    You can also check your application status on the <a href="{!$Site.Prefix}/BIGPortalManageApplication">Applications</a> page. If you need to contact the Desktop Review team,<br /> please visit the <a href="{!$Site.Prefix}/BIGPortalHUPHelp">Help</a> page.
                                </p>
                            </div>
                            <div class="center" style="padding-top: 30px;">
                                <a href="{!$Site.Prefix}/BIGPortalManageDashboard" style="width: 150px;" class="btn btn-default">Go to Dashboard</a>
                                <a href="{!$Site.Prefix}/BIGPortalManageApplication" style="width: 150px;" class="btn btn-default">View Applications</a>
                            </div>
                        </apex:outputPanel>
                        </div>

                        <!-- POST-INSTALLATION APPLICATION -->
                        <apex:outputPanel layout="none" rendered="{!AND(displayPostAppTab, ispre != 'true')}">
                            <div class="tab-pane {!IF(postAppTabEnabled, 'active' , '')}" id="postInstalationApp">
                                <apex:outputPanel layout="none" rendered="{!action != 'confirmPost'}">
                                    <h1 class="page-header">Advanced Home Upgrade: Post-Installation Application</h1>
                                    <div class="custom-error-box">
                                        <ul>
                                            <li class="error-custom-message"></li>
                                        </ul>
                                    </div>
                                    <apex:outputPanel layout="block" id="errors2">
                                        <apex:pageMessages escape="false"/>
                                    </apex:outputPanel>
                                    <c:BIGPortalApplicationHeader application="{!application}" controllerAhu="{!injectedController}" phase="pre" />
                                    <apex:outputPanel layout="none" rendered="{!action != 'view'}">
                                        <h2 style="color: #a59998; font-size: 13px; line-height: 20px;">POST-INSTALLATION APPLICATION PROGRESS</h2>
                                        <div class="container-progress-bar">
                                            <div class="step2 steps stepsPost {!IF(displayPostAppNewSection, 'current', 'visited')}">
                                                <span>1. PROJECT INFO</span>
                                            </div>
                                            <div class="step3 steps stepsPost {!IF(displayPostAppDetailSection, 'current', 'un-visited')}"><span>2. REVIEW &amp; SUBMIT</span></div>
                                        </div>
                                    </apex:outputPanel>
                            </apex:outputPanel>

                                <!-- NEW POST-INSTALLATION APPLICATION -->
                                <apex:outputPanel layout="none" rendered="{!displayPostAppNewSection}">
                                    <h2 class="sub-header">1. Project Information</h2>
                                    <p>
                                        Enter in the project details and upload the required forms for your rebate pre-installation application. Please combine any additional documents and photos into a .ZIP file for upload. Add any additional "Notes" about your application and hit "Continue" to review your information before submitting.
                                    </p>
                                    <span style="font-size: 13px;"><i>All fields are required unless marked "optional".</i></span>
                                    <div class="detail-container" style="margin-left: 15px; margin-top: 35px;">
                                        <div class="sub-title" style="margin-top: 25px;">
                                            <strong>Building and Contract-Signing Customer Information</strong>
                                        </div>
                                        <div class="row">
                                            <div class="span3">
                                                Customer Name
                                            </div>
                                            <div class="span5">
                                                {!application.Customer_Last_Name__c},
                                                {!application.Customer_First_Name__c}
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="span3">
                                                Building Address
                                            </div>
                                            <div class="span5">
                                                {!application.Dwelling_Unit_Street_Address__c}
                                            </div>
                                        </div>
                                        <div class="row text-left">
                                            <div class="span3 text-right">
                                                City
                                            </div>
                                            <div class="" style="display: inline-block; margin-left: 20px;">
                                                {!application.Building_City__c}
                                            </div>
                                            <div class="" style="display: inline-block; margin: 0 15px 0 40px;">
                                                State
                                            </div>
                                            <div class="" style="display: inline-block;">
                                                {!application.Building_State__c}
                                            </div>
                                            <div class="" style="display: inline-block; margin: 0 15px 0 40px;">
                                                ZIP Code
                                            </div>
                                            <div class="" style="display: inline-block;">
                                                {!application.Building_ZIP_Code__c}
                                            </div>
                                            <apex:outputPanel rendered="{!NOT(ISBLANK(application.Dwelling_Unit_Number__c))}" layout="none">
                                                <div class="" style="display: inline-block; margin: 0 15px 0 40px;">
                                                    Unit #
                                                </div>
                                                <div class="" style="display: inline-block;">
                                                    {!application.Dwelling_Unit_Number__c}
                                                </div>
                                            </apex:outputPanel>
                                        </div>
                                        <div class="sub-title" style="margin-top: 25px;">
                                            <strong>Project Information</strong>
                                        </div>
                                        <div class="row">
                                            <div class="span3">
                                                Proposed Installation Cost<span class="optional-label">(Advanced Home Upgrade measures only)</span>
                                            </div>
                                            <div class="span5">
                                                <apex:outputText value="{0, number, '$'00.00}">
                                                    <apex:param value="{!preApplication.Proposed_Package_Cost__c}" />
                                                </apex:outputText>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-horizontal" style="margin-left: 15px; margin-top: 15px;">
                                        <div class="control-group controlGroupSeparation completed-package-cost-label">
                                            <label class="control-label inputLabelInline optional">Completed Installation Cost<span class="optional-label">(Advanced Home Upgrade measures only)</span></label>
                                            <div class="controls input-container">
                                                <div class="input-prepend">
                                                    <span class="add-on">$</span>
                                                    <apex:inputField id="completedPackageCost" styleClass="span3" value="{!postApplication.Completed_Package_Cost__c}"/>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="control-group controlGroupSeparation">
                                            <label class="control-label inputLabelInline">Project Financing</label>
                                            <div class="controls input-container">
                                                <apex:outputPanel >
                                                    <select name="projectFinancingOptions" id="projectFinancingOptions" size="1">
                                                        <option value="">--None--</option>
                                                        <apex:repeat value="{!projectFinancingOptions}" var="financingSource">
                                                            <optgroup label="{!financingSource}">
                                                                <apex:repeat value="{!projectFinancingOptions[financingSource]}" var="financingOption">
                                                                    <option value="{!financingOption}">{!financingOption}</option>
                                                                </apex:repeat>
                                                            </optgroup>
                                                        </apex:repeat>
                                                    </select>
                                                </apex:outputPanel>
                                            </div>
                                            <apex:inputHidden value="{!application.Project_Financing_Source__c}" id="projectFinancingSource"/>
                                            <apex:inputHidden value="{!application.Project_Financing_Detail__c}" id="projectFinancingDetail"/>
                                        </div>
                                        <div class="control-group controlGroupSeparation" id="projectFinancingDescriptionContainer">
                                            <label class="control-label inputLabelInline">Description</label>
                                            <div class="controls input-container">
                                                <div class="input">
                                                    <apex:inputTextarea id="projectFinancingDescription" value="{!application.Project_Financing_Description__c}" style="height:20px;margin:0px;width:206px;" html-maxlength="255" styleClass="vertical-resize"/>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="control-group controlGroupSeparation">
                                            <label class="control-label inputLabelInline">Work Start Date</label>
                                            <div id="work-start-date" class="controls input-container">
                                                <div class="input">
                                                    <apex:inputText id="workPostStartDate" styleClass="span3" value="{!formattedPostWorkStartDate}" html-placeholder="{!formattedPreWorkStartDate}"/>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="control-group controlGroupSeparation">
                                            <label class="control-label inputLabelInline">Work Finish Date</label>
                                            <div id="work-finish-date" class="controls input-container">
                                                <div class="input">
                                                    <apex:inputText id="workPostFinishDate" styleClass="span3" value="{!formattedPostWorkFinishDate}" html-placeholder="{!formattedPreWorkFinishDate}"/>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="control-group controlGroupSeparation">
                                            <label class="control-label inputLabelInline">Test-Out Date</label>
                                            <div class="controls input-container">
                                                <div class="input">
                                                    <apex:inputText id="testOutDate" styleClass="span3" value="{!formattedTestOutDate}"/>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="control-group controlGroupSeparation">
                                            <label class="control-label inputLabelInline">Has the Conditioned Area Changed?</label>
                                            <div class="controls input-container">
                                                <div class="input">
                                                    <apex:inputField id="hasConditionedArea" value="{!application.Has_Conditioned_Area_Changed__c}"/>
                                                </div>
                                            </div>
                                        </div>

                                        <div id="conditionedAreaSection">
                                            <div class="control-group controlGroupSeparation">
                                                <label class="control-label inputLabelInline optional">Conditioned Area (sq ft)</label>
                                                <div class="controls input-container">
                                                    <apex:inputField id="postConditionedArea" styleClass="span3" value="{!application.Post_Conditioned_Area__c}"/>
                                                    <span class="tip-text">Enter a number between 800.00 - 7,000.00. <br/> Example: 1,960.00</span>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="control-group">
                                            <label class="control-label inputLabelInline" style="float: left;">Rebate Issued to</label>
                                            <div class="controls input-container">
                                                <apex:selectRadio id="postRebateAssignment" value="{!application.Rebate_Assignment__c}" layout="pageDirection" styleClass="options-table" onclick="getPayeeInfoFromApp('{!application.Rebate_Assignment__c}')">
                                                    <apex:selectOptions value="{!rebateTypes}" />
                                                </apex:selectRadio>
                                            </div>
                                        </div>
                                        <!-- Payee Information -->
                                        <c:BIGPortalPayeeInfo application="{!application}" dwellingUnit="{!dwellingUnit}" utilityAccount="{!utilityAccount}" account="{!account}" actionate="{!action}" page="AHU"/>
                                        <!-- / Payee Information -->
                                        <!-- BPI Analysts -->
                                        <apex:outputPanel id="postBPIAnalystList" layout="none">
                                            <div class="row" style="margin-top:5px;">
                                                <div class="span12">
                                                    <div class="control-group controlGroupSeparation">
                                                        <label class="control-label inputLabelInline mytest">BPI Analyst</label>
                                                        <div class="controls" style="display:inline-block;margin-left:20px;">
                                                            <apex:selectList id="postBPIAnalyst" value="{!selectedBPIAnalyst}" size="1">
                                                                <apex:selectOption itemValue="" itemLabel="< Select BPI Analyst >"/>
                                                                <apex:selectOptions value="{!analysts}"/>
                                                            </apex:selectList>
                                                            <a data-toggle="modal" data-target="#bpiAnalystModal" data-controls-modal="#bpiAnalystModal" data-keyboard="false" class="btn btn-default" style="padding:2px 5px 6px 6px;margin-top: -1px;margin-left: 4px;"><i class="icon-plus icon-black" style="margin-top:3px;"></i></a>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <apex:outputPanel rendered="{!BPI_IdCard != null}">
                                                <apex:inputHidden value="{!BPI_IdCard}" id="BPI_IdCard"/>
                                            </apex:outputPanel>
                                        </apex:outputPanel>
                                        <!-- / BPI Analysts -->

                                        <div class="control-group controlGroupSeparation">
                                            <label class="control-label inputLabelInline">Did this home get a post-installation Home Energy Score (HES)?</label>
                                            <div class="controls input-container">
                                                <div class="input">
                                                    <apex:inputField id="postHES" value="{!application.Has_Post_Install_HES__c}"/>
                                                </div>
                                            </div>
                                        </div>

                                        <div id="postHesSection">
                                            <c:BIGPortalHomeEnergyScore id="postSectionHes" isPostAhu="true" isAhuProgram="true" ahuController="{!injectedController}"/>
                                        </div>

                                        <apex:outputPanel layout="block" rendered="{!hasHPHIPractitioner}">
                                            <div class="control-group controlGroupSeparation">
                                                <label class="control-label inputLabelInline">Did this home have a qualified High Performance HVAC Installation (HPHI) performed?</label>
                                                <div class="controls input-container">
                                                    <div class="input">
                                                        <apex:inputField id="hasPostHPHI" value="{!application.Has_HPHI__c}"/>
                                                    </div>
                                                </div>
                                            </div>

                                            <div id="postHPHISection">
                                                <!-- HPHI Practitioner -->
                                                <apex:outputPanel id="postHPHIPractitioners" layout="none">
                                                    <div class="row" style="margin-top:5px;">
                                                        <div class="span12">
                                                            <div class="control-group controlGroupSeparation">
                                                                <label class="control-label inputLabelInline mytest">HPHI Practitioner</label>
                                                                <div class="controls" style="display:inline-block;margin-left:20px;">
                                                                    <apex:selectList id="postHPHIPractitioner" value="{!selectedHPHIPractitioner}" size="1">
                                                                        <apex:selectOption itemValue="" itemLabel="< Select HPHI Practitioner >"/>
                                                                        <apex:selectOptions value="{!HPHIPractitioners}"/>
                                                                    </apex:selectList>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </apex:outputPanel>
                                                <div class="control-group controlGroupSeparation">
                                                    <label class="control-label inputLabelInline">Delivered Sensible EER</label>
                                                    <div class="controls" style="display:inline-block;margin-left: 20px;">
                                                        <div class="input">
                                                            <apex:inputField id="postHPHIEER" styleClass="span3" value="{!application.Delivered_Sensible_EER__c}"/>
                                                            <span class="tip-text" id="postHPHIEERtip" style="margin-left: 40px;">Enter a number between 0.1 - 29.9.</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="control-group controlGroupSeparation">
                                                    <label class="control-label inputLabelInline">Delivered Sensible EER Assessment Date</label>
                                                    <div class="controls" style="display:inline-block;margin-left: 20px;">
                                                        <div class="input">
                                                            <apex:inputText id="postHPHIDate" value="{!formattedDeliveredSensibleEERAssessmentDate}"/>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </apex:outputPanel>

                                        <div class="sub-title">
                                            <strong>Required Documents</strong>
                                        </div>
                                        <apex:actionRegion >
                                            <apex:actionFunction action="{!removeAttachmentPostApp}" name="removeAttachmentPostAppJS1" rerender="attachClientSignedContractSOW" status="removing-file-ClientSignedContractSOW" oncomplete="showInputFile('clientSignedContractSOW');">
                                                <apex:param name="deleteId" assignTo="{!attachToDelete}" value="{!clientSignedContractSOW.ParentId}"/>
                                            </apex:actionFunction>
                                            <apex:actionFunction action="{!removeAttachmentPostApp}" name="removeAttachmentPostAppJS2" rerender="attachPostHomePerformanceXML" status="removing-file-PostHomePerformanceXML" oncomplete="showInputFile('postHomePerformanceXML');">
                                                <apex:param name="deleteId" assignTo="{!attachToDelete}" value="{!postHomePerformanceXML.ParentId}"/>
                                            </apex:actionFunction>
                                            <apex:actionFunction action="{!removeAttachmentPostApp}" name="removeAttachmentPostAppJS3" rerender="attachPostHomePerformanceSystemFile" status="removing-file-PostHomePerformanceSystemFile" oncomplete="showInputFile('postHomePerformanceSystemFile');">
                                                <apex:param name="deleteId" assignTo="{!attachToDelete}" value="{!postHomePerformanceSystemFile.ParentId}"/>
                                            </apex:actionFunction>
                                            <apex:actionFunction action="{!removeAttachmentPostApp}" name="removeAttachmentPostAppJS4" rerender="attachTestOutMeasurements" status="removing-file-TestOutMeasurements" oncomplete="showInputFile('testOutMeasurements');">
                                                <apex:param name="deleteId" assignTo="{!attachToDelete}" value="{!testOutMeasurements.ParentId}"/>
                                            </apex:actionFunction>
                                            <apex:actionFunction action="{!removeAttachmentPostApp}" name="removeAttachmentPostAppJS5" rerender="attachSafetyQualityAcknowledgment" status="removing-file-SafetyQualityAcknowledgment" oncomplete="showInputFile('safetyQualityAcknowledgment');">
                                                <apex:param name="deleteId" assignTo="{!attachToDelete}" value="{!safetyQualityAcknowledgment.ParentId}"/>
                                            </apex:actionFunction>
                                            <apex:actionFunction action="{!removeAttachmentPostApp}" name="removeAttachmentPostAppJS6" rerender="attachBuildingPermit" status="removing-file-BuildingPermit" oncomplete="showInputFile('buildingPermit');">
                                                <apex:param name="deleteId" assignTo="{!attachToDelete}" value="{!buildingPermit.ParentId}"/>
                                            </apex:actionFunction>
                                            <apex:actionFunction action="{!removeAttachmentPostApp}" name="removeAttachmentPostAppJS7" rerender="attachPostAdditionalDocuments" status="removing-file-PostAdditionalDocuments" oncomplete="showInputFile('postAdditionalDocuments');">
                                                <apex:param name="deleteId" assignTo="{!attachToDelete}" value="{!postAdditionalDocuments.ParentId}"/>
                                            </apex:actionFunction>
                                            <apex:actionFunction action="{!removeAttachmentPostApp}" name="removeAttachmentPostAppJS8" rerender="attachPostPaymentReleaseAuthorization" status="removing-file-PostPaymentReleaseAuthorization" oncomplete="showInputFile('postPaymentReleaseAuthorization');">
                                                <apex:param name="deleteId" assignTo="{!attachToDelete}" value="{!postPaymentReleaseAuthorization.ParentId}"/>
                                            </apex:actionFunction>
                                            <apex:actionFunction action="{!removeAttachmentPostApp}" name="removeAttachmentPostAppJS9" rerender="attachPostHomeEnergyScore" status="removing-file-PostHomeEnergyScore" oncomplete="showInputFile('postHesEnergyScore');">
                                                <apex:param name="deleteId" assignTo="{!attachToDelete}" value="{!postHomeEnergyScoreReportInputFile.ParentId}"/>
                                            </apex:actionFunction>
                                            <apex:actionFunction action="{!removeAttachmentPostApp}" name="removeAttachmentPostAppJS10" rerender="attachPostHomeEnergyScoreAdditional" status="removing-file-PostHomeEnergyScoreAdditional" oncomplete="showInputFile('postHomeEnergyScoreAdditional');">
                                                <apex:param name="deleteId" assignTo="{!attachToDelete}" value="{!postHomeEnergyScoreAdditionalDocuments.ParentId}"/>
                                            </apex:actionFunction>
                                            <apex:actionFunction action="{!removeAttachmentPostApp}" name="removeAttachmentPostAppJS11" rerender="attachPostHomeEnergyScoreBuilding" status="removing-file-PostHomeEnergyScoreBuilding" oncomplete="showInputFile('postHomeEnergyScoreBuilding');">
                                                <apex:param name="deleteId" assignTo="{!attachToDelete}" value="{!postGreenBuildingRegistryOptIn.ParentId}"/>
                                            </apex:actionFunction>
                                            <apex:actionFunction action="{!removeAttachmentPostApp}" name="removeAttachmentPostAppJS12" rerender="attachPostDeliveredEERScoresheet" status="removing-file-PostDeliveredSensibleEERScoresheet" oncomplete="showInputFile('postDeliveredSensibleEERScoresheet');">
                                                <apex:param name="deleteId" assignTo="{!attachToDelete}" value="{!postDeliveredSensibleEERScoresheet.ParentId}"/>
                                            </apex:actionFunction>

                                        </apex:actionRegion>
                                        <div class="control-group controlGroupSeparation">
                                            <label class="control-label inputLabelInline" style="width:220px;">Client-Signed Contract/SOW</label>
                                            <div class="controls inputControlInline" style="margin-left: 20px;">
                                                <apex:actionRegion >
                                                    <apex:outputPanel id="attachClientSignedContractSOW">
                                                        <apex:outputPanel layout="block" rendered="{!clientSignedContractSOW.Id != null && NOT(loadedPostApplicationFiles[clientSignedContractSOW.parentId].S3_Uploaded__c)}">
                                                            <div class="filenameContainer">
                                                                <a href="{!URLFOR($Action.Attachment.Download, clientSignedContractSOW.Id)}">{!loadedPostApplicationFiles[clientSignedContractSOW.parentId].File_Name__c}</a>
                                                            </div>
                                                            <div class="inputLabelInline removeAttachmentContainer">
                                                                <a href="#clientSignedContractSOW" title="Remove {!clientSignedContractSOW.Name}" data-cid="{!clientSignedContractSOW.ParentId}" data-aId="clientSignedContractSOW" class="removeAttachment close">&times;</a>
                                                                <apex:actionStatus id="removing-file-ClientSignedContractSOW">
                                                                    <apex:facet name="start">
                                                                        <div class="search-dwelling-loader" style="text-align:center;display:inline-block;margin-left:30px; position: absolute;">
                                                                            <img src="{!URLFOR($Resource.bigutopia, '/img/ajax-loader-small.gif')}" style="height:30px;" />
                                                                        </div>
                                                                    </apex:facet>
                                                                </apex:actionStatus>
                                                            </div>
                                                        </apex:outputPanel>
                                                        <apex:outputPanel rendered="{!postApplication.Client_Signed_Contract_SOW__c != null && loadedPostApplicationFiles[postApplication.Client_Signed_Contract_SOW__c].Id != null && loadedPostApplicationFiles[postApplication.Client_Signed_Contract_SOW__c].S3_Uploaded__c}">{!loadedPostApplicationFiles[postApplication.Client_Signed_Contract_SOW__c].File_Name__c}</apex:outputPanel>
                                                    </apex:outputPanel>
                                                </apex:actionRegion>
                                                <apex:inputFile id="clientSignedContractSOW" value="{!clientSignedContractSOW.body}" filename="{!clientSignedContractSOW.name}" contentType="{!clientSignedContractSOW.contentType}" styleClass="input-file" style="display: {!IF(postApplication.Client_Signed_Contract_SOW__c == null || (loadedPostApplicationFiles[postApplication.Client_Signed_Contract_SOW__c].Id == null) || (clientSignedContractSOW.Id == null && NOT(loadedPostApplicationFiles[postApplication.Client_Signed_Contract_SOW__c].S3_Uploaded__c)), 'inline-block', 'none')}"/>
                                            </div>
                                        </div>
                                        <div class="control-group controlGroupSeparation">
                                            <label class="control-label inputLabelInline" style="width:220px;">Energy Model Output (.xml) (HPXML)</label>
                                            <div class="controls inputControlInline" style="margin-left: 20px;">
                                                <apex:actionRegion >
                                                    <apex:outputPanel id="attachPostHomePerformanceXML">
                                                        <apex:outputPanel layout="block" rendered="{!postHomePerformanceXML.Id != null && NOT(loadedPostApplicationFiles[postHomePerformanceXML.parentId].S3_Uploaded__c)}">
                                                            <div class="filenameContainer">
                                                                <a href="{!URLFOR($Action.Attachment.Download, postHomePerformanceXML.Id)}">{!loadedPostApplicationFiles[postHomePerformanceXML.parentId].File_Name__c}</a>
                                                            </div>
                                                            <div class="inputLabelInline removeAttachmentContainer">
                                                                <a href="#postHomePerformanceXML" title="Remove {!postHomePerformanceXML.Name}" data-cid="{!postHomePerformanceXML.ParentId}" data-aId="postHomePerformanceXML" class="removeAttachment close">&times;</a>
                                                                <apex:actionStatus id="removing-file-PostHomePerformanceXML">
                                                                    <apex:facet name="start">
                                                                        <div class="search-dwelling-loader" style="text-align:center;display:inline-block;margin-left:30px; position: absolute;">
                                                                            <img src="{!URLFOR($Resource.bigutopia, '/img/ajax-loader-small.gif')}" style="height:30px;" />
                                                                        </div>
                                                                    </apex:facet>
                                                                </apex:actionStatus>
                                                            </div>
                                                        </apex:outputPanel>
                                                        <apex:outputPanel rendered="{!postApplication.Home_Performance_XML__c != null && loadedPostApplicationFiles[postApplication.Home_Performance_XML__c].Id != null && loadedPostApplicationFiles[postApplication.Home_Performance_XML__c].S3_Uploaded__c}">{!loadedPostApplicationFiles[postApplication.Home_Performance_XML__c].File_Name__c}</apex:outputPanel>
                                                    </apex:outputPanel>
                                                </apex:actionRegion>
                                                <apex:inputFile id="postHomePerformanceXML" value="{!postHomePerformanceXML.body}" filename="{!postHomePerformanceXML.name}" contentType="{!postHomePerformanceXML.contentType}" styleClass="input-file" style="display: {!IF(postApplication.Home_Performance_XML__c == null || (loadedPostApplicationFiles[postApplication.Home_Performance_XML__c].Id == null) || (postHomePerformanceXML.Id == null && NOT(loadedPostApplicationFiles[postApplication.Home_Performance_XML__c].S3_Uploaded__c)), 'inline-block', 'none')}"/>
                                            </div>
                                        </div>
                                        <div class="control-group controlGroupSeparation">
                                            <label class="control-label inputLabelInline" style="width:220px;">Energy Model Input (.bld, .opt, .pdf or image file)</label>
                                            <div class="controls inputControlInline" style="margin-left: 20px;">
                                                <apex:actionRegion >
                                                    <apex:outputPanel id="attachPostHomePerformanceSystemFile">
                                                        <apex:outputPanel layout="block" rendered="{!postHomePerformanceSystemFile.Id != null && NOT(loadedPostApplicationFiles[postHomePerformanceSystemFile.parentId].S3_Uploaded__c)}">
                                                            <div class="filenameContainer">
                                                                <a href="{!URLFOR($Action.Attachment.Download, postHomePerformanceSystemFile.Id)}">{!loadedPostApplicationFiles[postHomePerformanceSystemFile.parentId].File_Name__c}</a>
                                                            </div>
                                                            <div class="inputLabelInline removeAttachmentContainer">
                                                                <a href="#postHomePerformanceSystemFile" title="Remove {!postHomePerformanceSystemFile.Name}" data-cid="{!postHomePerformanceSystemFile.ParentId}" data-aId="postHomePerformanceSystemFile" class="removeAttachment close">&times;</a>
                                                                <apex:actionStatus id="removing-file-PostHomePerformanceSystemFile">
                                                                    <apex:facet name="start">
                                                                        <div class="search-dwelling-loader" style="text-align:center;display:inline-block;margin-left:30px; position: absolute;">
                                                                            <img src="{!URLFOR($Resource.bigutopia, '/img/ajax-loader-small.gif')}" style="height:30px;" />
                                                                        </div>
                                                                    </apex:facet>
                                                                </apex:actionStatus>
                                                            </div>
                                                        </apex:outputPanel>
                                                        <apex:outputPanel rendered="{!postApplication.Home_Performance_System_File__c != null && loadedPostApplicationFiles[postApplication.Home_Performance_System_File__c].Id != null && loadedPostApplicationFiles[postApplication.Home_Performance_System_File__c].S3_Uploaded__c}">{!loadedPostApplicationFiles[postApplication.Home_Performance_System_File__c].File_Name__c}</apex:outputPanel>
                                                    </apex:outputPanel>
                                                </apex:actionRegion>
                                                <apex:inputFile id="postHomePerformanceSystemFile" value="{!postHomePerformanceSystemFile.body}" filename="{!postHomePerformanceSystemFile.name}" filesize="{!postHomePerformanceSystemFile.BodyLength}" contentType="{!postHomePerformanceSystemFile.contentType}" styleClass="input-file" style="display: {!IF(postApplication.Home_Performance_System_File__c == null || (loadedPostApplicationFiles[postApplication.Home_Performance_System_File__c].Id == null) || (postHomePerformanceSystemFile.Id == null && NOT(loadedPostApplicationFiles[postApplication.Home_Performance_System_File__c].S3_Uploaded__c)), 'inline-block', 'none')}"/>
                                            </div>
                                        </div>
                                        <div class="control-group controlGroupSeparation">
                                            <label class="control-label inputLabelInline" style="width:220px;">Test-Out Measurements (CAS) Form (.pdf)</label>
                                            <div class="controls inputControlInline" style="margin-left: 20px;">
                                                <apex:actionRegion >
                                                    <apex:outputPanel id="attachTestOutMeasurements">
                                                        <apex:outputPanel layout="block" rendered="{!testOutMeasurements.Id != null && NOT(loadedPostApplicationFiles[testOutMeasurements.parentId].S3_Uploaded__c)}">
                                                            <div class="filenameContainer">
                                                                <a href="{!URLFOR($Action.Attachment.Download, testOutMeasurements.Id)}">{!loadedPostApplicationFiles[testOutMeasurements.parentId].File_Name__c}</a>
                                                            </div>
                                                            <div class="inputLabelInline removeAttachmentContainer">
                                                                <a href="#testOutMeasurements" title="Remove {!testOutMeasurements.Name}" data-cid="{!testOutMeasurements.ParentId}" data-aId="testOutMeasurements" class="removeAttachment close">&times;</a>
                                                                <apex:actionStatus id="removing-file-TestOutMeasurements">
                                                                    <apex:facet name="start">
                                                                        <div class="search-dwelling-loader" style="text-align:center;display:inline-block;margin-left:30px; position: absolute;">
                                                                            <img src="{!URLFOR($Resource.bigutopia, '/img/ajax-loader-small.gif')}" style="height:30px;" />
                                                                        </div>
                                                                    </apex:facet>
                                                                </apex:actionStatus>
                                                            </div>
                                                        </apex:outputPanel>
                                                        <apex:outputPanel rendered="{!postApplication.Test_Out_Measurements__c != null && loadedPostApplicationFiles[postApplication.Test_Out_Measurements__c].Id != null && loadedPostApplicationFiles[postApplication.Test_Out_Measurements__c].S3_Uploaded__c}">{!loadedPostApplicationFiles[postApplication.Test_Out_Measurements__c].File_Name__c}</apex:outputPanel>
                                                    </apex:outputPanel>
                                                </apex:actionRegion>
                                                <apex:inputFile id="testOutMeasurements" value="{!testOutMeasurements.body}" filename="{!testOutMeasurements.name}" contentType="{!testOutMeasurements.contentType}" styleClass="input-file" style="display: {!IF(postApplication.Test_Out_Measurements__c == null || (loadedPostApplicationFiles[postApplication.Test_Out_Measurements__c].Id == null) || (testOutMeasurements.Id == null && NOT(loadedPostApplicationFiles[postApplication.Test_Out_Measurements__c].S3_Uploaded__c)), 'inline-block', 'none')}"/>
                                            </div>
                                        </div>
                                        <div class="control-group controlGroupSeparation">
                                            <label class="control-label inputLabelInline" style="width:220px;">Safety &amp; Quality Acknowledgment (SQA) Form (.pdf)</label>
                                            <div class="controls inputControlInline" style="margin-left: 20px;">
                                                <apex:actionRegion >
                                                    <apex:outputPanel id="attachSafetyQualityAcknowledgment">
                                                        <apex:outputPanel layout="block" rendered="{!safetyQualityAcknowledgment.Id != null && NOT(loadedPostApplicationFiles[safetyQualityAcknowledgment.parentId].S3_Uploaded__c)}">
                                                            <div class="filenameContainer">
                                                                <a href="{!URLFOR($Action.Attachment.Download, safetyQualityAcknowledgment.Id)}">{!loadedPostApplicationFiles[safetyQualityAcknowledgment.parentId].File_Name__c}</a>
                                                            </div>
                                                            <div class="inputLabelInline removeAttachmentContainer">
                                                                <a href="#safetyQualityAcknowledgment" title="Remove {!safetyQualityAcknowledgment.Name}" data-cid="{!safetyQualityAcknowledgment.ParentId}" data-aId="safetyQualityAcknowledgment" class="removeAttachment close">&times;</a>
                                                                <apex:actionStatus id="removing-file-SafetyQualityAcknowledgment">
                                                                    <apex:facet name="start">
                                                                        <div class="search-dwelling-loader" style="text-align:center;display:inline-block;margin-left:30px; position: absolute;">
                                                                            <img src="{!URLFOR($Resource.bigutopia, '/img/ajax-loader-small.gif')}" style="height:30px;" />
                                                                        </div>
                                                                    </apex:facet>
                                                                </apex:actionStatus>
                                                            </div>
                                                        </apex:outputPanel>
                                                    </apex:outputPanel>
                                                    <apex:outputPanel rendered="{!postApplication.Safety_Quality_Acknowledgment__c != null && loadedPostApplicationFiles[postApplication.Safety_Quality_Acknowledgment__c].Id != null && loadedPostApplicationFiles[postApplication.Safety_Quality_Acknowledgment__c].S3_Uploaded__c}">{!loadedPostApplicationFiles[postApplication.Safety_Quality_Acknowledgment__c].File_Name__c}</apex:outputPanel>
                                                </apex:actionRegion>
                                                <apex:inputFile id="safetyQualityAcknowledgment" value="{!safetyQualityAcknowledgment.body}" filename="{!safetyQualityAcknowledgment.name}" contentType="{!safetyQualityAcknowledgment.contentType}" styleClass="input-file" style="display: {!IF(postApplication.Safety_Quality_Acknowledgment__c == null || (loadedPostApplicationFiles[postApplication.Safety_Quality_Acknowledgment__c].Id == null) || (safetyQualityAcknowledgment.Id == null && NOT(loadedPostApplicationFiles[postApplication.Safety_Quality_Acknowledgment__c].S3_Uploaded__c)), 'inline-block', 'none')}"/>
                                            </div>
                                        </div>
                                        <div class="control-group controlGroupSeparation">
                                            <label class="control-label inputLabelInline optional" style="width: 220px;">Closed/Finaled Building Permit <span class="optional-label">(If required for scope of work)</span></label>
                                            <div class="controls inputControlInline" style="margin-left: 20px;">
                                                <apex:actionRegion >
                                                    <apex:outputPanel id="attachBuildingPermit">
                                                        <apex:outputPanel layout="block" rendered="{!buildingPermit.Id != null && NOT(loadedPostApplicationFiles[buildingPermit.parentId].S3_Uploaded__c)}">
                                                            <div class="filenameContainer">
                                                                <a href="{!URLFOR($Action.Attachment.Download, buildingPermit.Id)}">{!loadedPostApplicationFiles[buildingPermit.parentId].File_Name__c}</a>
                                                            </div>
                                                            <div class="inputLabelInline removeAttachmentContainer">
                                                                <a href="#buildingPermit" title="Remove {!buildingPermit.Name}" data-cid="{!buildingPermit.ParentId}" data-aId="buildingPermit" class="removeAttachment close">&times;</a>
                                                                <apex:actionStatus id="removing-file-BuildingPermit">
                                                                    <apex:facet name="start">
                                                                        <div class="search-dwelling-loader" style="text-align:center;display:inline-block;margin-left:30px; position: absolute;">
                                                                            <img src="{!URLFOR($Resource.bigutopia, '/img/ajax-loader-small.gif')}" style="height:30px;" />
                                                                        </div>
                                                                    </apex:facet>
                                                                </apex:actionStatus>
                                                            </div>
                                                        </apex:outputPanel>
                                                    </apex:outputPanel>
                                                    <apex:outputPanel rendered="{!postApplication.Building_Permit__c != null && loadedPostApplicationFiles[postApplication.Building_Permit__c].Id != null && loadedPostApplicationFiles[postApplication.Building_Permit__c].S3_Uploaded__c}">{!loadedPostApplicationFiles[postApplication.Building_Permit__c].File_Name__c}</apex:outputPanel>
                                                </apex:actionRegion>
                                                <apex:inputFile id="buildingPermit" value="{!buildingPermit.body}" filename="{!buildingPermit.name}" contentType="{!buildingPermit.contentType}" styleClass="input-file" style="display: {!IF(postApplication.Building_Permit__c == null || (loadedPostApplicationFiles[postApplication.Building_Permit__c].Id == null) || (buildingPermit.Id == null && NOT(loadedPostApplicationFiles[postApplication.Building_Permit__c].S3_Uploaded__c)), 'inline-block', 'none')}"/>
                                            </div>
                                        </div>
                                        <div class="control-group controlGroupSeparation">
                                            <label class="control-label inputLabelInline optional" style="width: 220px;">Additional Documents
                                                <span class="optional-label">(As necessary/if requested by reviewer)
                                                    <h4>
                                                        <small>
                                                            <a data-toggle="tooltip" class="help-icon" data-html="true" data-placement="right" data-trigger="hover" data-content="Photos, Specifications Documents, Heat Producing Devices (HPD) form, etc.">
                                                                <img src="{!URLFOR($Resource.acqccontractor, 'images/icon-help.png')}" />
                                                            </a>
                                                        </small>
                                                    </h4>
                                                </span>
                                            </label>
                                            <div class="controls inputControlInline" style="margin-left: 20px;">
                                                <apex:actionRegion >
                                                    <apex:outputPanel id="attachPostAdditionalDocuments">
                                                        <apex:outputPanel layout="block" rendered="{!postAdditionalDocuments.Id != null && NOT(loadedPostApplicationFiles[postAdditionalDocuments.parentId].S3_Uploaded__c)}">
                                                            <div class="filenameContainer">
                                                                <a href="{!URLFOR($Action.Attachment.Download, postAdditionalDocuments.Id)}">{!loadedPostApplicationFiles[postAdditionalDocuments.parentId].File_Name__c}</a>
                                                            </div>
                                                            <div class="inputLabelInline removeAttachmentContainer">
                                                                <a href="#postAdditionalDocuments" title="Remove {!postAdditionalDocuments.Name}" data-cid="{!postAdditionalDocuments.ParentId}" data-aId="postAdditionalDocuments" class="removeAttachment close">&times;</a>
                                                                <apex:actionStatus id="removing-file-PostAdditionalDocuments">
                                                                    <apex:facet name="start">
                                                                        <div class="search-dwelling-loader" style="text-align:center;display:inline-block;margin-left:30px; position: absolute;">
                                                                            <img src="{!URLFOR($Resource.bigutopia, '/img/ajax-loader-small.gif')}" style="height:30px;" />
                                                                        </div>
                                                                    </apex:facet>
                                                                </apex:actionStatus>
                                                            </div>
                                                        </apex:outputPanel>
                                                        <apex:outputPanel rendered="{!postApplication.Additional_Documents__c != null && loadedPostApplicationFiles[postApplication.Additional_Documents__c].Id != null && loadedPostApplicationFiles[postApplication.Additional_Documents__c].S3_Uploaded__c}">{!loadedPostApplicationFiles[postApplication.Additional_Documents__c].File_Name__c}</apex:outputPanel>
                                                    </apex:outputPanel>
                                                </apex:actionRegion>
                                                <apex:inputFile id="postAdditionalDocuments" value="{!postAdditionalDocuments.body}" filename="{!postAdditionalDocuments.name}" contentType="{!postAdditionalDocuments.contentType}" styleClass="input-file" style="display: {!IF(postApplication.Additional_Documents__c == null || (loadedPostApplicationFiles[postApplication.Additional_Documents__c].Id == null) || (postAdditionalDocuments.Id == null && NOT(loadedPostApplicationFiles[postApplication.Additional_Documents__c].S3_Uploaded__c)), 'inline-block', 'none')}"/>
                                            </div>
                                        </div>
                                        <div class="control-group controlGroupSeparation">
                                            <label class="control-label inputLabelInline optional" style="width: 220px;">Payment Release Authorization (.pdf) <span class="optional-label">(optional)</span></label>
                                            <div class="controls inputControlInline" style="margin-left: 20px;">
                                                <apex:actionRegion >
                                                    <apex:outputPanel id="attachPostPaymentReleaseAuthorization">
                                                        <apex:outputPanel layout="block" rendered="{!postPaymentReleaseAuthorization.Id != null && NOT(loadedPostApplicationFiles[postPaymentReleaseAuthorization.parentId].S3_Uploaded__c)}">
                                                            <div class="filenameContainer">
                                                                <a href="{!URLFOR($Action.Attachment.Download, postPaymentReleaseAuthorization.Id)}">{!loadedPostApplicationFiles[postPaymentReleaseAuthorization.parentId].File_Name__c}</a>
                                                            </div>
                                                            <div class="inputLabelInline removeAttachmentContainer">
                                                                <a href="#postPaymentReleaseAuthorization" title="Remove {!postPaymentReleaseAuthorization.Name}" data-cid="{!postPaymentReleaseAuthorization.ParentId}" data-aId="postPaymentReleaseAuthorization" class="removeAttachment close">&times;</a>
                                                                <apex:actionStatus id="removing-file-PostPaymentReleaseAuthorization">
                                                                    <apex:facet name="start">
                                                                        <div class="search-dwelling-loader" style="text-align:center;display:inline-block;margin-left:30px; position: absolute;">
                                                                            <img src="{!URLFOR($Resource.bigutopia, '/img/ajax-loader-small.gif')}" style="height:30px;" />
                                                                        </div>
                                                                    </apex:facet>
                                                                </apex:actionStatus>
                                                            </div>
                                                        </apex:outputPanel>
                                                    </apex:outputPanel>
                                                    <apex:outputPanel rendered="{!postApplication.Payment_Release_Authorization__c != null && loadedPostApplicationFiles[postApplication.Payment_Release_Authorization__c].Id != null && loadedPostApplicationFiles[postApplication.Payment_Release_Authorization__c].S3_Uploaded__c}">{!loadedPostApplicationFiles[postApplication.Payment_Release_Authorization__c].File_Name__c}</apex:outputPanel>
                                                </apex:actionRegion>
                                                <apex:inputFile id="postPaymentReleaseAuthorization" value="{!postPaymentReleaseAuthorization.body}" filename="{!postPaymentReleaseAuthorization.name}" contentType="{!postPaymentReleaseAuthorization.contentType}" styleClass="input-file" style="display: {!IF(postApplication.Payment_Release_Authorization__c == null || (loadedPostApplicationFiles[postApplication.Payment_Release_Authorization__c].Id == null) || (postPaymentReleaseAuthorization.Id == null && NOT(loadedPostApplicationFiles[postApplication.Payment_Release_Authorization__c].S3_Uploaded__c)), 'inline-block', 'none')}"/>
                                            </div>
                                        </div>

                                        <!-- Post Home Energy Score Attachment -->
                                        <div id="postHesAtts">
                                            <div class="control-group controlGroupSeparation">
                                                <label class="control-label inputLabelInline optional" style="width: 220px;">Green Building Registry Opt-In
                                                    <small>
                                                        <a data-toggle="tooltip" class="help-icon" data-html="true" data-placement="right" data-trigger="hover" data-content="A customer-signed and dated form that allows Build It Green to share their Home Energy Score with the local Multiple Listing Service where the customer's home is located (via a Green Building Registry database).">
                                                            <img src="{!URLFOR($Resource.acqccontractor, 'images/icon-help.png')}" />
                                                        </a>
                                                    </small>
                                                </label>
                                                <div class="controls inputControlInline" style="margin-left: 20px;">
                                                    <apex:actionRegion >
                                                        <apex:outputPanel id="attachPostHomeEnergyScoreBuilding">
                                                            <apex:outputPanel layout="block" rendered="{!postGreenBuildingRegistryOptIn.Id != null && NOT(loadedPostApplicationFiles[postGreenBuildingRegistryOptIn.parentId].S3_Uploaded__c)}">
                                                                <div class="filenameContainer">
                                                                    <a href="{!URLFOR($Action.Attachment.Download, postGreenBuildingRegistryOptIn.Id)}">{!loadedPostApplicationFiles[postGreenBuildingRegistryOptIn.parentId].File_Name__c}</a>
                                                                </div>
                                                                <div class="inputLabelInline removeAttachmentContainer">
                                                                    <a href="#postPaymentReleaseAuthorization" title="Remove {!postGreenBuildingRegistryOptIn.Name}" data-cid="{!postGreenBuildingRegistryOptIn.ParentId}" data-aId="postHomeEnergyScoreBuilding" class="removeAttachment close">&times;</a>
                                                                    <apex:actionStatus id="removing-file-PostHomeEnergyScoreBuilding">
                                                                        <apex:facet name="start">
                                                                            <div class="search-dwelling-loader" style="text-align:center;display:inline-block;margin-left:30px; position: absolute;">
                                                                                <img src="{!URLFOR($Resource.bigutopia, '/img/ajax-loader-small.gif')}" style="height:30px;" />
                                                                            </div>
                                                                        </apex:facet>
                                                                    </apex:actionStatus>
                                                                </div>
                                                            </apex:outputPanel>
                                                        </apex:outputPanel>
                                                        <apex:outputPanel rendered="{!postApplication.GBR_Opt_In__c != null && loadedPostApplicationFiles[postApplication.GBR_Opt_In__c].Id != null && loadedPostApplicationFiles[postApplication.GBR_Opt_In__c].S3_Uploaded__c}">{!loadedPostApplicationFiles[postApplication.GBR_Opt_In__c].File_Name__c}</apex:outputPanel>
                                                    </apex:actionRegion>
                                                    <apex:inputFile id="postHomeEnergyScoreBuilding" value="{!postGreenBuildingRegistryOptIn.body}" filename="{!postGreenBuildingRegistryOptIn.name}" contentType="{!postGreenBuildingRegistryOptIn.contentType}" styleClass="input-file" style="display: {!IF(postApplication.GBR_Opt_In__c == null || (loadedPostApplicationFiles[postApplication.GBR_Opt_In__c].Id == null) || (postGreenBuildingRegistryOptIn.Id == null && NOT(loadedPostApplicationFiles[postApplication.GBR_Opt_In__c].S3_Uploaded__c)), 'inline-block', 'none')}"/>
                                                </div>
                                            </div>

                                            <div class="control-group controlGroupSeparation">
                                                <label class="control-label inputLabelInline optional" style="width: 220px;">Home Energy Score Report / Input File (.bld, .opt, .pdf or image file)
                                                    <small>
                                                        <a data-toggle="tooltip" class="help-icon" data-html="true" data-placement="right" data-trigger="hover" data-content="The energy-modeling software input file (.OPT) or input data report (.PDF) that contains the data that generated or represents the Home Energy Score value (1-10) listed above.">
                                                            <img src="{!URLFOR($Resource.acqccontractor, 'images/icon-help.png')}" />
                                                        </a>
                                                    </small>
                                                </label>
                                                <div class="controls inputControlInline" style="margin-left: 20px;">
                                                    <apex:actionRegion >
                                                        <apex:outputPanel id="attachPostHomeEnergyScore">
                                                            <apex:outputPanel layout="block" rendered="{!postHomeEnergyScoreReportInputFile.Id != null && NOT(loadedPostApplicationFiles[postHomeEnergyScoreReportInputFile.parentId].S3_Uploaded__c)}">
                                                                <div class="filenameContainer">
                                                                    <a href="{!URLFOR($Action.Attachment.Download, postHomeEnergyScoreReportInputFile.Id)}">{!loadedPostApplicationFiles[postHomeEnergyScoreReportInputFile.parentId].File_Name__c}</a>
                                                                </div>
                                                                <div class="inputLabelInline removeAttachmentContainer">
                                                                    <a href="#postPaymentReleaseAuthorization" title="Remove {!postHomeEnergyScoreReportInputFile.Name}" data-cid="{!postHomeEnergyScoreReportInputFile.ParentId}" data-aId="postHesEnergyScore" class="removeAttachment close">&times;</a>
                                                                    <apex:actionStatus id="removing-file-PostHomeEnergyScore">
                                                                        <apex:facet name="start">
                                                                            <div class="search-dwelling-loader" style="text-align:center;display:inline-block;margin-left:30px; position: absolute;">
                                                                                <img src="{!URLFOR($Resource.bigutopia, '/img/ajax-loader-small.gif')}" style="height:30px;" />
                                                                            </div>
                                                                        </apex:facet>
                                                                    </apex:actionStatus>
                                                                </div>
                                                            </apex:outputPanel>
                                                        </apex:outputPanel>
                                                        <apex:outputPanel rendered="{!postApplication.HES_Report_Input_File__c != null && loadedPostApplicationFiles[postApplication.HES_Report_Input_File__c].Id != null && loadedPostApplicationFiles[postApplication.HES_Report_Input_File__c].S3_Uploaded__c}">{!loadedPostApplicationFiles[postApplication.HES_Report_Input_File__c].File_Name__c}</apex:outputPanel>
                                                    </apex:actionRegion>
                                                    <apex:inputFile id="postHesEnergyScore" value="{!postHomeEnergyScoreReportInputFile.body}" filename="{!postHomeEnergyScoreReportInputFile.name}" contentType="{!postHomeEnergyScoreReportInputFile.contentType}" styleClass="input-file" style="display: {!IF(postApplication.HES_Report_Input_File__c == null || (loadedPostApplicationFiles[postApplication.HES_Report_Input_File__c].Id == null) || (postHomeEnergyScoreReportInputFile.Id == null && NOT(loadedPostApplicationFiles[postApplication.HES_Report_Input_File__c].S3_Uploaded__c)), 'inline-block', 'none')}"/>
                                                </div>
                                            </div>

                                            <div class="control-group controlGroupSeparation">
                                                <label class="control-label inputLabelInline optional" style="width: 220px;">Additional/Supplemental Home Energy Score Documents (.zip, .pdf, .doc, .docx, .jpg, .gif, .png, .xls, .xlsx)
                                                    <small>
                                                        <a data-toggle="tooltip" class="help-icon" data-html="true" data-placement="right" data-trigger="hover" data-content="This would include documents specific to Home Energy Score data collection: floorplan sketch, photos of the home and it's systems (e.g., HVAC and Water Heating equipment), as well as the Home Energy Score Calculator Tool file (.XLS or .XLSX) that contains the data that was input to the energy-modeling software that generated or represents the Home Energy Score value (1-10) listed above.">
                                                            <img src="{!URLFOR($Resource.acqccontractor, 'images/icon-help.png')}" />
                                                        </a>
                                                    </small>
                                                </label>
                                                <div class="controls inputControlInline" style="margin-left: 20px;">
                                                    <apex:actionRegion >
                                                        <apex:outputPanel id="attachPostHomeEnergyScoreAdditional">
                                                            <apex:outputPanel layout="block" rendered="{!postHomeEnergyScoreAdditionalDocuments.Id != null && NOT(loadedPostApplicationFiles[postHomeEnergyScoreAdditionalDocuments.parentId].S3_Uploaded__c)}">
                                                                <div class="filenameContainer">
                                                                    <a href="{!URLFOR($Action.Attachment.Download, postHomeEnergyScoreAdditionalDocuments.Id)}">{!loadedPostApplicationFiles[postHomeEnergyScoreAdditionalDocuments.parentId].File_Name__c}</a>
                                                                </div>
                                                                <div class="inputLabelInline removeAttachmentContainer">
                                                                    <a href="#postHomeEnergyScoreAdditional" title="Remove {!postHomeEnergyScoreAdditionalDocuments.Name}" data-cid="{!postHomeEnergyScoreAdditionalDocuments.ParentId}" data-aId="postHomeEnergyScoreAdditional" class="removeAttachment close">&times;</a>
                                                                    <apex:actionStatus id="removing-file-PostHomeEnergyScoreAdditional">
                                                                        <apex:facet name="start">
                                                                            <div class="search-dwelling-loader" style="text-align:center;display:inline-block;margin-left:30px; position: absolute;">
                                                                                <img src="{!URLFOR($Resource.bigutopia, '/img/ajax-loader-small.gif')}" style="height:30px;" />
                                                                            </div>
                                                                        </apex:facet>
                                                                    </apex:actionStatus>
                                                                </div>
                                                            </apex:outputPanel>
                                                        </apex:outputPanel>
                                                        <apex:outputPanel rendered="{!postApplication.HES_Additional_Documents__c != null && loadedPostApplicationFiles[postApplication.HES_Additional_Documents__c].Id != null && loadedPostApplicationFiles[postApplication.HES_Additional_Documents__c].S3_Uploaded__c}">{!loadedPostApplicationFiles[postApplication.HES_Additional_Documents__c].File_Name__c}</apex:outputPanel>
                                                    </apex:actionRegion>
                                                    <apex:inputFile id="postHomeEnergyScoreAdditional" value="{!postHomeEnergyScoreAdditionalDocuments.body}" filename="{!postHomeEnergyScoreAdditionalDocuments.name}" contentType="{!postHomeEnergyScoreAdditionalDocuments.contentType}" styleClass="input-file" style="display: {!IF(postApplication.HES_Additional_Documents__c == null || (loadedPostApplicationFiles[postApplication.HES_Additional_Documents__c].Id == null) || (postHomeEnergyScoreAdditionalDocuments.Id == null && NOT(loadedPostApplicationFiles[postApplication.HES_Additional_Documents__c].S3_Uploaded__c)), 'inline-block', 'none')}"/>
                                                </div>
                                            </div>
                                            <br/>
                                        </div>

                                        <!-- Post HPHI Attachment -->
                                        <div id="postHPHIAttachments">
                                            <div class="control-group controlGroupSeparation">
                                                <label class="control-label inputLabelInline optional" style="width: 220px;">Delivered Sensible EER Scoresheet (.xls, .xlsx)</label>
                                                <div class="controls inputControlInline" style="margin-left: 20px;">
                                                    <apex:actionRegion >
                                                        <apex:outputPanel id="attachPostDeliveredEERScoresheet">
                                                            <apex:outputPanel layout="block" rendered="{!postDeliveredSensibleEERScoresheet.Id != null && NOT(loadedPostApplicationFiles[postDeliveredSensibleEERScoresheet.parentId].S3_Uploaded__c)}">
                                                                <div class="filenameContainer">
                                                                    <a href="{!URLFOR($Action.Attachment.Download, postDeliveredSensibleEERScoresheet.Id)}">{!loadedPostApplicationFiles[postDeliveredSensibleEERScoresheet.parentId].File_Name__c}</a>
                                                                </div>
                                                                <div class="inputLabelInline removeAttachmentContainer">
                                                                    <a href="#postDeliveredSensibleEERScoresheet" title="Remove {!postDeliveredSensibleEERScoresheet.Name}" data-cid="{!postDeliveredSensibleEERScoresheet.ParentId}" data-aId="postDeliveredSensibleEERScoresheet" class="removeAttachment close">&times;</a>
                                                                    <apex:actionStatus id="removing-file-PostDeliveredSensibleEERScoresheet">
                                                                        <apex:facet name="start">
                                                                            <div class="search-dwelling-loader" style="text-align:center;display:inline-block;margin-left:30px; position: absolute;">
                                                                                <img src="{!URLFOR($Resource.bigutopia, '/img/ajax-loader-small.gif')}" style="height:30px;" />
                                                                            </div>
                                                                        </apex:facet>
                                                                    </apex:actionStatus>
                                                                </div>
                                                            </apex:outputPanel>
                                                        </apex:outputPanel>
                                                        <apex:outputPanel rendered="{!application.Delivered_Sensible_EER_Scoresheet__c != null && loadedPostApplicationFiles[application.Delivered_Sensible_EER_Scoresheet__c].Id != null && loadedPostApplicationFiles[application.Delivered_Sensible_EER_Scoresheet__c].S3_Uploaded__c}">
                                                            {!loadedPostApplicationFiles[application.Delivered_Sensible_EER_Scoresheet__c].File_Name__c}
                                                        </apex:outputPanel>
                                                    </apex:actionRegion>
                                                    <apex:inputFile id="postDeliveredSensibleEERScoresheet" value="{!postDeliveredSensibleEERScoresheet.body}" filename="{!postDeliveredSensibleEERScoresheet.name}" contentType="{!postDeliveredSensibleEERScoresheet.contentType}" styleClass="input-file"
                                                            style="display: {!IF(application.Delivered_Sensible_EER_Scoresheet__c == null || (loadedPostApplicationFiles[application.Delivered_Sensible_EER_Scoresheet__c].Id == null) || (postDeliveredSensibleEERScoresheet.Id == null && NOT(loadedPostApplicationFiles[application.Delivered_Sensible_EER_Scoresheet__c].S3_Uploaded__c)), 'inline-block', 'none')}"/>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="sub-title">
                                        <strong>Notes</strong>
                                    </div>
                                    <div id="post-conversation">
                                        <apex:inputTextarea id="postNotes" value="{!AppNotes}"/>
                                        <apex:outputPanel layout="none">
                                            <apex:repeat value="{!postApplicationNotes}" var="note">
                                                <div class="conversation-note">
                                                    <strong>{!note.Note_Created_By__c} [<apex:outputField value="{!note.CreatedDate}"/>]:</strong><br/><apex:outputField value="{!note.Note__c}"/>
                                                    <br/><br/>
                                                </div>
                                            </apex:repeat>
                                            <a href="#" class="showConversation" id="showPostConversation" style="display:none;">Show All</a>
                                            <script>
                                                $('#showPostConversation').click(function (e) {
                                                    e.preventDefault();
                                                    $("post-conversation .conversation-note").show();
                                                    $(this).hide();
                                                });
                                                if ($("post-conversation .conversation-note").size() > 2) {
                                                    $("#showPostConversation").show();
                                                    $("post-conversation .conversation-note").hide();
                                                    $($("post-conversation .conversation-note").get(0)).show();
                                                    $($("post-conversation .conversation-note").get(1)).show();
                                                }
                                            </script>
                                        </apex:outputPanel>
                                    </div>
                                    <div class="center" style="padding-top:30px">
                                        <div style="display: inline-block; position: relative; height: 70px;">
                                            <input id="postAppGoNext" name="postAppGoNext" class="btn btn-primary" type="button" value="Continue" style="margin: 0 0; width: 125px;" />
                                            <div style="position: absolute; font-size: 12px; width: 100px; left: 0; line-height: 16px; padding: 5px 12px;">Save &amp; continue to Review</div>
                                        </div>
                                        <a href="BIGPortalManageDashboard" class="btn btn-default disable-btn" style="width: 100px;">Cancel</a>
                                        <input id="savePostApp" name="savePostApp" class="btn btn-default" type="button" value="Save"
                                                            style="width: 125px; display: {!IF(OR(application.Status__c == null), 'none', 'inline-block')}"/>
                                    </div>

                                    <apex:actionFunction action="{!savePostApplication}" name="savePostApplicationJS"/>
                                    <apex:actionFunction action="{!postAppNext}" name="nextPostApplicationJS"/>
                                    <script>
                                        // Set default validations
                                        $.validator.setDefaults({
                                            onkeyup: false,
                                            onsubmit: false,
                                            ignore: ".ignore,:hidden",
                                            messages: {
                                                '{!$Component.advancedAppForm.postRebateAssignment}': {
                                                    required: 'Please select Rebate Assignment'
                                                },
                                                '{!$Component.advancedAppForm.postConditionedArea}': {
                                                    range: "Please enter a number between 800.00 - 7,000.00."
                                                }
                                            },
                                            highlight: function(element) {
                                                $(element).closest('.control-group').removeClass('success').addClass('error');
                                            },
                                            success: function(element) {
                                                var $el = $(element).prev();
                                                var id = $el.attr('id');

                                                if (id) {
                                                    if (id.indexOf('BPIAnalyst') !== -1
                                                            || id.indexOf('postHesScoreDate') !== -1
                                                            || id.indexOf('testOutDate') !== -1
                                                            || id.indexOf('workPostStartDate') !== -1
                                                            || id.indexOf('workPostFinishDate') !== -1
                                                            || id.indexOf('postHPHIDate') !== -1) {
                                                        $(element).css('margin-left', '40px');
                                                    }
                                                    if (!$el.hasClass('ignore')) {
                                                        element.text('OK!').addClass('valid').closest('.control-group').removeClass('error').addClass('success');
                                                    }
                                                }
                                            },
                                            errorPlacement: function(error, element) {
                                                error.insertAfter(element);
                                            }
                                        });

                                        $('.removeAttachment').on('click', function(e) {
                                            e.preventDefault();
                                            var $el = $(this);
                                            if ($el.hasClass('disabled')) {
                                                return;
                                            }
                                            $('.removeAttachment').addClass('disabled');

                                            switch ($el.data('aid')) {
                                                case 'clientSignedContractSOW':
                                                    removeAttachmentPostAppJS1($el.data('cid'));
                                                    break;
                                                case 'postHomePerformanceXML':
                                                    removeAttachmentPostAppJS2($el.data('cid'));
                                                    break;
                                                case 'postHomePerformanceSystemFile':
                                                    removeAttachmentPostAppJS3($el.data('cid'));
                                                    break;
                                                case 'testOutMeasurements':
                                                    removeAttachmentPostAppJS4($el.data('cid'));
                                                    break;
                                                case 'safetyQualityAcknowledgment':
                                                    removeAttachmentPostAppJS5($el.data('cid'));
                                                    break;
                                                case 'buildingPermit':
                                                    removeAttachmentPostAppJS6($el.data('cid'));
                                                    break;
                                                case 'postAdditionalDocuments':
                                                    removeAttachmentPostAppJS7($el.data('cid'));
                                                    break;
                                                case 'postPaymentReleaseAuthorization':
                                                    removeAttachmentPostAppJS8($el.data('cid'));
                                                    break;
                                                case 'postHesEnergyScore':
                                                    removeAttachmentPostAppJS9($el.data('cid'));
                                                    break;
                                                case 'postHomeEnergyScoreAdditional':
                                                    removeAttachmentPostAppJS10($el.data('cid'));
                                                    break;
                                                case 'postHomeEnergyScoreBuilding':
                                                    removeAttachmentPostAppJS11($el.data('cid'));
                                                    break;
                                                case 'postDeliveredSensibleEERScoresheet':
                                                    removeAttachmentPostAppJS12($el.data('cid'));
                                                    break;
                                            }
                                        });

                                        // Validation when clicking next button
                                        function validationPostComplete() {
                                            $(vfToJQ("{!$Component.advancedAppForm}")).validate({
                                                normalizer: function(value) {
                                                    return $.trim(value);
                                                },
                                                rules: {
                                                    '{!$Component.advancedAppForm.completedPackageCost}': {
                                                        required: true,
                                                        currency: ["$", false],
                                                        min_comma: 1,
                                                        maxlength_currency: 16
                                                    },
                                                    'projectFinancingOptions': {
                                                        selectOptionEmpty: true
                                                    },
                                                    '{!$Component.advancedAppForm.projectFinancingDescription}': {
                                                        required: true
                                                    },
                                                    '{!$Component.advancedAppForm.workPostStartDate}': {
                                                        required: true
                                                    },
                                                    '{!$Component.advancedAppForm.workPostFinishDate}': {
                                                        required: true
                                                    },
                                                    '{!$Component.advancedAppForm.testOutDate}': {
                                                        required: true,
                                                        date: true
                                                    },
                                                    '{!$Component.advancedAppForm.postBPIAnalyst}': {
                                                        required: true
                                                    },
                                                    '{!$Component.advancedAppForm.postHES}': {
                                                        required: true
                                                    },
                                                    '{!$Component.advancedAppForm.hasPostHPHI}': {
                                                        required: true
                                                    },
                                                    '{!$Component.advancedAppForm.postHPHIPractitioner}': {
                                                        required: true
                                                    },
                                                    '{!$Component.advancedAppForm.postHPHIEER}': {
                                                        required: true,
                                                        validateHPHIEERRange: true
                                                    },
                                                    '{!$Component.advancedAppForm.postHPHIDate}': {
                                                        required: true
                                                    },
                                                    '{!$Component.advancedAppForm.hasConditionedArea}': {
                                                        required: true
                                                    },
                                                    '{!$Component.advancedAppForm.postSectionHes.hesComponent.postHesScore}': {
                                                        required: true
                                                    },
                                                    '{!$Component.advancedAppForm.postSectionHes.hesComponent.postHesScoreDate}': {
                                                        required: true
                                                    },
                                                    '{!$Component.advancedAppForm.postSectionHes.hesComponent.hesAssessor}': {
                                                        required: true
                                                    },
                                                    '{!$Component.advancedAppForm.postConditionedArea}': {
                                                        required: true,
                                                        range: [800, 7000],
                                                        validatePostConditionedArea: true
                                                    },
                                                    "{!$Component.advancedAppForm.clientSignedContractSOW + ':inputFile:file'}": {
                                                        required:true,
                                                        filenameLength: true,
                                                        extension: "pdf,doc,docx,jpg,gif,png",
                                                        filesize: FILE_OPTIONS.MAX_FILE_SIZE
                                                    },
                                                    "{!$Component.advancedAppForm.postHomePerformanceXML + ':inputFile:file'}": {
                                                        required:true,
                                                        filenameLength: true,
                                                        extension: "xml",
                                                        filesize: FILE_OPTIONS.MAX_HPXML_FILE_SIZE
                                                    },
                                                    "{!$Component.advancedAppForm.postHomePerformanceSystemFile + ':inputFile:file'}": {
                                                        required:true,
                                                        filenameLength: true,
                                                        extension: "bld,opt,pdf,jpeg,jpg,gif,png",
                                                        filesize: FILE_OPTIONS.MAX_FILE_SIZE
                                                    },
                                                    "{!$Component.advancedAppForm.testOutMeasurements + ':inputFile:file'}": {
                                                        required:true,
                                                        filenameLength: true,
                                                        extension: "pdf",
                                                        filesize: FILE_OPTIONS.MAX_FILE_SIZE
                                                    },
                                                    "{!$Component.advancedAppForm.safetyQualityAcknowledgment + ':inputFile:file'}": {
                                                        required:true,
                                                        filenameLength: true,
                                                        extension: "pdf",
                                                        filesize: FILE_OPTIONS.MAX_FILE_SIZE
                                                    },
                                                    "{!$Component.advancedAppForm.buildingPermit + ':inputFile:file'}": {
                                                        filenameLength: true,
                                                        extension: "pdf,doc,docx,txt,jpeg,jpg,png,tif,tiff",
                                                        filesize: FILE_OPTIONS.MAX_FILE_SIZE
                                                    },
                                                    "{!$Component.advancedAppForm.postAdditionalDocuments + ':inputFile:file'}": {
                                                        filenameLength: true,
                                                        extension: "pdf,zip,doc,docx,jpg,gif,png",
                                                        filesize: FILE_OPTIONS.MAX_FILE_SIZE
                                                    },
                                                    "{!$Component.advancedAppForm.postPaymentReleaseAuthorization + ':inputFile:file'}": {
                                                        filenameLength: true,
                                                        extension: "pdf",
                                                        filesize: FILE_OPTIONS.MAX_FILE_SIZE
                                                    },
                                                    "{!$Component.advancedAppForm.postHomeEnergyScoreBuilding + ':inputFile:file'}": {
                                                        required: true,
                                                        filenameLength: true,
                                                        extension: "pdf,zip,doc,docx,jpg,gif,png",
                                                        filesize: FILE_OPTIONS.MAX_FILE_SIZE
                                                    },
                                                    "{!$Component.advancedAppForm.postHesEnergyScore + ':inputFile:file'}": {
                                                        required: true,
                                                        filenameLength: true,
                                                        extension: "bld,opt,pdf,jpeg,jpg,gif,png",
                                                        filesize: FILE_OPTIONS.MAX_FILE_SIZE
                                                    },
                                                    "{!$Component.advancedAppForm.postHomeEnergyScoreAdditional + ':inputFile:file'}": {
                                                        required: true,
                                                        filenameLength: true,
                                                        extension: "pdf,zip,doc,docx,jpg,gif,png,xls,xlsx",
                                                        filesize: FILE_OPTIONS.MAX_FILE_SIZE
                                                    },
                                                    "{!$Component.advancedAppForm.postDeliveredSensibleEERScoresheet + ':inputFile:file'}": {
                                                        required: true,
                                                        filenameLength: true,
                                                        extension: "xls,xlsx",
                                                        filesize: FILE_OPTIONS.MAX_FILE_SIZE
                                                    }
                                                }
                                            });
                                        }

                                        // Validation when clicking save button
                                        function validationPostOnSave() {
                                            $(vfToJQ("{!$Component.advancedAppForm}")).validate({
                                                normalizer: function(value) {
                                                    return $.trim(value);
                                                },
                                                rules: {
                                                    '{!$Component.advancedAppForm.completedPackageCost}': {
                                                        required: true,
                                                        currency: ["$", false],
                                                        min_comma: 1,
                                                        maxlength_currency: 16
                                                    },
                                                    '{!$Component.advancedAppForm.testOutDate}': {
                                                        date: true
                                                    },
                                                    '{!$Component.advancedAppForm.workPostStartDate}': {
                                                        date: true
                                                    },
                                                    '{!$Component.advancedAppForm.workPostFinishDate}': {
                                                        date: true
                                                    },
                                                    '{!$Component.advancedAppForm.postHPHIEER}': {
                                                        validateHPHIEERRange: true
                                                    },
                                                    '{!$Component.advancedAppForm.postConditionedArea}': {
                                                        range: [800, 7000],
                                                        validatePostConditionedArea: true
                                                    },
                                                    "{!$Component.advancedAppForm.clientSignedContractSOW + ':inputFile:file'}": {
                                                        filenameLength: true,
                                                        extension: "pdf,doc,docx,jpg,gif,png",
                                                        filesize: FILE_OPTIONS.MAX_FILE_SIZE
                                                    },
                                                    "{!$Component.advancedAppForm.postHomePerformanceXML + ':inputFile:file'}": {
                                                        filenameLength: true,
                                                        extension: "xml",
                                                        filesize: FILE_OPTIONS.MAX_HPXML_FILE_SIZE
                                                    },
                                                    "{!$Component.advancedAppForm.postHomePerformanceSystemFile + ':inputFile:file'}": {
                                                        filenameLength: true,
                                                        extension: "bld,opt,pdf,jpeg,jpg,gif,png",
                                                        filesize: FILE_OPTIONS.MAX_FILE_SIZE
                                                    },
                                                    "{!$Component.advancedAppForm.testOutMeasurements + ':inputFile:file'}": {
                                                        filenameLength: true,
                                                        extension: "pdf",
                                                        filesize: FILE_OPTIONS.MAX_FILE_SIZE
                                                    },
                                                    "{!$Component.advancedAppForm.safetyQualityAcknowledgment + ':inputFile:file'}": {
                                                        filenameLength: true,
                                                        extension: "pdf",
                                                        filesize: FILE_OPTIONS.MAX_FILE_SIZE
                                                    },
                                                    "{!$Component.advancedAppForm.buildingPermit + ':inputFile:file'}": {
                                                        filenameLength: true,
                                                        extension: "pdf,doc,docx,txt,jpeg,jpg,png,tif,tiff",
                                                        filesize: FILE_OPTIONS.MAX_FILE_SIZE
                                                    },
                                                    "{!$Component.advancedAppForm.postAdditionalDocuments + ':inputFile:file'}": {
                                                        filenameLength: true,
                                                        extension: "pdf,zip,doc,docx,jpg,gif,png",
                                                        filesize: FILE_OPTIONS.MAX_FILE_SIZE
                                                    },
                                                    "{!$Component.advancedAppForm.postPaymentReleaseAuthorization + ':inputFile:file'}": {
                                                        filenameLength: true,
                                                        extension: "pdf",
                                                        filesize: FILE_OPTIONS.MAX_FILE_SIZE
                                                    },
                                                    "{!$Component.advancedAppForm.postHomeEnergyScoreBuilding + ':inputFile:file'}": {
                                                        filenameLength: true,
                                                        extension: "pdf,zip,doc,docx,jpg,gif,png",
                                                        filesize: FILE_OPTIONS.MAX_FILE_SIZE
                                                    },
                                                    "{!$Component.advancedAppForm.postHesEnergyScore + ':inputFile:file'}": {
                                                        filenameLength: true,
                                                        extension: "bld,opt,pdf,jpeg,jpg,gif,png",
                                                        filesize: FILE_OPTIONS.MAX_FILE_SIZE
                                                    },
                                                    "{!$Component.advancedAppForm.postHomeEnergyScoreAdditional + ':inputFile:file'}": {
                                                        filenameLength: true,
                                                        extension: "pdf,zip,doc,docx,jpg,gif,png,xls,xlsx",
                                                        filesize: FILE_OPTIONS.MAX_FILE_SIZE
                                                    },
                                                    "{!$Component.advancedAppForm.postDeliveredSensibleEERScoresheet + ':inputFile:file'}": {
                                                        filenameLength: true,
                                                        extension: "xls,xlsx",
                                                        filesize: FILE_OPTIONS.MAX_FILE_SIZE
                                                    }
                                                }
                                            });
                                        }

                                        $("#postAppGoNext").click( function(e) {
                                            e.preventDefault();
                                            $('.saving').removeClass('saving');

                                            if (!$(this).hasClass('goNext')) {
                                                $(this).addClass('goNext');
                                            }
                                            unbindValidation($(vfToJQ("{!$Component.advancedAppForm}")));
                                            validationPostComplete();

                                            if (!validatePayeeInformation('AHU')) {
                                                return;
                                            }
                                            // Check if validation on payment release is needed
                                            checkPaymentReleaseValidation(
                                                $(vfToJQ("{!$Component.advancedAppForm.postPaymentReleaseAuthorization}")));
                                            var isValid = $(vfToJQ("{!$Component.advancedAppForm}")).valid();

                                            if (isValid) {
                                                disableButtons();
                                                nextPostApplicationJS();
                                            }
                                            // Process error messages.
                                            setMessage(isValid, PAGE_ERROR.MESSAGE_CONTINUE);
                                        });

                                        $(document).ready(function() {
                                            $('#savePostApp').on('click', function(e) {
                                                e.preventDefault();
                                                unbindValidation($(vfToJQ("{!$Component.advancedAppForm}")));
                                                validationPostOnSave();
                                                var isValid = $(vfToJQ("{!$Component.advancedAppForm}")).valid();

                                                if (isValid) {
                                                    disableButtons();
                                                    savePostApplicationJS();
                                                }
                                                // Process error messages.
                                                setMessage(isValid, PAGE_ERROR.MESSAGE_SAVE);
                                            });

                                            showHideConditionedAreaSection($('select[id*="hasConditionedArea"]').val() === "Yes");
                                            $('select[id*="hasConditionedArea"]').on('change', function() {
                                                var showConditionedArea = $('select[id*="hasConditionedArea"]').val() === "Yes";
                                                if (showConditionedArea) {
                                                    $('input[id*="postConditionedArea"]').val("");
                                                }
                                                showHideConditionedAreaSection(showConditionedArea);
                                            });

                                            //-----------POST PICKLIST HAS ENERGY SCORE THIS HOME-----------------------
                                            showHideHesSection($('select[id*="postHES"]').val() == "Yes");
                                            $('select[id*="postHES"]').on('change', function() {
                                                showHideHesSection($(this).val() == 'Yes');
                                            });

                                            // Show HPHI section if user select "Yes".
                                            showHideHPHISection($('select[id*="hasPostHPHI"]').val() == "Yes");
                                            $('select[id*="hasPostHPHI"]').on('change', function() {
                                                showHideHPHISection($(this).val() == 'Yes');
                                            });
                                        });
                                    </script>
                                </apex:outputPanel>
                                <!-- /NEW POST-INSTALLATION APPLICATION -->

                                <!-- POST-INSTALLATION APPLICATION DETAIL AND POST-INSTALLATION APPLICATION VIEW -->
                                <apex:outputPanel layout="none" rendered="{!OR(displayPostAppDetailSection, action == 'view')}">
                                    <apex:outputPanel layout="none" rendered="{!action != 'view'}">
                                        <h2 class="sub-header">2. Review &amp; Submit</h2>
                                        <p>
                                            Please review and confirm all details before submitting your post-installation application. If you need to edit, click the "Back" button to return to the previous page. Your pre-installation application cannot be edited after you click "Submit".
                                        </p>
                                    </apex:outputPanel>
                                    <apex:outputPanel layout="block" rendered="{!viewPostAppButton}" style="display: inline-block; float: right;">
                                        <a class="btn btn-default"
                                            href="{!$Site.Prefix}/BIGPortalAdvancedHUApplication?action={!IF(application.Status__c != 'Post-Install Correction Required' && application.Status__c != 'Post-Install Created','detail','edit')}&id={!application.Id}"
                                            style="font-weight: normal; width: 100px; margin: 10px 10px 0 0;">Edit</a>
                                    </apex:outputPanel>
                                    <div class="detail-container" style="margin-left: 10px; margin-top: 35px;">
                                        <div class="sub-title" style="margin-top: 25px;">
                                            <strong>Building and Contract-Signing Customer Information</strong>
                                        </div>
                                        <div class="row">
                                            <div class="span3">
                                                Customer Name
                                            </div>
                                            <div class="span5">
                                                {!application.Customer_Last_Name__c},
                                                {!application.Customer_First_Name__c}
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="span3">
                                                Building Address
                                            </div>
                                            <div class="span5">
                                                {!application.Dwelling_Unit_Street_Address__c}
                                            </div>
                                        </div>
                                        <div class="row text-left">
                                            <div class="span3 text-right">
                                                City
                                            </div>
                                            <div class="" style="display: inline-block; margin-left: 20px;">
                                                {!application.Building_City__c}
                                            </div>
                                            <div class="" style="display: inline-block; margin: 0 15px 0 40px;">
                                                State
                                            </div>
                                            <div class="" style="display: inline-block;">
                                                {!application.Building_State__c}
                                            </div>
                                            <div class="" style="display: inline-block; margin: 0 15px 0 40px;">
                                                ZIP Code
                                            </div>
                                            <div class="" style="display: inline-block;">
                                                {!application.Building_ZIP_Code__c}
                                            </div>
                                            <apex:outputPanel rendered="{!NOT(ISBLANK(application.Dwelling_Unit_Number__c))}" layout="none">
                                                <div class="" style="display: inline-block; margin: 0 15px 0 40px;">
                                                    Unit #
                                                </div>
                                                <div class="" style="display: inline-block;">
                                                    {!application.Dwelling_Unit_Number__c}
                                                </div>
                                            </apex:outputPanel>
                                        </div>
                                        <!-- Payee Information -->
                                        <div class="sub-title" style="margin-top: 25px;">
                                            <strong>Payee Information</strong>
                                        </div>
                                        <div class="row">
                                            <div class="span3">
                                                Name
                                            </div>
                                            <div class="span5">
                                                {!application.Payee_Full_Name__c}
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="span3">
                                                Address
                                            </div>
                                            <div class="span5">
                                                {!application.Payee_Street_Address__c}
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="span3"></div>
                                            <div class="span5">
                                                {!application.Payee_City__c}, {!application.Payee_State__c} {!application.Payee_ZIP_Code__c}
                                            </div>
                                        </div>
                                        <!-- / Payee Information -->
                                        <div class="sub-title" style="margin-top: 25px;">
                                            <strong>Project Information</strong>
                                        </div>
                                        <div class="row">
                                            <div class="span3">
                                                Proposed Installation Cost
                                            </div>
                                            <div class="span5">
                                                <apex:outputText value="{0, number, '$'###,###,##0.00}">
                                                    <apex:param value="{!preApplication.Proposed_Package_Cost__c}" />
                                                </apex:outputText>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="span3">
                                                Completed Installation Cost
                                            </div>
                                            <div class="span5">
                                                <apex:outputText value="{0, number, '$'###,###,##0.00}">
                                                    <apex:param value="{!postApplication.Completed_Package_Cost__c}" />
                                                </apex:outputText>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="span3">
                                                Project Financing
                                            </div>
                                            <div class="span5">
                                                <apex:outputText >
                                                    <apex:outputField value="{!application.Project_Financing_Source__c}" />
                                                </apex:outputText>
                                            </div>
                                        </div>
                                        <apex:outputPanel layout="block" rendered="{!application.Project_Financing_Detail__c != null}">
                                            <div class="row">
                                                <div class="span3">
                                                    Project Financing Detail
                                                </div>
                                                <div class="span5">
                                                    <apex:outputText >
                                                        <apex:outputField value="{!application.Project_Financing_Detail__c}" />
                                                    </apex:outputText>
                                                </div>
                                            </div>
                                        </apex:outputPanel>
                                        <apex:outputPanel layout="block" rendered="{!application.Project_Financing_Description__c != null}">
                                            <div class="row">
                                                <div class="span3">
                                                    Description
                                                </div>
                                                <div class="span5" style="width: 150px;white-space: nowrap;overflow: hidden;text-overflow: ellipsis;">
                                                    <apex:outputText >
                                                        <apex:outputField value="{!application.Project_Financing_Description__c}" />
                                                    </apex:outputText>
                                                </div>
                                            </div>
                                        </apex:outputPanel>
                                        <div class="row">
                                            <div class="span3">
                                                Estimated Incentive
                                            </div>
                                            <div class="span5">
                                                <apex:outputText value="{0, number, '$'###,###,##0.00}">
                                                    <apex:Param value="{!IF(postApplication.Total_Incentive__c != null, IF(postApplication.Total_Incentive__c != 0, postApplication.Total_Incentive__c, 0), 0)}"/>
                                                </apex:outputText>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="span3">Customer Cost</div>
                                            <div class="span5">
                                                <apex:outputText value="{0, number, '$'###,###,##0.00}">
                                                    <apex:param value="{!postApplication.Completed_Package_Cost__c - postApplication.Total_Incentive__c}"/>
                                                </apex:outputText>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="span3">Rebate Issued to</div>
                                            <div class="span5">
                                                {!postApplication.Rebate_Assignment__c}
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="span3">Modeling Type</div>
                                            <div class="span5">
                                                {!preApplication.Modeling_Type__c}
                                            </div>
                                        </div>

                                        <div class="row">
                                            <div class="span3">Work Start Date</div>
                                            <div class="span5">
                                                {!formattedPostWorkStartDate}
                                            </div>
                                        </div>

                                        <div class="row">
                                            <div class="span3">Work Finish Date</div>
                                            <div class="span5">
                                                {!formattedPostWorkFinishDate}
                                            </div>
                                        </div>

                                        <div class="row">
                                            <div class="span3">Test-Out Date</div>
                                            <div class="span5">
                                                {!formattedTestOutDate}
                                            </div>
                                        </div>

                                        <div class="row">
                                            <div class="span3">Has the Conditioned Area Changed?</div>
                                            <div class="span5">
                                                {!application.Has_Conditioned_Area_Changed__c}
                                            </div>
                                        </div>

                                        <apex:outputPanel layout="block" rendered="{!application.Has_Conditioned_Area_Changed__c == 'Yes'}">
                                            <div class="row">
                                                <div class="span3">
                                                    Conditioned Area (sq ft)
                                                </div>
                                                <div class="span5">
                                                    {!application.Post_Conditioned_Area__c}
                                                </div>
                                            </div>
                                        </apex:outputPanel>

                                        <div class="row">
                                            <div class="span3">BPI Analyst</div>
                                            <div class="span5">
                                                {!postApplication.BPI_Analyst__r.Name}
                                            </div>
                                        </div>

                                        <div class="row">
                                            <div class="span3">Did this home get a post-installation Home Energy Score (HES)?</div>
                                            <div class="span5">
                                                {!application.Has_Post_Install_HES__c}
                                            </div>
                                        </div>

                                        <apex:outputPanel layout="block" rendered="{!application.Has_Post_Install_HES__c == 'Yes'}">
                                            <div class="row">
                                                <div class="span3">Home Energy Score</div>
                                                <div class="span5">
                                                    {!application.Post_Home_Energy_Score__c}
                                                </div>
                                            </div>

                                            <div class="row">
                                                <div class="span3">Home Energy Score Assessment Date</div>
                                                <div class="span5">
                                                    {!formattedPostHomeEnergyScoreAssessmentDate}
                                                </div>
                                            </div>

                                            <div class="row">
                                                <div class="span3">Home Energy Score Assessor</div>
                                                <div class="span5">
                                                    {!application.Post_HES_Assessor__r.Name}
                                                </div>
                                            </div>
                                        </apex:outputPanel>

                                        <apex:outputPanel layout="block" rendered="{!NOT(ISBLANK(postApplication.Has_HPHI__c))}">
                                            <div class="row">
                                                <div class="span3">Did this home have a qualified High Performance HVAC Installation (HPHI) performed?</div>
                                                <div class="span5">
                                                    {!postApplication.Has_HPHI__c}
                                                </div>
                                            </div>
                                            <apex:outputPanel layout="block" rendered="{!postApplication.Has_HPHI__c == 'Yes'}">
	                                            <div class="row">
	                                                <div class="span3">HPHI Practitioner</div>
	                                                <div class="span5">
	                                                    {!postApplication.HPHI_Practitioner__r.Name}
	                                                </div>
	                                            </div>
                                                <div class="row">
                                                    <div class="span3">Delivered Sensible EER</div>
                                                    <div class="span5">
                                                        {!application.Delivered_Sensible_EER__c}
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="span3">Delivered Sensible EER Assessment Date</div>
                                                    <div class="span5">
                                                        {!formattedDeliveredSensibleEERAssessmentDate}
                                                    </div>
                                                </div>
                                            </apex:outputPanel>
                                        </apex:outputPanel>

                                        <div class="{!IF(action != 'view', 'calculations-box', 'calculations-box calculations-box-view-post')}">
                                            <table>
                                                <tr>
                                                    <td>Modeled Savings Incentive</td>
                                                    <td class="align-right">
                                                        {!formattedPostUnadjustedEnergySavingsPercent}
                                                    </td>
                                                    <td class="align-right-dollar">
                                                        <apex:outputText value="{0, number, currency}">
                                                            <apex:param value="{!IF(postApplication.Total_Incentive_from_Tier__c != null, IF(postApplication.Total_Incentive_from_Tier__c != 0, postApplication.Total_Incentive_from_Tier__c, 0), 0)}"/>
                                                        </apex:outputText>
                                                    </td>
                                                </tr>
                                                <apex:outputPanel layout="none" rendered="{!IF(AND(splitTerritoryAdjustmentPost != null, splitTerritoryAdjustmentPost < 0), true, false)}">
                                                    <tr>
                                                        <td colspan="2">Split Territory Adjustment</td>
                                                        <td class="align-right-dollar">
                                                            <apex:outputText value="{0, number, currency}">
                                                                <apex:param value="{!splitTerritoryAdjustmentPost}"/>
                                                            </apex:outputText>
                                                        </td>
                                                    </tr>
                                                </apex:outputPanel>
                                                <apex:repeat value="{!postXmlEndUseMap}" var="xmlEndUseKey">
                                                    <apex:outputPanel layout="none" rendered="{!AND(xmlEndUseKey == 'KWH Kicker', postXmlEndUseMap[xmlEndUseKey].Item_Incentive_Amount__c != null, postXmlEndUseMap[xmlEndUseKey].Item_Incentive_Amount__c != 0)}">
                                                        <tr>
                                                            <td>Electric Savings Bonus</td>
                                                            <td class="align-right">
                                                                <apex:outputText value="{0, number, ###,##0.00 kWh}">
                                                                    <apex:param value="{!postApplication.Total_Adjusted_Savings_kWh__c}" />
                                                                </apex:outputText>
                                                            </td>
                                                            <td class="align-right-dollar">
                                                                <apex:outputText value="{0, number, currency}">
                                                                    <apex:param value="{!IF(xmlEndUseKey == 'KWH Kicker', IF(postXmlEndUseMap[xmlEndUseKey].Item_Incentive_Amount__c != 0, postXmlEndUseMap[xmlEndUseKey].Item_Incentive_Amount__c, 0), '')}"/>
                                                                </apex:outputText>
                                                            </td>
                                                        </tr>
                                                    </apex:outputPanel>
                                                    <apex:outputPanel layout="none" rendered="{!AND(xmlEndUseKey == 'Therm Kicker', postXmlEndUseMap[xmlEndUseKey].Item_Incentive_Amount__c != 0, postXmlEndUseMap[xmlEndUseKey].Item_Incentive_Amount__c != null)}">
                                                        <td>Gas Savings Bonus</td>
                                                        <td class="align-right">
                                                            <apex:outputText value="{0, number, ###,##0.00 therms}">
                                                                <apex:param value="{!postApplication.Total_Adjusted_Savings_therms__c}"/>
                                                            </apex:outputText>
                                                        </td>
                                                        <td class="align-right-dollar">
                                                            <apex:outputText value="{0, number, currency}">
                                                                <apex:param value="{!IF(xmlEndUseKey == 'Therm Kicker', IF(postXmlEndUseMap[xmlEndUseKey].Item_Incentive_Amount__c != 0, postXmlEndUseMap[xmlEndUseKey].Item_Incentive_Amount__c, 0), '')}"/>
                                                            </apex:outputText>
                                                        </td>
                                                    </apex:outputPanel>
                                                    <apex:outputPanel layout="none" rendered="{!AND(xmlEndUseKey == 'AC Kicker', postXmlEndUseMap[xmlEndUseKey].Item_Incentive_Amount__c != null, postXmlEndUseMap[xmlEndUseKey].Item_Incentive_Amount__c != 0)}">
                                                        <tr>
                                                            <td colspan="2">AC Kicker</td>
                                                            <td class="align-right-dollar">
                                                                <apex:outputText value="{0, number, currency}">
                                                                    <apex:param value="{!IF(postXmlEndUseMap[xmlEndUseKey].Item_Incentive_Amount__c != null, postXmlEndUseMap[xmlEndUseKey].Item_Incentive_Amount__c, 0)}" />
                                                                </apex:outputText>
                                                            </td>
                                                        </tr>
                                                    </apex:outputPanel>
                                                    <apex:outputPanel layout="none" rendered="{!AND(xmlEndUseKey == 'Pool Pump Kicker', postXmlEndUseMap[xmlEndUseKey].Item_Incentive_Amount__c != null, postXmlEndUseMap[xmlEndUseKey].Item_Incentive_Amount__c != 0)}">
                                                        <tr>
                                                            <td colspan="2">Pool Pump Kicker</td>
                                                            <td class="align-right-dollar">
                                                                <apex:outputText value="{0, number, currency}">
                                                                    <apex:param value="{!IF(postXmlEndUseMap[xmlEndUseKey].Item_Incentive_Amount__c != null, postXmlEndUseMap[xmlEndUseKey].Item_Incentive_Amount__c, 0)}" />
                                                                </apex:outputText>
                                                            </td>
                                                        </tr>
                                                    </apex:outputPanel>
                                                </apex:repeat>
                                                <apex:outputPanel rendered="{!AND(postApplication.Total_Incentive_Adjustment__c != null, postApplication.Total_Incentive_Adjustment__c != 0)}" layout="none">
                                                    <tr>
                                                        <td colspan="2">Incentive Adjustment</td>
                                                        <td class="align-right-dollar">
                                                            <apex:outputText value="{0, number, currency}">
                                                                <apex:param value="{!postApplication.Total_Incentive_Adjustment__c}"/>
                                                            </apex:outputText>
                                                        </td>
                                                    </tr>
                                                </apex:outputPanel>
                                                <apex:outputPanel rendered="{!postApplication.HPHI_Bonus__c != null}" layout="none">
                                                    <tr>
                                                        <td colspan="2">Subtotal</td>
                                                        <td class="align-right-dollar">
                                                            <apex:outputText value="{0, number, currency}">
                                                                <apex:param value="{!if(postApplication.HPHI_Bonus__c != null, postApplication.Total_Incentive__c - postApplication.HPHI_Bonus__c, postApplication.Total_Incentive__c)}"/>
                                                            </apex:outputText>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="2">HPHI Bonus</td>
                                                        <td class="align-right-dollar">
                                                            <apex:outputText value="{0, number, currency}">
                                                                <apex:param value="{!postApplication.HPHI_Bonus__c}"/>
                                                            </apex:outputText>
                                                        </td>
                                                    </tr>
                                                </apex:outputPanel>
                                                <tr class="last-row-calculations-table estimated-incentive">
                                                    <td colspan="2">Estimated Incentive Total</td>
                                                    <td class="align-right-dollar">
                                                        <apex:outputText value="{0, number, currency}">
                                                            <apex:param value="{!IF(postApplication.Total_Incentive__c != null, IF(postApplication.Total_Incentive__c != 0, postApplication.Total_Incentive__c, 0), 0)}"/>
                                                        </apex:outputText>
                                                    </td>
                                                </tr>
                                                <apex:outputPanel rendered="{!AND(application.Status__c == 'Rebate Issued', application.Final_Incentive_Total__c != null, application.Final_Incentive_Total__c != 0)}" layout="none">
                                                    <tr>
                                                        <td colspan="3"><hr/></td>
                                                    </tr>
                                                    <tr class="last-row-calculations-table">
                                                        <td colspan="2">Final Incentive Total</td>
                                                        <td class="align-right-dollar">
                                                            <apex:outputText value="{0, number, currency}">
                                                                <apex:param value="{!application.Final_Incentive_Total__c}"/>
                                                            </apex:outputText>
                                                        </td>
                                                    </tr>
                                                </apex:outputPanel>
                                            </table>
                                        </div>
                                        <div class="sub-title" style="margin-top: 25px;">
                                            <strong>Required Documents</strong>
                                        </div>
                                        <div class="control-group">
                                            <label class="control-label inputLabelInline" style="width:220px;">Client-Signed Contract/SOW</label>
                                            <div class="controls inputControlInline" style="margin-left: 20px;">
                                                <apex:outputPanel layout="block" rendered="{!clientSignedContractSOW.Id != null && NOT(loadedPostApplicationFiles[clientSignedContractSOW.parentId].S3_Uploaded__c)}">
                                                    <div class="filenameContainer">
                                                        <a href="{!URLFOR($Action.Attachment.Download, clientSignedContractSOW.Id)}">{!loadedPostApplicationFiles[clientSignedContractSOW.parentId].File_Name__c}</a>
                                                    </div>
                                                </apex:outputPanel>

                                                <apex:outputPanel rendered="{!postApplication.Client_Signed_Contract_SOW__c != null && loadedPostApplicationFiles[postApplication.Client_Signed_Contract_SOW__c].Id != null && loadedPostApplicationFiles[postApplication.Client_Signed_Contract_SOW__c].S3_Uploaded__c}">{!loadedPostApplicationFiles[postApplication.Client_Signed_Contract_SOW__c].File_Name__c}</apex:outputPanel>
                                            </div>
                                        </div>
                                        <div class="control-group">
                                            <label class="control-label inputLabelInline" style="width:220px;">Energy Model Output (.xml) (HPXML)</label>
                                            <div class="controls inputControlInline" style="margin-left: 20px;">
                                                <apex:outputPanel layout="block" rendered="{!postHomePerformanceXML.Id != null && NOT(loadedPostApplicationFiles[postHomePerformanceXML.parentId].S3_Uploaded__c)}">
                                                    <div class="filenameContainer">
                                                        <a href="{!URLFOR($Action.Attachment.Download, postHomePerformanceXML.Id)}">{!loadedPostApplicationFiles[postHomePerformanceXML.parentId].File_Name__c}</a>
                                                    </div>
                                                </apex:outputPanel>

                                                <apex:outputPanel rendered="{!postApplication.Home_Performance_XML__c != null && loadedPostApplicationFiles[postApplication.Home_Performance_XML__c].Id != null && loadedPostApplicationFiles[postApplication.Home_Performance_XML__c].S3_Uploaded__c}">{!loadedPostApplicationFiles[postApplication.Home_Performance_XML__c].File_Name__c}</apex:outputPanel>
                                            </div>
                                        </div>
                                        <div class="control-group">
                                            <label class="control-label inputLabelInline" style="width:220px;">Energy Model Input (.bld, .opt, .pdf or image file)</label>
                                            <div class="controls inputControlInline" style="margin-left: 20px;">
                                                <apex:outputPanel layout="block" rendered="{!postHomePerformanceSystemFile.Id != null && NOT(loadedPostApplicationFiles[postHomePerformanceSystemFile.parentId].S3_Uploaded__c)}">
                                                    <div class="filenameContainer">
                                                        <a href="{!URLFOR($Action.Attachment.Download, postHomePerformanceSystemFile.Id)}">{!loadedPostApplicationFiles[postHomePerformanceSystemFile.parentId].File_Name__c}</a>
                                                    </div>
                                                </apex:outputPanel>

                                                <apex:outputPanel rendered="{!postApplication.Home_Performance_System_File__c != null && loadedPostApplicationFiles[postApplication.Home_Performance_System_File__c].Id != null && loadedPostApplicationFiles[postApplication.Home_Performance_System_File__c].S3_Uploaded__c}">{!loadedPostApplicationFiles[postApplication.Home_Performance_System_File__c].File_Name__c}</apex:outputPanel>
                                            </div>
                                        </div>
                                        <div class="control-group">
                                            <label class="control-label inputLabelInline" style="width:220px;">Test-Out Measurements (CAS) Form (.pdf)</label>
                                            <div class="controls inputControlInline" style="margin-left: 20px;">
                                                <apex:outputPanel layout="block" rendered="{!testOutMeasurements.Id != null && NOT(loadedPostApplicationFiles[testOutMeasurements.parentId].S3_Uploaded__c)}">
                                                    <div class="filenameContainer">
                                                        <a href="{!URLFOR($Action.Attachment.Download, testOutMeasurements.Id)}">{!loadedPostApplicationFiles[testOutMeasurements.parentId].File_Name__c}</a>
                                                    </div>
                                                </apex:outputPanel>

                                                <apex:outputPanel rendered="{!postApplication.Test_Out_Measurements__c != null && loadedPostApplicationFiles[postApplication.Test_Out_Measurements__c].Id != null && loadedPostApplicationFiles[postApplication.Test_Out_Measurements__c].S3_Uploaded__c}">{!loadedPostApplicationFiles[postApplication.Test_Out_Measurements__c].File_Name__c}</apex:outputPanel>
                                            </div>
                                        </div>
                                        <div class="control-group">
                                            <label class="control-label inputLabelInline" style="width:220px;">Safety &amp; Quality Acknowledgment (SQA) Form (.pdf)</label>
                                            <div class="controls inputControlInline" style="margin-left: 20px;">
                                                <apex:outputPanel layout="block" rendered="{!safetyQualityAcknowledgment.Id != null && NOT(loadedPostApplicationFiles[safetyQualityAcknowledgment.parentId].S3_Uploaded__c)}">
                                                    <div class="filenameContainer">
                                                        <a href="{!URLFOR($Action.Attachment.Download, safetyQualityAcknowledgment.Id)}">{!loadedPostApplicationFiles[safetyQualityAcknowledgment.parentId].File_Name__c}</a>
                                                    </div>
                                                </apex:outputPanel>

                                                <apex:outputPanel rendered="{!postApplication.Safety_Quality_Acknowledgment__c != null && loadedPostApplicationFiles[postApplication.Safety_Quality_Acknowledgment__c].Id != null && loadedPostApplicationFiles[postApplication.Safety_Quality_Acknowledgment__c].S3_Uploaded__c}">{!loadedPostApplicationFiles[postApplication.Safety_Quality_Acknowledgment__c].File_Name__c}</apex:outputPanel>
                                            </div>
                                        </div>
                                        <div class="control-group">
                                            <label class="control-label inputLabelInline" style="width:220px;">Closed/Finaled Building Permit
                                                <span class="optional-label">
                                                    (If required for scope of work)
                                                </span>
                                            </label>
                                            <div class="controls inputControlInline" style="margin-left: 20px;">
                                                <apex:outputPanel layout="none" rendered="{!buildingPermit.Id != null && NOT(loadedPostApplicationFiles[buildingPermit.parentId].S3_Uploaded__c)}">
                                                    <div class="filenameContainer">
                                                        <a href="{!URLFOR($Action.Attachment.Download, buildingPermit.Id)}">{!buildingPermit.Name}</a>
                                                    </div>
                                                </apex:outputPanel>

                                                <apex:outputPanel rendered="{!postApplication.Building_Permit__c != null && loadedPostApplicationFiles[postApplication.Building_Permit__c].Id != null && loadedPostApplicationFiles[postApplication.Building_Permit__c].S3_Uploaded__c}">{!loadedPostApplicationFiles[postApplication.Building_Permit__c].File_Name__c}</apex:outputPanel>
                                            </div>
                                        </div>
                                        <div class="control-group">
                                            <label class="control-label inputLabelInline" style="width:220px;">Additional Documents
                                                <span class="optional-label">(As necessary/if requested by reviewer)
                                                    <h4>
                                                        <small>
                                                            <a data-toggle="tooltip" class="help-icon" data-html="true" data-placement="right" data-trigger="hover" data-content="Photos, Specifications Documents, Heat Producing Devices (HPD) form, etc.">
                                                                <img src="{!URLFOR($Resource.acqccontractor, 'images/icon-help.png')}" />
                                                            </a>
                                                        </small>
                                                    </h4>
                                                </span>
                                            </label>
                                            <div class="controls inputControlInline" style="margin-left: 20px;">
                                                <apex:outputPanel layout="block" rendered="{!postAdditionalDocuments.Id != null && NOT(loadedPostApplicationFiles[postAdditionalDocuments.parentId].S3_Uploaded__c)}">
                                                    <div class="filenameContainer">
                                                        <a href="{!URLFOR($Action.Attachment.Download, postAdditionalDocuments.Id)}">{!loadedPostApplicationFiles[postAdditionalDocuments.parentId].File_Name__c}</a>
                                                    </div>
                                                </apex:outputPanel>

                                                <apex:outputPanel rendered="{!postApplication.Additional_Documents__c != null && loadedPostApplicationFiles[postApplication.Additional_Documents__c].Id != null && loadedPostApplicationFiles[postApplication.Additional_Documents__c].S3_Uploaded__c}">{!loadedPostApplicationFiles[postApplication.Additional_Documents__c].File_Name__c}</apex:outputPanel>
                                            </div>
                                        </div>
                                        <div class="control-group">
                                            <label class="control-label inputLabelInline" style="width:220px;">Payment Release Authorization (.pdf, optional)</label>
                                            <div class="controls inputControlInline" style="margin-left: 20px;">
                                                <apex:outputPanel layout="none" rendered="{!postPaymentReleaseAuthorization.Id != null && NOT(loadedPostApplicationFiles[postPaymentReleaseAuthorization.parentId].S3_Uploaded__c)}">
                                                    <div class="filenameContainer">
                                                        <a href="{!URLFOR($Action.Attachment.Download, postPaymentReleaseAuthorization.Id)}">{!postPaymentReleaseAuthorization.Name}</a>
                                                    </div>
                                                </apex:outputPanel>

                                                <apex:outputPanel rendered="{!postApplication.Payment_Release_Authorization__c != null && loadedPostApplicationFiles[postApplication.Payment_Release_Authorization__c].Id != null && loadedPostApplicationFiles[postApplication.Payment_Release_Authorization__c].S3_Uploaded__c}">{!loadedPostApplicationFiles[postApplication.Payment_Release_Authorization__c].File_Name__c}</apex:outputPanel>
                                            </div>
                                        </div>

                                        <!-- Post Energy Home Score hyperlink -->
                                        <apex:outputPanel rendered="{!application.Has_Post_Install_HES__c == 'Yes'}" layout="none">
                                            <div class="control-group">
                                                <label class="control-label inputLabelInline" style="width:220px;">Green Building Registry Opt-In</label>
                                                <div class="controls inputControlInline" style="margin-left: 20px;">
                                                    <apex:outputPanel layout="none" rendered="{!postGreenBuildingRegistryOptIn.Id != null && NOT(loadedPostApplicationFiles[postGreenBuildingRegistryOptIn.parentId].S3_Uploaded__c)}">
                                                        <div class="filenameContainer">
                                                            <a href="{!URLFOR($Action.Attachment.Download, postGreenBuildingRegistryOptIn.Id)}">{!postGreenBuildingRegistryOptIn.Name}</a>
                                                        </div>
                                                    </apex:outputPanel>

                                                    <apex:outputPanel rendered="{!postApplication.GBR_Opt_In__c != null && loadedPostApplicationFiles[postApplication.GBR_Opt_In__c].Id != null && loadedPostApplicationFiles[postApplication.GBR_Opt_In__c].S3_Uploaded__c}">{!loadedPostApplicationFiles[postApplication.GBR_Opt_In__c].File_Name__c}</apex:outputPanel>
                                                </div>
                                            </div>

                                            <!-- Post Energy Home Score hyperlink -->
                                            <div class="control-group">
                                                <label class="control-label inputLabelInline" style="width:220px;">Energy Home Score (.bld, .opt, .pdf or image file)</label>
                                                <div class="controls inputControlInline" style="margin-left: 20px;">
                                                    <apex:outputPanel layout="none" rendered="{!postHomeEnergyScoreReportInputFile.Id != null && NOT(loadedPostApplicationFiles[postHomeEnergyScoreReportInputFile.parentId].S3_Uploaded__c)}">
                                                        <div class="filenameContainer">
                                                            <a href="{!URLFOR($Action.Attachment.Download, postHomeEnergyScoreReportInputFile.Id)}">{!postHomeEnergyScoreReportInputFile.Name}</a>
                                                        </div>
                                                    </apex:outputPanel>

                                                    <apex:outputPanel rendered="{!postApplication.HES_Report_Input_File__c != null && loadedPostApplicationFiles[postApplication.HES_Report_Input_File__c].Id != null && loadedPostApplicationFiles[postApplication.HES_Report_Input_File__c].S3_Uploaded__c}">{!loadedPostApplicationFiles[postApplication.HES_Report_Input_File__c].File_Name__c}</apex:outputPanel>
                                                </div>
                                            </div>

                                            <!-- Post Energy Home Score hyperlink -->
                                            <div class="control-group">
                                                <label class="control-label inputLabelInline" style="width:220px;">Additional/Supplemental Home Energy Score Documents (.zip, .pdf, .doc, .docx, .jpg, .gif, .png, .xls, .xlsx)</label>
                                                <div class="controls inputControlInline" style="margin-left: 20px;">
                                                    <apex:outputPanel layout="none" rendered="{!postHomeEnergyScoreAdditionalDocuments.Id != null && NOT(loadedPostApplicationFiles[postHomeEnergyScoreAdditionalDocuments.parentId].S3_Uploaded__c)}">
                                                        <div class="filenameContainer">
                                                            <a href="{!URLFOR($Action.Attachment.Download, postHomeEnergyScoreAdditionalDocuments.Id)}">{!postHomeEnergyScoreAdditionalDocuments.Name}</a>
                                                        </div>
                                                    </apex:outputPanel>

                                                    <apex:outputPanel rendered="{!postApplication.HES_Additional_Documents__c != null && loadedPostApplicationFiles[postApplication.HES_Additional_Documents__c].Id != null && loadedPostApplicationFiles[postApplication.HES_Additional_Documents__c].S3_Uploaded__c}">{!loadedPostApplicationFiles[postApplication.HES_Additional_Documents__c].File_Name__c}</apex:outputPanel>
                                                </div>
                                            </div>
                                        </apex:outputPanel>

                                        <!-- Post HPHI Documents -->
                                        <apex:outputPanel rendered="{!postApplication.Has_HPHI__c == 'Yes'}" layout="none">
                                            <div class="control-group">
                                                <label class="control-label inputLabelInline" style="width:220px;">Delivered Sensible EER Scoresheet (.xls, .xlsx)</label>
                                                <div class="controls inputControlInline" style="margin-left: 20px;">
                                                    <apex:outputPanel layout="none" rendered="{!postDeliveredSensibleEERScoresheet.Id != null && NOT(loadedPostApplicationFiles[postDeliveredSensibleEERScoresheet.parentId].S3_Uploaded__c)}">
                                                        <div class="filenameContainer">
                                                            <a href="{!URLFOR($Action.Attachment.Download, postDeliveredSensibleEERScoresheet.Id)}">{!postDeliveredSensibleEERScoresheet.Name}</a>
                                                        </div>
                                                    </apex:outputPanel>

                                                    <apex:outputPanel rendered="{!application.Delivered_Sensible_EER_Scoresheet__c != null && loadedPostApplicationFiles[application.Delivered_Sensible_EER_Scoresheet__c].Id != null && loadedPostApplicationFiles[application.Delivered_Sensible_EER_Scoresheet__c].S3_Uploaded__c}">{!loadedPostApplicationFiles[application.Delivered_Sensible_EER_Scoresheet__c].File_Name__c}</apex:outputPanel>
                                                </div>
                                            </div>
                                        </apex:outputPanel>

                                        <div class="sub-title" style="margin-top: 25px;">
                                            <strong>Notes</strong>
                                        </div>
                                        <div id="post-conversation">

                                            <apex:inputTextarea id="postNotes2" value="{!AppNotes}" disabled="true"/>
                                                <apex:outputPanel layout="none">
                                                  <apex:repeat value="{!postApplicationNotes}" var="note">
                                                    <div class="conversation-note">
                                                        <strong>{!note.Note_Created_By__c} [<apex:outputField value="{!note.CreatedDate}"/>]:</strong><br/><apex:outputField value="{!note.Note__c}"/>
                                                        <br/><br/>
                                                    </div>
                                                </apex:repeat>
                                                <a href="#" class="showConversation" id="showPostConversation" style="display:none;">Show All</a>
                                                <script>
                                                    $('#showPostConversation').click(function (e) {
                                                        e.preventDefault();
                                                        $("post-conversation .conversation-note").show();
                                                        $(this).hide();
                                                    });
                                                    if ($("post-conversation .conversation-note").size() > 2) {
                                                        $("#showPostConversation").show();
                                                        $("post-conversation .conversation-note").hide();
                                                        $($("post-conversation .conversation-note").get(0)).show();
                                                        $($("post-conversation .conversation-note").get(1)).show();
                                                    }
                                                </script>
                                            </apex:outputPanel>
                                        </div>
                                        <apex:outputPanel layout="none" rendered="{!action == 'view'}">
                                            <a href="{!$Site.Prefix}/BIGPortalManageApplication" style="display: inline-block; margin-top: 40px;">&lt; Back to Application List</a>
                                        </apex:outputPanel>
                                    </div>
                                   <apex:outputPanel layout="none"
                                                     rendered="{!AND(OR(application.Status__c == 'Post-Install Created', application.Status__c == 'Post-Install Correction Required'), action != 'view')}">
                                        <div class="center" style="padding-top:30px">
                                            <apex:commandLink styleClass="btn btn-primary disable-btn" style="width: 100px;" action="{!submitPostApplicationReview}" value="Submit" />
                                            <div style="display:inline-block; position:relative; height: 70px;">
                                                <a class="btn btn-default disable-btn" style="width: 100px; margin: 0px 0px 15px 10px;" href="{!$Site.Prefix}/BIGPortalAdvancedHUApplication?action=edit&id={!application.Id}">Back</a>
                                                <span style="position: absolute; font-size: 12px; width: 125px; left: 0; top: 30px; line-height: 16px; padding: 5px 12px;">Back to edit Application Info</span>
                                            </div>
                                        </div>
                                    </apex:outputPanel>
                                </apex:outputPanel>
                                <!-- /POST-INSTALLATION APPLICATION DETAIL -->
                                <apex:outputPanel id="postApplicationConfirmPanel" layout="none" rendered="{!action == 'confirmPost'}">
                                    <h1 class="page-header">Advanced Home Upgrade: Post-Installation Application</h1>
                                    <apex:outputPanel layout="block" id="errors3">
                                        <apex:pageMessages escape="false"/>
                                    </apex:outputPanel>

                                    <div class="confirm-container" style="margin-left: 15px;">
                                        <p>
                                            Build It Green's Desktop Review team will review your Post-Installation Application and respond via email typically within the next 3 <br />business days with one of the following status updates:
                                        </p>
                                        <div style="margin: 30px 0px 30px 45px; width: 88%;">
                                            <p>
                                                <strong>1) Post-Install Approved:</strong> If all information is complete and accurate, your application will be approved and a rebate will be issued for your job. When your rebate is issued, the status of your application will change to <strong>Post-Install Approved</strong>.
                                            </p>
                                            <p><strong>or</strong></p>
                                            <p>
                                                <strong>2) Post-Install Correction Required:</strong> If the information is incomplete or needs corrections, you will be issued a "Post-Install Correction Required" status for your application with Notes instructing you on the corrections needed.
                                            </p>
                                        </div>
                                        <p>
                                            You can also view your <a href="{!$Site.Prefix}/BIGPortalAdvancedHUApplication?action=view&id={!application.Id}&isPre=true">Pre-Installation Application</a>. If you need to contact the Desktop Review team, please visit the <br /> <a href="{!$Site.Prefix}/BIGPortalHUPHelp">Help</a> page.
                                        </p>
                                    </div>
                                    <div class="center" style="padding-top: 30px;">
                                        <a href="{!$Site.Prefix}/BIGPortalManageDashboard" style="width: 150px;" class="btn btn-default">Go to Dashboard</a>
                                        <a href="{!$Site.Prefix}/BIGPortalManageApplication" style="width: 150px;" class="btn btn-default">View Applications</a>
                                    </div>
                                </apex:outputPanel>

                            </div><!-- / POST-INSTALLATION APPLICATION -->
                        </apex:outputPanel>
                    </div>
                </apex:form>
            </div>
        </div>
        <c:BIGPortalFooter />
        <c:BIGPortalAHUSurvey />
    </div>
</body>
</html>
</apex:page>